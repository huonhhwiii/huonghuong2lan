{"id":"c40e0517-b6f1-4912-8039-63430c88c17a","title":"Quản Lý Lịch Hẹn Bệnh Nhân","createdAt":1745249963099,"updatedAt":1745253146628,"isNameGenerated":true,"isRenamedByUser":false,"messages":[{"id":"c69a17de-20d5-4832-ab8f-de23032d2707","role":"user","rawContent":{"type":"doc","content":[{"type":"paragraph","content":[{"type":"text","text":"tương tự như chức năng quản lý phiếu khám, hãy tạo cho tôi chức năng quản lý lịch hẹn bao gồm các chức năng tương tự: thêm mới lịch hẹn, tìm kiếm lịch hẹn, danh sách lịch hẹn, với thông tin của lịch hẹn chỉ được lấy trong cơ sở dữ liệu gồm:  (MaLH, NgayHen, TrangThai, MaBN) nhớ kết nối được với cơ sở dữ liệu đã tạo ở bảng LICHHEN"}]}]},"content":[{"type":"text","text":"tương tự như chức năng quản lý phiếu khám, hãy tạo cho tôi chức năng quản lý lịch hẹn bao gồm các chức năng tương tự: thêm mới lịch hẹn, tìm kiếm lịch hẹn, danh sách lịch hẹn, với thông tin của lịch hẹn chỉ được lấy trong cơ sở dữ liệu gồm:  (MaLH, NgayHen, TrangThai, MaBN) nhớ kết nối được với cơ sở dữ liệu đã tạo ở bảng LICHHEN"}],"context":{"currentFile":{"fsPath":"/home/huong/nhakhoaso/templates/bac_si.html","path":"nhakhoaso/templates/bac_si.html","displayPath":"nhakhoaso/templates/bac_si.html","content":" {% extends 'layout.html' %}\n\n{% block title %}Quản lý bác sĩ - NHAKHOASO{% endblock %}\n\n{% block content %}\n<div class=\"section-title\">\n    <h2>QUẢN LÝ BÁC SĨ</h2>\n</div>\n\n<!-- Flash messages -->\n{% with messages = get_flashed_messages(with_categories=true) %}\n    {% if messages %}\n        <div class=\"flash-messages\">\n            {% for category, message in messages %}\n                <div class=\"flash-message {{ category }}\">\n                    {{ message }}\n                </div>\n            {% endfor %}\n        </div>\n    {% endif %}\n{% endwith %}\n\n<div class=\"page-container\">\n    <!-- Sidebar -->\n    <div class=\"sidebar\">\n        <div class=\"sidebar-title\">\n            <i class=\"fas fa-user-injured\"></i> Quản lý bệnh nhân\n        </div>\n        <ul class=\"sidebar-menu\">\n            <li>\n                <a href=\"{{ url_for('them_moi_benh_nhan') }}\">\n                    <i class=\"fas fa-plus\"></i> Thêm mới bệnh nhân\n                </a>\n            </li>\n            <li>\n                <a href=\"{{ url_for('tim_kiem_benh_nhan') }}\">\n                    <i class=\"fas fa-search\"></i> Tìm kiếm bệnh nhân\n                </a>\n            </li>\n            <li>\n                <a href=\"{{ url_for('benh_nhan_list') }}\">\n                    <i class=\"fas fa-list\"></i> Danh sách bệnh nhân\n                </a>\n            </li>\n        </ul>\n        \n        <div class=\"sidebar-title\">\n            <i class=\"fas fa-clipboard-list\"></i> Quản lý bác sĩ\n        </div>\n        <ul class=\"sidebar-menu\">\n            <li>\n                <a href=\"{{ url_for('them_moi_bac_si') }}\">\n                    <i class=\"fas fa-plus\"></i> Thêm mới bác sĩ\n                </a>\n            </li>\n            <li>\n                <a href=\"{{ url_for('tim_kiem_bac_si') }}\">\n                    <i class=\"fas fa-search\"></i> Tìm kiếm bác sĩ\n                </a>\n            </li>\n            <li>\n                <a href=\"{{ url_for('bac_si_page') }}\" class=\"active\">\n                    <i class=\"fas fa-list\"></i> Danh sách bác sĩ\n                </a>\n            </li>\n        </ul>\n        \n        <div class=\"sidebar-title\">\n            <a href=\"{{ url_for('phieu_kham_list') }}\" style=\"text-decoration: none; color: inherit;\">\n                <i class=\"fas fa-chart-line\"></i> Quản lý phiếu khám\n            </a>\n        </div>\n        <ul class=\"sidebar-menu\">\n            <li>\n                <a href=\"#\">\n                    <i class=\"fas fa-plus\"></i> Tạo phiếu khám\n                </a>\n            </li>\n            <li>\n                <a href=\"#\">\n                    <i class=\"fas fa-search\"></i> Tìm kiếm phiếu khám\n                </a>\n            </li>\n            <li>\n                <a href=\"#\">\n                    <i class=\"fas fa-list\"></i> Danh sách phiếu khám\n                </a>\n            </li>\n        </ul>\n        \n        <div class=\"sidebar-title\">\n            <i class=\"fas fa-calendar-check\"></i> Quản lý lịch hẹn\n        </div>\n        <ul class=\"sidebar-menu\">\n            <li>\n                <a href=\"#\">\n                    <i class=\"fas fa-plus\"></i> Đặt lịch hẹn\n                </a>\n            </li>\n            <li>\n                <a href=\"#\">\n                    <i class=\"fas fa-search\"></i> Tìm kiếm lịch hẹn\n                </a>\n            </li>\n            <li>\n                <a href=\"#\">\n                    <i class=\"fas fa-list\"></i> Danh sách lịch hẹn\n                </a>\n            </li>\n        </ul>\n    </div>\n\n    <!-- Main content -->\n    <div class=\"main-content\">\n        <div class=\"content-header\">\n            <h2>Danh sách bác sĩ</h2>\n        </div>\n        \n        <div class=\"module-actions\">\n            <a href=\"{{ url_for('them_moi_bac_si') }}\" class=\"btn\"><i class=\"fas fa-plus\"></i> Thêm bác sĩ mới</a>\n            <div class=\"search-box\">\n                <input type=\"text\" placeholder=\"Tìm kiếm bác sĩ...\">\n                <button class=\"btn\"><i class=\"fas fa-search\"></i></button>\n            </div>\n        </div>\n\n        <div class=\"module-content\">\n            <table class=\"data-table\">\n                <thead>\n                    <tr>\n                        <th>Mã BS</th>\n                        <th>Họ và tên</th>\n                        <th>Số điện thoại</th>\n                        <th>Thao tác</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {% if bac_si_list %}\n                        {% for bac_si in bac_si_list %}\n                            <tr id=\"bac-si-{{ bac_si.MaBS }}\">\n                                <td>{{ bac_si.MaBS }}</td>\n                                <td>{{ bac_si.HoTen }}</td>\n                                <td>{{ bac_si.Sdt }}</td>\n                                <td>\n                                    <a \n                                        href=\"{{ url_for('chi_tiet_bac_si', ma_bs=bac_si.MaBS) }}\" \n                                        class=\"action-btn view-btn\" \n                                        title=\"Xem chi tiết\">\n                                        <i class=\"fas fa-eye\"></i>\n                                    </a>\n                                    <a \n                                        href=\"{{ url_for('chinh_sua_bac_si', ma_bs=bac_si.MaBS) }}\" \n                                        class=\"action-btn edit-btn\" \n                                        title=\"Chỉnh sửa\">\n                                        <i class=\"fas fa-edit\"></i>\n                                    </a>\n                                    <a \n                                        href=\"#\" \n                                        class=\"action-btn delete-btn\" \n                                        title=\"Xóa\" \n                                        onclick=\"deleteDoctor('{{ bac_si.MaBS }}')\">\n                                        <i class=\"fas fa-trash\"></i>\n                                    </a>\n                                </td>\n                            </tr>\n                        {% endfor %}\n                    {% else %}\n                        <tr>\n                            <td colspan=\"4\" class=\"text-center\">\n                                <div class=\"no-data\">\n                                    <i class=\"fas fa-database\"></i>\n                                    <p>Chưa có dữ liệu bác sĩ</p>\n                                    <a href=\"{{ url_for('them_moi_bac_si') }}\" class=\"btn\">\n                                        <i class=\"fas fa-plus\"></i> Thêm bác sĩ mới\n                                    </a>\n                                </div>\n                            </td>\n                        </tr>\n                    {% endif %}\n                </tbody>\n            </table>\n        </div>\n\n        <div class=\"pagination\">\n            <a href=\"#\" class=\"page-link\">&laquo;</a>\n            <a href=\"#\" class=\"page-link active\">1</a>\n            <a href=\"#\" class=\"page-link\">2</a>\n            <a href=\"#\" class=\"page-link\">3</a>\n            <a href=\"#\" class=\"page-link\">&raquo;</a>\n        </div>\n    </div>\n</div>\n\n{% block extra_js %}\n<script>\n    // Hàm xóa bác sĩ\n    function deleteDoctor(maBS) {\n        if (confirm('Bạn có chắc chắn muốn xóa bác sĩ này?')) {\n            // Gọi API xóa bác sĩ\n            fetch(`/api/bac-si/${maBS}`, {\n                method: 'DELETE'\n            })\n            .then(response => response.json())\n            .then(data => {\n                if (data.success) {\n                    // Xóa dòng khỏi bảng\n                    document.getElementById(`bac-si-${maBS}`).remove();\n                    alert('Xóa bác sĩ thành công!');\n                    \n                    // Kiểm tra nếu không còn bác sĩ nào, hiển thị thông báo\n                    const tbody = document.querySelector('.data-table tbody');\n                    if (tbody.children.length === 0) {\n                        tbody.innerHTML = `\n                        <tr>\n                            <td colspan=\"4\" class=\"text-center\">\n                                <div class=\"no-data\">\n                                    <i class=\"fas fa-database\"></i>\n                                    <p>Chưa có dữ liệu bác sĩ</p>\n                                    <a href=\"{{ url_for('them_moi_bac_si') }}\" class=\"btn\">\n                                        <i class=\"fas fa-plus\"></i> Thêm bác sĩ mới\n                                    </a>\n                                </div>\n                            </td>\n                        </tr>\n                        `;\n                    }\n                } else {\n                    alert('Lỗi: ' + data.message);\n                }\n            })\n            .catch(error => {\n                console.error('Error:', error);\n                alert('Đã xảy ra lỗi khi xóa bác sĩ');\n            });\n        }\n    }\n</script>\n{% endblock %}\n\n{% endblock %}","language":"html"},"codebaseEnabled":true,"attachedFiles":[]},"createdAt":1745249963099,"isInternal":false},{"id":"b868d685-5778-4db4-8c30-d5d8216c1a47","role":"assistant","createdAt":1745249977308,"content":[{"type":"text","text":"Tôi sẽ giúp bạn tạo chức năng quản lý lịch hẹn tương tự như chức năng quản lý phiếu khám. Trước tiên, tôi cần tìm hiểu cấu trúc của ứng dụng và cách các chức năng hiện tại được triển khai."},{"type":"toolCall","toolCallId":"toolu_01KhTaC9QYwbjwy3uVFijh39","isHidden":false,"title":"","statusText":"Retrieved context","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/.vscode-server/data/User/History/22d83b17/oCl0.py","path":".vscode-server/data/User/History/22d83b17/oCl0.py","displayPath":".vscode-server/data/User/History/22d83b17/oCl0.py"},{"fsPath":"/home/huong/nhakhoaso/app.py","path":"nhakhoaso/app.py","displayPath":"nhakhoaso/app.py"},{"fsPath":"/home/huong/.vscode-server/data/User/History/22d83b17/I1lq.py","path":".vscode-server/data/User/History/22d83b17/I1lq.py","displayPath":".vscode-server/data/User/History/22d83b17/I1lq.py"},{"fsPath":"/home/huong/.vscode-server/data/User/History/-5a31bc4f/VE4I.html","path":".vscode-server/data/User/History/-5a31bc4f/VE4I.html","displayPath":".vscode-server/data/User/History/-5a31bc4f/VE4I.html"},{"fsPath":"/home/huong/.vscode-server/data/User/workspaceStorage/208e18acddfdf20e276f2c13ed351060/ZencoderAI.zencoder/zencoder-chat/sessions/337c95a5-b117-48d6-a6f8-94cf69aad4d9.json","path":".vscode-server/data/User/workspaceStorage/208e18acddfdf20e276f2c13ed351060/ZencoderAI.zencoder/zencoder-chat/sessions/337c95a5-b117-48d6-a6f8-94cf69aad4d9.json","displayPath":".vscode-server/data/User/workspaceStorage/208e18acddfdf20e276f2c13ed351060/ZencoderAI.zencoder/zencoder-chat/sessions/337c95a5-b117-48d6-a6f8-94cf69aad4d9.json"},{"fsPath":"/home/huong/.vscode-server/data/User/History/6e6d2161/HGl3.html","path":".vscode-server/data/User/History/6e6d2161/HGl3.html","displayPath":".vscode-server/data/User/History/6e6d2161/HGl3.html"},{"fsPath":"/home/huong/.vscode-server/data/User/History/33c16031/EwLH.py","path":".vscode-server/data/User/History/33c16031/EwLH.py","displayPath":".vscode-server/data/User/History/33c16031/EwLH.py"},{"fsPath":"/home/huong/nhakhoaso/database/phieu_kham.py","path":"nhakhoaso/database/phieu_kham.py","displayPath":"nhakhoaso/database/phieu_kham.py"}]}},{"type":"text","text":"Bây giờ tôi cần kiểm tra cấu trúc cơ sở dữ liệu để hiểu bảng LICHHEN:"},{"type":"toolCall","toolCallId":"toolu_01XsdrX2Gu6MNhRAdzft3zet","isHidden":false,"title":"","statusText":"Retrieved context","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/.vscode-server/data/User/History/-34b44c2c/IiiB.sql","path":".vscode-server/data/User/History/-34b44c2c/IiiB.sql","displayPath":".vscode-server/data/User/History/-34b44c2c/IiiB.sql"},{"fsPath":"/home/huong/.vscode-server/data/User/History/-34b44c2c/VFqm.sql","path":".vscode-server/data/User/History/-34b44c2c/VFqm.sql","displayPath":".vscode-server/data/User/History/-34b44c2c/VFqm.sql"},{"fsPath":"/home/huong/.vscode-server/data/User/History/-34b44c2c/QC9J.sql","path":".vscode-server/data/User/History/-34b44c2c/QC9J.sql","displayPath":".vscode-server/data/User/History/-34b44c2c/QC9J.sql"},{"fsPath":"/home/huong/.vscode-server/data/User/History/-34b44c2c/0SN1.sql","path":".vscode-server/data/User/History/-34b44c2c/0SN1.sql","displayPath":".vscode-server/data/User/History/-34b44c2c/0SN1.sql"},{"fsPath":"/home/huong/nhakhoaso/database/init_db.sql","path":"nhakhoaso/database/init_db.sql","displayPath":"nhakhoaso/database/init_db.sql"}]}},{"type":"text","text":"Tôi cần xem cấu trúc của file utils.py để hiểu cách tạo ID mới:"},{"type":"toolCall","toolCallId":"toolu_01UzwNwQ6mce77xYkFw59LPf","isHidden":false,"title":"","statusText":"Retrieved context","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/database/utils.py","path":"nhakhoaso/database/utils.py","displayPath":"nhakhoaso/database/utils.py"},{"fsPath":"/home/huong/nhakhoaso/database/phieu_kham.py","path":"nhakhoaso/database/phieu_kham.py","displayPath":"nhakhoaso/database/phieu_kham.py"},{"fsPath":"/home/huong/.vscode-server/data/User/History/-4a49b7a1/usv5.py","path":".vscode-server/data/User/History/-4a49b7a1/usv5.py","displayPath":".vscode-server/data/User/History/-4a49b7a1/usv5.py"},{"fsPath":"/home/huong/nhakhoaso/database/benh_nhan.py","path":"nhakhoaso/database/benh_nhan.py","displayPath":"nhakhoaso/database/benh_nhan.py"},{"fsPath":"/home/huong/nhakhoaso/database/bac_si.py","path":"nhakhoaso/database/bac_si.py","displayPath":"nhakhoaso/database/bac_si.py"}]}},{"type":"text","text":"Bây giờ tôi sẽ tạo các file cần thiết cho chức năng quản lý lịch hẹn. Đầu tiên, tôi sẽ tạo file database/lich_hen.py:"},{"type":"toolCall","toolCallId":"toolu_01PJhAN2D8nPmL61XPC9yaZZ","isHidden":false,"title":"","statusText":"Change generated","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/database/lich_hen.py","path":"nhakhoaso/database/lich_hen.py","displayPath":"nhakhoaso/database/lich_hen.py"}]}},{"type":"codeHunk","lineBasedDiff":"--- nhakhoaso/database/lich_hen.py\n+++ nhakhoaso/database/lich_hen.py\n@@ -0,0 +1,123 @@\n+from .db import execute_query\n+import datetime\n+from .utils import get_next_lich_hen_id\n+\n+def get_all_lich_hen():\n+    \"\"\"\n+    Lấy danh sách tất cả lịch hẹn\n+    \"\"\"\n+    query = \"\"\"\n+    SELECT lh.*, bn.HoTen as TenBenhNhan\n+    FROM LICHHEN lh\n+    JOIN BENHNHAN bn ON lh.MaBN = bn.MaBN\n+    ORDER BY lh.NgayHen DESC\n+    \"\"\"\n+    return execute_query(query, fetch=True)\n+\n+def get_lich_hen_by_id(ma_lh):\n+    \"\"\"\n+    Lấy thông tin lịch hẹn theo mã\n+    \"\"\"\n+    query = \"\"\"\n+    SELECT lh.*, bn.HoTen as TenBenhNhan\n+    FROM LICHHEN lh\n+    JOIN BENHNHAN bn ON lh.MaBN = bn.MaBN\n+    WHERE lh.MaLH = %s\n+    \"\"\"\n+    result = execute_query(query, (ma_lh,), fetch=True)\n+    return result[0] if result else None\n+\n+def search_lich_hen(tu_khoa, loai_tim_kiem='ma_lich_hen'):\n+    \"\"\"\n+    Tìm kiếm lịch hẹn theo từ khóa và loại tìm kiếm\n+    \n+    Args:\n+        tu_khoa (str): Từ khóa tìm kiếm\n+        loai_tim_kiem (str): Loại tìm kiếm (ma_lich_hen, ma_benh_nhan, trang_thai)\n+        \n+    Returns:\n+        list: Danh sách lịch hẹn tìm thấy\n+    \"\"\"\n+    if loai_tim_kiem == 'ma_lich_hen':\n+        query = \"\"\"\n+        SELECT lh.*, bn.HoTen as TenBenhNhan\n+        FROM LICHHEN lh\n+        JOIN BENHNHAN bn ON lh.MaBN = bn.MaBN\n+        WHERE lh.MaLH LIKE %s\n+        \"\"\"\n+    elif loai_tim_kiem == 'ma_benh_nhan':\n+        query = \"\"\"\n+        SELECT lh.*, bn.HoTen as TenBenhNhan\n+        FROM LICHHEN lh\n+        JOIN BENHNHAN bn ON lh.MaBN = bn.MaBN\n+        WHERE lh.MaBN LIKE %s\n+        \"\"\"\n+    elif loai_tim_kiem == 'trang_thai':\n+        query = \"\"\"\n+        SELECT lh.*, bn.HoTen as TenBenhNhan\n+        FROM LICHHEN lh\n+        JOIN BENHNHAN bn ON lh.MaBN = bn.MaBN\n+        WHERE lh.TrangThai LIKE %s COLLATE NOCASE\n+        \"\"\"\n+    else:\n+        return []\n+        \n+    return execute_query(query, (f'%{tu_khoa}%',), fetch=True)\n+\n+def create_lich_hen(ma_bn, ngay_hen, trang_thai=\"Chưa khám\", ma_lh=None):\n+    \"\"\"\n+    Tạo mới lịch hẹn\n+    \n+    Args:\n+        ma_bn (str): Mã bệnh nhân\n+        ngay_hen (str): Ngày hẹn (định dạng YYYY-MM-DD HH:MM:SS)\n+        trang_thai (str, optional): Trạng thái lịch hẹn\n+        ma_lh (str, optional): Mã lịch hẹn (nếu không cung cấp sẽ tự động tạo)\n+        \n+    Returns:\n+        tuple: (ma_lh, success) - Mã lịch hẹn và kết quả thành công hay không\n+    \"\"\"\n+    # Nếu không có mã lịch hẹn, tạo mã mới\n+    if not ma_lh:\n+        ma_lh = get_next_lich_hen_id()\n+        \n+    query = \"\"\"\n+    INSERT INTO LICHHEN (MaLH, MaBN, NgayHen, TrangThai)\n+    VALUES (%s, %s, %s, %s)\n+    \"\"\"\n+    \n+    try:\n+        execute_query(query, (ma_lh, ma_bn, ngay_hen, trang_thai))\n+        return ma_lh, True\n+    except Exception as e:\n+        print(f\"Lỗi khi tạo lịch hẹn: {e}\")\n+        return None, False\n+\n+def update_lich_hen(ma_lh, ma_bn, ngay_hen, trang_thai):\n+    \"\"\"\n+    Cập nhật thông tin lịch hẹn\n+    \"\"\"\n+    query = \"\"\"\n+    UPDATE LICHHEN\n+    SET MaBN = %s, NgayHen = %s, TrangThai = %s\n+    WHERE MaLH = %s\n+    \"\"\"\n+    \n+    try:\n+        execute_query(query, (ma_bn, ngay_hen, trang_thai, ma_lh))\n+        return True\n+    except Exception as e:\n+        print(f\"Lỗi khi cập nhật lịch hẹn: {e}\")\n+        return False\n+\n+def delete_lich_hen(ma_lh):\n+    \"\"\"\n+    Xóa lịch hẹn theo mã\n+    \"\"\"\n+    query = \"DELETE FROM LICHHEN WHERE MaLH = %s\"\n+    try:\n+        execute_query(query, (ma_lh,))\n+        return True\n+    except Exception as e:\n+        print(f\"Lỗi khi xóa lịch hẹn: {e}\")\n+        return False","refToolCallId":"toolu_01PJhAN2D8nPmL61XPC9yaZZ"},{"type":"text","text":"Tiếp theo, tôi sẽ cập nhật file app.py để thêm các route cho chức năng quản lý lịch hẹn:"},{"type":"toolCall","toolCallId":"toolu_01GVfFTRZpVxMySgK9oM6o6h","isHidden":false,"title":"","statusText":"Retrieved context","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/app.py","path":"nhakhoaso/app.py","displayPath":"nhakhoaso/app.py"},{"fsPath":"/home/huong/qtcsdl/app.py","path":"qtcsdl/app.py","displayPath":"qtcsdl/app.py"},{"fsPath":"/home/huong/qtcsdl/app.py","path":"qtcsdl/app.py","displayPath":"qtcsdl/app.py"},{"fsPath":"/home/huong/qtcsdl/app.py","path":"qtcsdl/app.py","displayPath":"qtcsdl/app.py"},{"fsPath":"/home/huong/qtcsdl/app.py","path":"qtcsdl/app.py","displayPath":"qtcsdl/app.py"},{"fsPath":"/home/huong/test/app.py","path":"test/app.py","displayPath":"test/app.py"},{"fsPath":"/home/huong/insert/app.py","path":"insert/app.py","displayPath":"insert/app.py"},{"fsPath":"/home/huong/.vscode-server/data/User/History/33c16031/mO0F.py","path":".vscode-server/data/User/History/33c16031/mO0F.py","displayPath":".vscode-server/data/User/History/33c16031/mO0F.py"},{"fsPath":"/home/huong/.vscode-server/data/User/History/33c16031/Wr42.py","path":".vscode-server/data/User/History/33c16031/Wr42.py","displayPath":".vscode-server/data/User/History/33c16031/Wr42.py"},{"fsPath":"/home/huong/.vscode-server/data/User/History/33c16031/Zqhg.py","path":".vscode-server/data/User/History/33c16031/Zqhg.py","displayPath":".vscode-server/data/User/History/33c16031/Zqhg.py"},{"fsPath":"/home/huong/.vscode-server/data/User/History/33c16031/wgdA.py","path":".vscode-server/data/User/History/33c16031/wgdA.py","displayPath":".vscode-server/data/User/History/33c16031/wgdA.py"},{"fsPath":"/home/huong/.vscode-server/data/User/History/33c16031/B4sB.py","path":".vscode-server/data/User/History/33c16031/B4sB.py","displayPath":".vscode-server/data/User/History/33c16031/B4sB.py"},{"fsPath":"/home/huong/.vscode-server/data/User/History/-158b8d14/76Eq.py","path":".vscode-server/data/User/History/-158b8d14/76Eq.py","displayPath":".vscode-server/data/User/History/-158b8d14/76Eq.py"}]}},{"type":"text","text":"Bây giờ tôi sẽ xem file app.py hiện tại để thêm các route cho chức năng quản lý lịch hẹn:"},{"type":"toolCall","toolCallId":"toolu_012SSeUJXjcPeXRsSpSGAYJX","isHidden":false,"title":"","statusText":"Viewed file","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/app.py","path":"nhakhoaso/app.py","displayPath":"nhakhoaso/app.py"}]}},{"type":"toolCall","toolCallId":"toolu_0124oh1CGH1nvNNZ41pgYhZ9","isHidden":false,"title":"","statusText":"Viewed file","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/app.py","path":"nhakhoaso/app.py","displayPath":"nhakhoaso/app.py"}]}},{"type":"text","text":"Bây giờ tôi sẽ cập nhật file app.py để thêm các route cho chức năng quản lý lịch hẹn:"},{"type":"toolCall","toolCallId":"toolu_0167WrZ2U9qkMa98csv8BU9q","isHidden":false,"title":"","statusText":"Change generated","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/app.py","path":"nhakhoaso/app.py","displayPath":"nhakhoaso/app.py"}]}},{"type":"codeHunk","lineBasedDiff":"--- nhakhoaso/app.py\n+++ nhakhoaso/app.py\n@@ -3,6 +3,7 @@\n from database import benh_nhan\n from database.bac_si import get_all_bac_si, get_bac_si_by_id, search_bac_si, create_bac_si, update_bac_si, delete_bac_si\n from database.phieu_kham import get_all_phieu_kham, get_phieu_kham_by_id, search_phieu_kham, create_phieu_kham, update_phieu_kham, delete_phieu_kham\n+from database.lich_hen import get_all_lich_hen, get_lich_hen_by_id, search_lich_hen, create_lich_hen, update_lich_hen, delete_lich_hen\n from database.utils import get_next_benh_nhan_id, get_next_bac_si_id, get_next_dich_vu_id, get_next_lich_hen_id, get_next_phieu_kham_id\n import datetime, json\n ","refToolCallId":"toolu_0167WrZ2U9qkMa98csv8BU9q"},{"type":"toolCall","toolCallId":"toolu_01RPFRUM1MS1kBd7qwtnTWat","isHidden":false,"title":"","statusText":"Change generated","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/app.py","path":"nhakhoaso/app.py","displayPath":"nhakhoaso/app.py"}]}},{"type":"codeHunk","lineBasedDiff":"--- nhakhoaso/app.py\n+++ nhakhoaso/app.py\n@@ -120,8 +120,109 @@\n \n # Quản lý lịch hẹn\n @app.route('/lich-hen')\n-def lich_hen():\n-    return render_template('lich_hen.html')\n+def lich_hen_list():\n+    lich_hen_list = get_all_lich_hen()\n+    return render_template('lich_hen.html', lich_hen_list=lich_hen_list)\n+\n+# Thêm mới lịch hẹn\n+@app.route('/lich-hen/them-moi', methods=['GET', 'POST'])\n+def them_moi_lich_hen():\n+    if request.method == 'POST':\n+        # Xử lý dữ liệu form khi submit\n+        ma_lich_hen = request.form.get('ma_lich_hen')\n+        ma_benh_nhan = request.form.get('ma_benh_nhan')\n+        ngay_hen = request.form.get('ngay_hen')\n+        trang_thai = request.form.get('trang_thai', 'Chưa khám')\n+        \n+        # Kiểm tra dữ liệu đầu vào\n+        if not ma_benh_nhan or not ngay_hen:\n+            flash('Vui lòng điền đầy đủ thông tin bắt buộc', 'error')\n+        else:\n+            # Lưu vào database\n+            ma_lh, result = create_lich_hen(\n+                ma_benh_nhan,\n+                ngay_hen,\n+                trang_thai,\n+                ma_lich_hen\n+            )\n+            \n+            if result:\n+                flash(f'Thêm lịch hẹn thành công với mã {ma_lh}!', 'success')\n+                return redirect(url_for('lich_hen_list'))\n+            else:\n+                flash('Có lỗi xảy ra khi thêm lịch hẹn', 'error')\n+                    \n+    # GET request - hiển thị form với mã lịch hẹn mới\n+    ma_lich_hen = get_next_lich_hen_id()\n+    benh_nhan_list = benh_nhan.get_all_benh_nhan()\n+    \n+    return render_template('them_moi_lich_hen.html', \n+                          ma_lich_hen=ma_lich_hen,\n+                          benh_nhan_list=benh_nhan_list)\n+\n+# Tìm kiếm lịch hẹn\n+@app.route('/lich-hen/tim-kiem', methods=['GET', 'POST'])\n+def tim_kiem_lich_hen():\n+    # Dữ liệu mẫu cho kết quả tìm kiếm\n+    ket_qua = []\n+\n+    if request.method == 'POST':\n+        tu_khoa = request.form.get('tu_khoa')\n+        loai_tim_kiem = request.form.get('loai_tim_kiem', 'ma_lich_hen')\n+        \n+        if tu_khoa:\n+            ket_qua = search_lich_hen(tu_khoa, loai_tim_kiem)\n+            \n+    return render_template('tim_kiem_lich_hen.html', ket_qua=ket_qua)\n+\n+# Chi tiết lịch hẹn\n+@app.route('/lich-hen/chi-tiet/<ma_lh>')\n+def chi_tiet_lich_hen(ma_lh):\n+    lh = get_lich_hen_by_id(ma_lh)\n+    if not lh:\n+        flash('Không tìm thấy lịch hẹn', 'error')\n+        return redirect(url_for('lich_hen_list'))\n+    return render_template('chi_tiet_lich_hen.html', lich_hen=lh)\n+\n+# Chỉnh sửa lịch hẹn\n+@app.route('/lich-hen/chinh-sua/<ma_lh>', methods=['GET', 'POST'])\n+def chinh_sua_lich_hen(ma_lh):\n+    # Lấy thông tin lịch hẹn\n+    lh = get_lich_hen_by_id(ma_lh)\n+    if not lh:\n+        flash('Không tìm thấy lịch hẹn', 'error')\n+        return redirect(url_for('lich_hen_list'))\n+    \n+    if request.method == 'POST':\n+        # Xử lý dữ liệu form khi submit\n+        ma_benh_nhan = request.form.get('ma_benh_nhan')\n+        ngay_hen = request.form.get('ngay_hen')\n+        trang_thai = request.form.get('trang_thai')\n+        \n+        # Kiểm tra dữ liệu đầu vào\n+        if not ma_benh_nhan or not ngay_hen:\n+            flash('Vui lòng điền đầy đủ thông tin bắt buộc', 'error')\n+        else:\n+            # Cập nhật vào database\n+            result = update_lich_hen(\n+                ma_lh,\n+                ma_benh_nhan,\n+                ngay_hen,\n+                trang_thai\n+            )\n+            \n+            if result:\n+                flash('Cập nhật lịch hẹn thành công!', 'success')\n+                return redirect(url_for('chi_tiet_lich_hen', ma_lh=ma_lh))\n+            else:\n+                flash('Có lỗi xảy ra khi cập nhật lịch hẹn', 'error')\n+    \n+    # Lấy danh sách bệnh nhân\n+    benh_nhan_list = benh_nhan.get_all_benh_nhan()\n+    \n+    return render_template('chinh_sua_lich_hen.html', \n+                          lich_hen=lh,\n+                          benh_nhan_list=benh_nhan_list)\n \n # Quản lý dịch vụ\n @app.route('/dich-vu')","refToolCallId":"toolu_01RPFRUM1MS1kBd7qwtnTWat"},{"type":"toolCall","toolCallId":"toolu_01HB14x9uQuewTTLK88kWUvx","isHidden":false,"title":"","statusText":"Change generated","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/app.py","path":"nhakhoaso/app.py","displayPath":"nhakhoaso/app.py"}]}},{"type":"codeHunk","lineBasedDiff":"--- nhakhoaso/app.py\n+++ nhakhoaso/app.py\n@@ -515,5 +515,16 @@\n     except Exception as e:\n         return jsonify({\"success\": False, \"message\": str(e)}), 500\n \n+# API xóa lịch hẹn\n+@app.route('/api/lich-hen/<ma_lh>', methods=['DELETE'])\n+def api_delete_lich_hen(ma_lh):\n+    try:\n+        result = delete_lich_hen(ma_lh)\n+        if not result:\n+            return jsonify({\"success\": False, \"message\": \"Không tìm thấy lịch hẹn hoặc có lỗi xảy ra\"}), 404\n+        return jsonify({\"success\": True, \"message\": \"Xóa lịch hẹn thành công\"})\n+    except Exception as e:\n+        return jsonify({\"success\": False, \"message\": str(e)}), 500\n+\n if __name__ == '__main__':\n     app.run(host='0.0.0.0', port=5001, debug=True)","refToolCallId":"toolu_01HB14x9uQuewTTLK88kWUvx"},{"type":"text","text":"Bây giờ tôi sẽ tạo các template cần thiết cho chức năng quản lý lịch hẹn. Đầu tiên, tôi sẽ tạo template lich_hen.html:"},{"type":"toolCall","toolCallId":"toolu_01Jv89HcfXwnJvNbCe4efthV","isHidden":false,"title":"","statusText":"Change generated","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/templates/lich_hen.html","path":"nhakhoaso/templates/lich_hen.html","displayPath":"nhakhoaso/templates/lich_hen.html"}]}},{"type":"codeHunk","lineBasedDiff":"--- nhakhoaso/templates/lich_hen.html\n+++ nhakhoaso/templates/lich_hen.html\n@@ -0,0 +1,274 @@\n+{% extends 'layout.html' %}\n+\n+{% block title %}Quản lý lịch hẹn - NHAKHOASO{% endblock %}\n+\n+{% block content %}\n+<div class=\"section-title\">\n+    <h2>QUẢN LÝ LỊCH HẸN</h2>\n+</div>\n+\n+<!-- Flash messages -->\n+{% with messages = get_flashed_messages(with_categories=true) %}\n+    {% if messages %}\n+        <div class=\"flash-messages\">\n+            {% for category, message in messages %}\n+                <div class=\"flash-message {{ category }}\">{{ message }}</div>\n+            {% endfor %}\n+        </div>\n+    {% endif %}\n+{% endwith %}\n+\n+<div class=\"page-container\">\n+    <!-- Sidebar -->\n+    <div class=\"sidebar\">\n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-user-injured\"></i> Quản lý bệnh nhân\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_benh_nhan') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới bệnh nhân\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_benh_nhan') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm bệnh nhân\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('benh_nhan_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách bệnh nhân\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-clipboard-list\"></i> Quản lý bác sĩ\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_bac_si') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới bác sĩ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_bac_si') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm bác sĩ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('bac_si_page') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách bác sĩ\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <a href=\"{{ url_for('phieu_kham_list') }}\" style=\"text-decoration: none; color: inherit;\">\n+                <i class=\"fas fa-chart-line\"></i> Quản lý phiếu khám\n+            </a>\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_phieu_kham') }}\">\n+                    <i class=\"fas fa-plus\"></i> Tạo phiếu khám\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_phieu_kham') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm phiếu khám\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('phieu_kham_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách phiếu khám\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-calendar-check\"></i> Quản lý lịch hẹn\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_lich_hen') }}\">\n+                    <i class=\"fas fa-plus\"></i> Đặt lịch hẹn\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_lich_hen') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm lịch hẹn\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('lich_hen_list') }}\" class=\"active\">\n+                    <i class=\"fas fa-list\"></i> Danh sách lịch hẹn\n+                </a>\n+            </li>\n+        </ul>\n+    </div>\n+\n+    <!-- Main content -->\n+    <div class=\"main-content\">\n+        <div class=\"content-header\">\n+            <h2>Danh sách lịch hẹn</h2>\n+        </div>\n+        \n+        <div class=\"module-actions\">\n+            <a href=\"{{ url_for('them_moi_lich_hen') }}\" class=\"btn\"><i class=\"fas fa-plus\"></i> Đặt lịch hẹn mới</a>\n+            <div class=\"search-box\">\n+                <input type=\"text\" placeholder=\"Tìm kiếm lịch hẹn...\">\n+                <button class=\"btn\"><i class=\"fas fa-search\"></i></button>\n+            </div>\n+        </div>\n+\n+        <div class=\"module-content\">\n+            <table class=\"data-table\">\n+                <thead>\n+                    <tr>\n+                        <th>Mã LH</th>\n+                        <th>Mã BN</th>\n+                        <th>Tên bệnh nhân</th>\n+                        <th>Ngày hẹn</th>\n+                        <th>Trạng thái</th>\n+                        <th>Thao tác</th>\n+                    </tr>\n+                </thead>\n+                <tbody>\n+                    {% if lich_hen_list %}\n+                        {% for lich_hen in lich_hen_list %}\n+                        <tr id=\"lich-hen-{{ lich_hen.MaLH }}\">\n+                            <td>{{ lich_hen.MaLH }}</td>\n+                            <td>{{ lich_hen.MaBN }}</td>\n+                            <td>{{ lich_hen.TenBenhNhan }}</td>\n+                            <td>{{ lich_hen.NgayHen }}</td>\n+                            <td>\n+                                <span class=\"status-badge \n+                                    {% if lich_hen.TrangThai == 'Chưa khám' %}status-pending\n+                                    {% elif lich_hen.TrangThai == 'Đã khám' %}status-completed\n+                                    {% elif lich_hen.TrangThai == 'Đã huỷ' %}status-cancelled\n+                                    {% endif %}\">\n+                                    {{ lich_hen.TrangThai }}\n+                                </span>\n+                            </td>\n+                            <td>\n+                                <a \n+                                    href=\"{{ url_for('chi_tiet_lich_hen', ma_lh=lich_hen.MaLH) }}\" \n+                                    class=\"action-btn view-btn\" \n+                                    title=\"Xem chi tiết\">\n+                                    <i class=\"fas fa-eye\"></i>\n+                                </a>\n+                                <a \n+                                    href=\"{{ url_for('chinh_sua_lich_hen', ma_lh=lich_hen.MaLH) }}\" \n+                                    class=\"action-btn edit-btn\" \n+                                    title=\"Chỉnh sửa\">\n+                                    <i class=\"fas fa-edit\"></i>\n+                                </a>\n+                                <a \n+                                    href=\"#\" \n+                                    class=\"action-btn delete-btn\" \n+                                    title=\"Xóa\" \n+                                    onclick=\"deleteLichHen('{{ lich_hen.MaLH }}')\">\n+                                    <i class=\"fas fa-trash\"></i>\n+                                </a>\n+                            </td>\n+                        </tr>\n+                        {% endfor %}\n+                    {% else %}\n+                        <tr>\n+                            <td colspan=\"6\" class=\"text-center\">\n+                                <div class=\"no-data\">\n+                                    <i class=\"fas fa-database\"></i>\n+                                    <p>Chưa có dữ liệu lịch hẹn</p>\n+                                    <a href=\"{{ url_for('them_moi_lich_hen') }}\" class=\"btn\">\n+                                        <i class=\"fas fa-plus\"></i> Đặt lịch hẹn mới\n+                                    </a>\n+                                </div>\n+                            </td>\n+                        </tr>\n+                    {% endif %}\n+                </tbody>\n+            </table>\n+        </div>\n+\n+        <div class=\"pagination\">\n+            <a href=\"#\" class=\"page-link\">&laquo;</a>\n+            <a href=\"#\" class=\"page-link active\">1</a>\n+            <a href=\"#\" class=\"page-link\">2</a>\n+            <a href=\"#\" class=\"page-link\">3</a>\n+            <a href=\"#\" class=\"page-link\">&raquo;</a>\n+        </div>\n+    </div>\n+</div>\n+\n+{% block extra_js %}\n+<script>\n+    // Hàm xóa lịch hẹn\n+    function deleteLichHen(maLH) {\n+        if (confirm('Bạn có chắc chắn muốn xóa lịch hẹn này?')) {\n+            // Gọi API xóa lịch hẹn\n+            fetch(`/api/lich-hen/${maLH}`, {\n+                method: 'DELETE'\n+            })\n+            .then(response => response.json())\n+            .then(data => {\n+                if (data.success) {\n+                    // Xóa dòng khỏi bảng\n+                    document.getElementById(`lich-hen-${maLH}`).remove();\n+                    alert('Xóa lịch hẹn thành công!');\n+                    \n+                    // Kiểm tra nếu không còn lịch hẹn nào, hiển thị thông báo\n+                    const tbody = document.querySelector('.data-table tbody');\n+                    if (tbody.children.length === 0) {\n+                        tbody.innerHTML = `\n+                        <tr>\n+                            <td colspan=\"6\" class=\"text-center\">\n+                                <div class=\"no-data\">\n+                                    <i class=\"fas fa-database\"></i>\n+                                    <p>Chưa có dữ liệu lịch hẹn</p>\n+                                    <a href=\"{{ url_for('them_moi_lich_hen') }}\" class=\"btn\">\n+                                        <i class=\"fas fa-plus\"></i> Đặt lịch hẹn mới\n+                                    </a>\n+                                </div>\n+                            </td>\n+                        </tr>\n+                        `;\n+                    }\n+                } else {\n+                    alert('Lỗi: ' + data.message);\n+                }\n+            })\n+            .catch(error => {\n+                console.error('Error:', error);\n+                alert('Đã xảy ra lỗi khi xóa lịch hẹn');\n+            });\n+        }\n+    }\n+</script>\n+{% endblock %}\n+\n+<style>\n+    .status-badge {\n+        display: inline-block;\n+        padding: 4px 8px;\n+        border-radius: 4px;\n+        font-size: 0.85em;\n+        font-weight: 500;\n+    }\n+    \n+    .status-pending {\n+        background-color: #ffeeba;\n+        color: #856404;\n+    }\n+    \n+    .status-completed {\n+        background-color: #d4edda;\n+        color: #155724;\n+    }\n+    \n+    .status-cancelled {\n+        background-color: #f8d7da;\n+        color: #721c24;\n+    }\n+</style>\n+{% endblock %}","refToolCallId":"toolu_01Jv89HcfXwnJvNbCe4efthV"},{"type":"text","text":"Tiếp theo, tôi sẽ tạo template them_moi_lich_hen.html:"},{"type":"toolCall","toolCallId":"toolu_01WpdXm9gehn4eXFFLDfZY3U","isHidden":false,"title":"","statusText":"Change generated","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/templates/them_moi_lich_hen.html","path":"nhakhoaso/templates/them_moi_lich_hen.html","displayPath":"nhakhoaso/templates/them_moi_lich_hen.html"}]}},{"type":"codeHunk","lineBasedDiff":"--- nhakhoaso/templates/them_moi_lich_hen.html\n+++ nhakhoaso/templates/them_moi_lich_hen.html\n@@ -0,0 +1,213 @@\n+{% extends 'layout.html' %}\n+\n+{% block title %}Đặt lịch hẹn - NHAKHOASO{% endblock %}\n+\n+{% block content %}\n+<div class=\"section-title\">\n+    <h2>QUẢN LÝ LỊCH HẸN</h2>\n+</div>\n+\n+<!-- Flash messages -->\n+{% with messages = get_flashed_messages(with_categories=true) %}\n+    {% if messages %}\n+        <div class=\"flash-messages\">\n+            {% for category, message in messages %}\n+                <div class=\"flash-message {{ category }}\">{{ message }}</div>\n+            {% endfor %}\n+        </div>\n+    {% endif %}\n+{% endwith %}\n+\n+<div class=\"page-container\">\n+    <!-- Sidebar -->\n+    <div class=\"sidebar\">\n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-user-injured\"></i> Quản lý bệnh nhân\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_benh_nhan') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới bệnh nhân\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_benh_nhan') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm bệnh nhân\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('benh_nhan_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách bệnh nhân\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-clipboard-list\"></i> Quản lý bác sĩ\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_bac_si') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới bác sĩ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_bac_si') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm bác sĩ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('bac_si_page') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách bác sĩ\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <a href=\"{{ url_for('phieu_kham_list') }}\" style=\"text-decoration: none; color: inherit;\">\n+                <i class=\"fas fa-chart-line\"></i> Quản lý phiếu khám\n+            </a>\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_phieu_kham') }}\">\n+                    <i class=\"fas fa-plus\"></i> Tạo phiếu khám\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_phieu_kham') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm phiếu khám\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('phieu_kham_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách phiếu khám\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-calendar-check\"></i> Quản lý lịch hẹn\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_lich_hen') }}\" class=\"active\">\n+                    <i class=\"fas fa-plus\"></i> Đặt lịch hẹn\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_lich_hen') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm lịch hẹn\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('lich_hen_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách lịch hẹn\n+                </a>\n+            </li>\n+        </ul>\n+    </div>\n+\n+    <!-- Main content -->\n+    <div class=\"main-content\">\n+        <div class=\"content-header\">\n+            <h2>Đặt lịch hẹn mới</h2>\n+        </div>\n+        \n+        <div class=\"form-container\">\n+            <form action=\"{{ url_for('them_moi_lich_hen') }}\" method=\"POST\">\n+                <div class=\"form-group\">\n+                    <label for=\"ma_lich_hen\">Mã lịch hẹn:</label>\n+                    <input type=\"text\" id=\"ma_lich_hen\" name=\"ma_lich_hen\" value=\"{{ ma_lich_hen }}\" readonly>\n+                    <small>Mã lịch hẹn được tạo tự động</small>\n+                </div>\n+                \n+                <div class=\"form-group\">\n+                    <label for=\"ma_benh_nhan\">Bệnh nhân:</label>\n+                    <select id=\"ma_benh_nhan\" name=\"ma_benh_nhan\" required>\n+                        <option value=\"\">-- Chọn bệnh nhân --</option>\n+                        {% for bn in benh_nhan_list %}\n+                            <option value=\"{{ bn.MaBN }}\">{{ bn.MaBN }} - {{ bn.HoTen }}</option>\n+                        {% endfor %}\n+                    </select>\n+                </div>\n+                \n+                <div class=\"form-group\">\n+                    <label for=\"ngay_hen\">Ngày hẹn:</label>\n+                    <input type=\"datetime-local\" id=\"ngay_hen\" name=\"ngay_hen\" required>\n+                </div>\n+                \n+                <div class=\"form-group\">\n+                    <label for=\"trang_thai\">Trạng thái:</label>\n+                    <select id=\"trang_thai\" name=\"trang_thai\">\n+                        <option value=\"Chưa khám\" selected>Chưa khám</option>\n+                        <option value=\"Đã khám\">Đã khám</option>\n+                        <option value=\"Đã huỷ\">Đã huỷ</option>\n+                    </select>\n+                </div>\n+                \n+                <div class=\"form-actions\">\n+                    <button type=\"submit\" class=\"btn btn-primary\">\n+                        <i class=\"fas fa-save\"></i> Lưu lịch hẹn\n+                    </button>\n+                    <a href=\"{{ url_for('lich_hen_list') }}\" class=\"btn btn-secondary\">\n+                        <i class=\"fas fa-times\"></i> Hủy\n+                    </a>\n+                </div>\n+            </form>\n+        </div>\n+    </div>\n+</div>\n+\n+<style>\n+    .form-container {\n+        background-color: #fff;\n+        padding: 20px;\n+        border-radius: 8px;\n+        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n+    }\n+    \n+    .form-group {\n+        margin-bottom: 20px;\n+    }\n+    \n+    .form-group label {\n+        display: block;\n+        margin-bottom: 5px;\n+        font-weight: 500;\n+    }\n+    \n+    .form-group input,\n+    .form-group select,\n+    .form-group textarea {\n+        width: 100%;\n+        padding: 10px;\n+        border: 1px solid #ddd;\n+        border-radius: 4px;\n+        font-size: 16px;\n+    }\n+    \n+    .form-group small {\n+        display: block;\n+        margin-top: 5px;\n+        color: #666;\n+        font-size: 0.85em;\n+    }\n+    \n+    .form-actions {\n+        display: flex;\n+        gap: 10px;\n+        margin-top: 30px;\n+    }\n+    \n+    .btn-primary {\n+        background-color: var(--primary-color);\n+        color: white;\n+    }\n+    \n+    .btn-secondary {\n+        background-color: #6c757d;\n+        color: white;\n+    }\n+</style>\n+{% endblock %}","refToolCallId":"toolu_01WpdXm9gehn4eXFFLDfZY3U"},{"type":"text","text":"Tiếp theo, tôi sẽ tạo template tim_kiem_lich_hen.html:"},{"type":"toolCall","toolCallId":"toolu_0132dxAMAs7AT6QSuNe3DyRJ","isHidden":false,"title":"","statusText":"Change generated","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/templates/tim_kiem_lich_hen.html","path":"nhakhoaso/templates/tim_kiem_lich_hen.html","displayPath":"nhakhoaso/templates/tim_kiem_lich_hen.html"}]}},{"type":"codeHunk","lineBasedDiff":"--- nhakhoaso/templates/tim_kiem_lich_hen.html\n+++ nhakhoaso/templates/tim_kiem_lich_hen.html\n@@ -0,0 +1,346 @@\n+{% extends 'layout.html' %}\n+\n+{% block title %}Tìm kiếm lịch hẹn - NHAKHOASO{% endblock %}\n+\n+{% block content %}\n+<div class=\"section-title\">\n+    <h2>QUẢN LÝ LỊCH HẸN</h2>\n+</div>\n+\n+<!-- Flash messages -->\n+{% with messages = get_flashed_messages(with_categories=true) %}\n+    {% if messages %}\n+        <div class=\"flash-messages\">\n+            {% for category, message in messages %}\n+                <div class=\"flash-message {{ category }}\">\n+                    {{ message }}\n+                </div>\n+            {% endfor %}\n+        </div>\n+    {% endif %}\n+{% endwith %}\n+\n+<div class=\"page-container\">\n+    <!-- Sidebar -->\n+    <div class=\"sidebar\">\n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-user-injured\"></i> Quản lý bệnh nhân\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_benh_nhan') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới bệnh nhân\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_benh_nhan') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm bệnh nhân\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('benh_nhan_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách bệnh nhân\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-clipboard-list\"></i> Quản lý bác sĩ\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_bac_si') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới bác sĩ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_bac_si') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm bác sĩ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('bac_si_page') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách bác sĩ\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <a href=\"{{ url_for('phieu_kham_list') }}\" style=\"text-decoration: none; color: inherit;\">\n+                <i class=\"fas fa-chart-line\"></i> Quản lý phiếu khám\n+            </a>\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_phieu_kham') }}\">\n+                    <i class=\"fas fa-plus\"></i> Tạo phiếu khám\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_phieu_kham') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm phiếu khám\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('phieu_kham_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách phiếu khám\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-calendar-check\"></i> Quản lý lịch hẹn\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_lich_hen') }}\">\n+                    <i class=\"fas fa-plus\"></i> Đặt lịch hẹn\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_lich_hen') }}\" class=\"active\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm lịch hẹn\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('lich_hen_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách lịch hẹn\n+                </a>\n+            </li>\n+        </ul>\n+    </div>\n+\n+    <!-- Main content -->\n+    <div class=\"main-content\">\n+        <div class=\"content-header\">\n+            <h2>Tìm kiếm lịch hẹn</h2>\n+        </div>\n+        \n+        <div class=\"search-container\">\n+            <form action=\"{{ url_for('tim_kiem_lich_hen') }}\" method=\"POST\" class=\"search-form\">\n+                <div class=\"search-input-group\">\n+                    <input type=\"text\" name=\"tu_khoa\" class=\"form-control\" placeholder=\"Nhập mã lịch hẹn, mã bệnh nhân hoặc trạng thái...\" value=\"{{ request.form.get('tu_khoa', '') }}\">\n+                    <button type=\"submit\" class=\"btn-search\">\n+                        <i class=\"fas fa-search\"></i> Tìm kiếm\n+                    </button>\n+                </div>\n+                <div class=\"search-options\">\n+                    <label class=\"search-option\">\n+                        <input type=\"radio\" name=\"loai_tim_kiem\" value=\"ma_lich_hen\" checked> Mã lịch hẹn\n+                    </label>\n+                    <label class=\"search-option\">\n+                        <input type=\"radio\" name=\"loai_tim_kiem\" value=\"ma_benh_nhan\"> Mã bệnh nhân\n+                    </label>\n+                    <label class=\"search-option\">\n+                        <input type=\"radio\" name=\"loai_tim_kiem\" value=\"trang_thai\"> Trạng thái\n+                    </label>\n+                </div>\n+            </form>\n+        </div>\n+        \n+        <div class=\"search-results\">\n+            {% if request.method == 'POST' %}\n+                {% if ket_qua %}\n+                    <div class=\"result-header\">\n+                        <h3>Kết quả tìm kiếm</h3>\n+                        <p>Tìm thấy {{ ket_qua|length }} lịch hẹn</p>\n+                    </div>\n+                    \n+                    <table class=\"data-table\">\n+                        <thead>\n+                            <tr>\n+                                <th>Mã LH</th>\n+                                <th>Mã BN</th>\n+                                <th>Tên bệnh nhân</th>\n+                                <th>Ngày hẹn</th>\n+                                <th>Trạng thái</th>\n+                                <th>Thao tác</th>\n+                            </tr>\n+                        </thead>\n+                        <tbody>\n+                            {% for lh in ket_qua %}\n+                                <tr id=\"lich-hen-{{ lh.MaLH }}\">\n+                                    <td>{{ lh.MaLH }}</td>\n+                                    <td>{{ lh.MaBN }}</td>\n+                                    <td>{{ lh.TenBenhNhan }}</td>\n+                                    <td>{{ lh.NgayHen }}</td>\n+                                    <td>\n+                                        <span class=\"status-badge \n+                                            {% if lh.TrangThai == 'Chưa khám' %}status-pending\n+                                            {% elif lh.TrangThai == 'Đã khám' %}status-completed\n+                                            {% elif lh.TrangThai == 'Đã huỷ' %}status-cancelled\n+                                            {% endif %}\">\n+                                            {{ lh.TrangThai }}\n+                                        </span>\n+                                    </td>\n+                                    <td>\n+                                        <a href=\"{{ url_for('chi_tiet_lich_hen', ma_lh=lh.MaLH) }}\" class=\"action-btn view-btn\" title=\"Xem chi tiết\"><i class=\"fas fa-eye\"></i></a>\n+                                        <a href=\"{{ url_for('chinh_sua_lich_hen', ma_lh=lh.MaLH) }}\" class=\"action-btn edit-btn\" title=\"Chỉnh sửa\"><i class=\"fas fa-edit\"></i></a>\n+                                        <a href=\"#\" class=\"action-btn delete-btn\" title=\"Xóa\" onclick=\"deleteLichHen('{{ lh.MaLH }}')\"><i class=\"fas fa-trash\"></i></a>\n+                                    </td>\n+                                </tr>\n+                            {% endfor %}\n+                        </tbody>\n+                    </table>\n+                {% else %}\n+                    <div class=\"no-results\">\n+                        <i class=\"fas fa-search\"></i>\n+                        <p>Không tìm thấy lịch hẹn nào phù hợp với từ khóa tìm kiếm.</p>\n+                        <p>Vui lòng thử lại với từ khóa khác hoặc <a href=\"{{ url_for('them_moi_lich_hen') }}\">đặt lịch hẹn mới</a>.</p>\n+                    </div>\n+                {% endif %}\n+            {% endif %}\n+        </div>\n+    </div>\n+</div>\n+\n+<style>\n+    .search-container {\n+        background-color: var(--secondary-color);\n+        padding: 20px;\n+        border-radius: 8px;\n+        margin-bottom: 30px;\n+    }\n+    \n+    .search-form {\n+        width: 100%;\n+    }\n+    \n+    .search-input-group {\n+        display: flex;\n+        margin-bottom: 15px;\n+    }\n+    \n+    .search-input-group input {\n+        flex: 1;\n+        padding: 12px 15px;\n+        border: 1px solid var(--border-color);\n+        border-radius: 5px 0 0 5px;\n+        font-size: 16px;\n+    }\n+    \n+    .btn-search {\n+        padding: 0 20px;\n+        background-color: var(--primary-color);\n+        color: white;\n+        border: none;\n+        border-radius: 0 5px 5px 0;\n+        cursor: pointer;\n+        font-size: 16px;\n+        display: flex;\n+        align-items: center;\n+    }\n+    \n+    .btn-search i {\n+        margin-right: 8px;\n+    }\n+    \n+    .search-options {\n+        display: flex;\n+        flex-wrap: wrap;\n+        gap: 15px;\n+    }\n+    \n+    .search-option {\n+        display: flex;\n+        align-items: center;\n+        cursor: pointer;\n+    }\n+    \n+    .search-option input {\n+        margin-right: 5px;\n+    }\n+    \n+    .result-header {\n+        display: flex;\n+        justify-content: space-between;\n+        align-items: center;\n+        margin-bottom: 15px;\n+    }\n+    \n+    .result-header h3 {\n+        margin: 0;\n+        font-size: 18px;\n+    }\n+    \n+    .result-header p {\n+        margin: 0;\n+        color: var(--text-muted);\n+    }\n+    \n+    .no-results {\n+        text-align: center;\n+        padding: 40px 20px;\n+        background-color: #f8f9fa;\n+        border-radius: 8px;\n+    }\n+    \n+    .no-results i {\n+        font-size: 48px;\n+        color: #adb5bd;\n+        margin-bottom: 15px;\n+    }\n+    \n+    .no-results p {\n+        margin: 10px 0;\n+        color: #6c757d;\n+    }\n+    \n+    .no-results a {\n+        color: var(--primary-color);\n+        text-decoration: none;\n+        font-weight: 500;\n+    }\n+    \n+    .status-badge {\n+        display: inline-block;\n+        padding: 4px 8px;\n+        border-radius: 4px;\n+        font-size: 0.85em;\n+        font-weight: 500;\n+    }\n+    \n+    .status-pending {\n+        background-color: #ffeeba;\n+        color: #856404;\n+    }\n+    \n+    .status-completed {\n+        background-color: #d4edda;\n+        color: #155724;\n+    }\n+    \n+    .status-cancelled {\n+        background-color: #f8d7da;\n+        color: #721c24;\n+    }\n+</style>\n+\n+{% block extra_js %}\n+<script>\n+    // Hàm xóa lịch hẹn\n+    function deleteLichHen(maLH) {\n+        if (confirm('Bạn có chắc chắn muốn xóa lịch hẹn này?')) {\n+            // Gọi API xóa lịch hẹn\n+            fetch(`/api/lich-hen/${maLH}`, {\n+                method: 'DELETE'\n+            })\n+            .then(response => response.json())\n+            .then(data => {\n+                if (data.success) {\n+                    // Xóa dòng khỏi bảng\n+                    document.getElementById(`lich-hen-${maLH}`).remove();\n+                    alert('Xóa lịch hẹn thành công!');\n+                } else {\n+                    alert('Lỗi: ' + data.message);\n+                }\n+            })\n+            .catch(error => {\n+                console.error('Error:', error);\n+                alert('Đã xảy ra lỗi khi xóa lịch hẹn');\n+            });\n+        }\n+    }\n+</script>\n+{% endblock %}\n+{% endblock %}","refToolCallId":"toolu_0132dxAMAs7AT6QSuNe3DyRJ"},{"type":"text","text":"Tiếp theo, tôi sẽ tạo template chi_tiet_lich_hen.html:"},{"type":"toolCall","toolCallId":"toolu_015eqmN56jzhj4hoK4CBFg23","isHidden":false,"title":"","statusText":"Change generated","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/templates/chi_tiet_lich_hen.html","path":"nhakhoaso/templates/chi_tiet_lich_hen.html","displayPath":"nhakhoaso/templates/chi_tiet_lich_hen.html"}]}},{"type":"codeHunk","lineBasedDiff":"--- nhakhoaso/templates/chi_tiet_lich_hen.html\n+++ nhakhoaso/templates/chi_tiet_lich_hen.html\n@@ -0,0 +1,330 @@\n+{% extends 'layout.html' %}\n+\n+{% block title %}Chi tiết lịch hẹn - NHAKHOASO{% endblock %}\n+\n+{% block content %}\n+<div class=\"section-title\">\n+    <h2>QUẢN LÝ LỊCH HẸN</h2>\n+</div>\n+\n+<!-- Flash messages -->\n+{% with messages = get_flashed_messages(with_categories=true) %}\n+    {% if messages %}\n+        <div class=\"flash-messages\">\n+            {% for category, message in messages %}\n+                <div class=\"flash-message {{ category }}\">{{ message }}</div>\n+            {% endfor %}\n+        </div>\n+    {% endif %}\n+{% endwith %}\n+\n+<div class=\"page-container\">\n+    <!-- Sidebar -->\n+    <div class=\"sidebar\">\n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-user-injured\"></i> Quản lý bệnh nhân\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_benh_nhan') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới bệnh nhân\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_benh_nhan') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm bệnh nhân\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('benh_nhan_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách bệnh nhân\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-clipboard-list\"></i> Quản lý bác sĩ\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_bac_si') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới bác sĩ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_bac_si') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm bác sĩ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('bac_si_page') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách bác sĩ\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <a href=\"{{ url_for('phieu_kham_list') }}\" style=\"text-decoration: none; color: inherit;\">\n+                <i class=\"fas fa-chart-line\"></i> Quản lý phiếu khám\n+            </a>\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_phieu_kham') }}\">\n+                    <i class=\"fas fa-plus\"></i> Tạo phiếu khám\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_phieu_kham') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm phiếu khám\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('phieu_kham_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách phiếu khám\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-calendar-check\"></i> Quản lý lịch hẹn\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_lich_hen') }}\">\n+                    <i class=\"fas fa-plus\"></i> Đặt lịch hẹn\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_lich_hen') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm lịch hẹn\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('lich_hen_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách lịch hẹn\n+                </a>\n+            </li>\n+        </ul>\n+    </div>\n+\n+    <!-- Main content -->\n+    <div class=\"main-content\">\n+        <div class=\"content-header\">\n+            <h2>Chi tiết lịch hẹn</h2>\n+            <div class=\"header-actions\">\n+                <a href=\"{{ url_for('chinh_sua_lich_hen', ma_lh=lich_hen.MaLH) }}\" class=\"btn btn-primary\">\n+                    <i class=\"fas fa-edit\"></i> Chỉnh sửa\n+                </a>\n+                <a href=\"{{ url_for('lich_hen_list') }}\" class=\"btn btn-secondary\">\n+                    <i class=\"fas fa-arrow-left\"></i> Quay lại\n+                </a>\n+            </div>\n+        </div>\n+        \n+        <div class=\"detail-container\">\n+            <div class=\"detail-card\">\n+                <div class=\"detail-header\">\n+                    <h3>Thông tin lịch hẹn</h3>\n+                    <span class=\"status-badge \n+                        {% if lich_hen.TrangThai == 'Chưa khám' %}status-pending\n+                        {% elif lich_hen.TrangThai == 'Đã khám' %}status-completed\n+                        {% elif lich_hen.TrangThai == 'Đã huỷ' %}status-cancelled\n+                        {% endif %}\">\n+                        {{ lich_hen.TrangThai }}\n+                    </span>\n+                </div>\n+                \n+                <div class=\"detail-content\">\n+                    <div class=\"detail-row\">\n+                        <div class=\"detail-label\">Mã lịch hẹn:</div>\n+                        <div class=\"detail-value\">{{ lich_hen.MaLH }}</div>\n+                    </div>\n+                    \n+                    <div class=\"detail-row\">\n+                        <div class=\"detail-label\">Mã bệnh nhân:</div>\n+                        <div class=\"detail-value\">{{ lich_hen.MaBN }}</div>\n+                    </div>\n+                    \n+                    <div class=\"detail-row\">\n+                        <div class=\"detail-label\">Tên bệnh nhân:</div>\n+                        <div class=\"detail-value\">{{ lich_hen.TenBenhNhan }}</div>\n+                    </div>\n+                    \n+                    <div class=\"detail-row\">\n+                        <div class=\"detail-label\">Ngày hẹn:</div>\n+                        <div class=\"detail-value\">{{ lich_hen.NgayHen }}</div>\n+                    </div>\n+                    \n+                    <div class=\"detail-row\">\n+                        <div class=\"detail-label\">Trạng thái:</div>\n+                        <div class=\"detail-value\">{{ lich_hen.TrangThai }}</div>\n+                    </div>\n+                </div>\n+                \n+                <div class=\"detail-actions\">\n+                    <a href=\"{{ url_for('chinh_sua_lich_hen', ma_lh=lich_hen.MaLH) }}\" class=\"btn btn-primary\">\n+                        <i class=\"fas fa-edit\"></i> Chỉnh sửa\n+                    </a>\n+                    <button class=\"btn btn-danger\" onclick=\"deleteLichHen('{{ lich_hen.MaLH }}')\">\n+                        <i class=\"fas fa-trash\"></i> Xóa\n+                    </button>\n+                    <a href=\"{{ url_for('lich_hen_list') }}\" class=\"btn btn-secondary\">\n+                        <i class=\"fas fa-arrow-left\"></i> Quay lại\n+                    </a>\n+                </div>\n+            </div>\n+        </div>\n+    </div>\n+</div>\n+\n+<style>\n+    .content-header {\n+        display: flex;\n+        justify-content: space-between;\n+        align-items: center;\n+        margin-bottom: 20px;\n+    }\n+    \n+    .header-actions {\n+        display: flex;\n+        gap: 10px;\n+    }\n+    \n+    .detail-container {\n+        background-color: #fff;\n+        border-radius: 8px;\n+        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n+        overflow: hidden;\n+    }\n+    \n+    .detail-card {\n+        padding: 0;\n+    }\n+    \n+    .detail-header {\n+        background-color: var(--secondary-color);\n+        padding: 15px 20px;\n+        display: flex;\n+        justify-content: space-between;\n+        align-items: center;\n+    }\n+    \n+    .detail-header h3 {\n+        margin: 0;\n+        font-size: 18px;\n+        color: var(--primary-color);\n+    }\n+    \n+    .detail-content {\n+        padding: 20px;\n+    }\n+    \n+    .detail-row {\n+        display: flex;\n+        margin-bottom: 15px;\n+        border-bottom: 1px solid #eee;\n+        padding-bottom: 15px;\n+    }\n+    \n+    .detail-row:last-child {\n+        margin-bottom: 0;\n+        border-bottom: none;\n+        padding-bottom: 0;\n+    }\n+    \n+    .detail-label {\n+        width: 150px;\n+        font-weight: 500;\n+        color: #555;\n+    }\n+    \n+    .detail-value {\n+        flex: 1;\n+    }\n+    \n+    .detail-actions {\n+        padding: 15px 20px;\n+        background-color: #f8f9fa;\n+        display: flex;\n+        gap: 10px;\n+        justify-content: flex-end;\n+    }\n+    \n+    .btn {\n+        padding: 8px 15px;\n+        border: none;\n+        border-radius: 4px;\n+        cursor: pointer;\n+        font-size: 14px;\n+        display: inline-flex;\n+        align-items: center;\n+        gap: 5px;\n+    }\n+    \n+    .btn-primary {\n+        background-color: var(--primary-color);\n+        color: white;\n+    }\n+    \n+    .btn-secondary {\n+        background-color: #6c757d;\n+        color: white;\n+    }\n+    \n+    .btn-danger {\n+        background-color: #dc3545;\n+        color: white;\n+    }\n+    \n+    .status-badge {\n+        display: inline-block;\n+        padding: 4px 8px;\n+        border-radius: 4px;\n+        font-size: 0.85em;\n+        font-weight: 500;\n+    }\n+    \n+    .status-pending {\n+        background-color: #ffeeba;\n+        color: #856404;\n+    }\n+    \n+    .status-completed {\n+        background-color: #d4edda;\n+        color: #155724;\n+    }\n+    \n+    .status-cancelled {\n+        background-color: #f8d7da;\n+        color: #721c24;\n+    }\n+</style>\n+\n+{% block extra_js %}\n+<script>\n+    // Hàm xóa lịch hẹn\n+    function deleteLichHen(maLH) {\n+        if (confirm('Bạn có chắc chắn muốn xóa lịch hẹn này?')) {\n+            // Gọi API xóa lịch hẹn\n+            fetch(`/api/lich-hen/${maLH}`, {\n+                method: 'DELETE'\n+            })\n+            .then(response => response.json())\n+            .then(data => {\n+                if (data.success) {\n+                    alert('Xóa lịch hẹn thành công!');\n+                    window.location.href = \"{{ url_for('lich_hen_list') }}\";\n+                } else {\n+                    alert('Lỗi: ' + data.message);\n+                }\n+            })\n+            .catch(error => {\n+                console.error('Error:', error);\n+                alert('Đã xảy ra lỗi khi xóa lịch hẹn');\n+            });\n+        }\n+    }\n+</script>\n+{% endblock %}\n+{% endblock %}","refToolCallId":"toolu_015eqmN56jzhj4hoK4CBFg23"},{"type":"text","text":"Cuối cùng, tôi sẽ tạo template chinh_sua_lich_hen.html:"},{"type":"toolCall","toolCallId":"toolu_01TSW51yjFXMR2Tdb4v5vaQ8","isHidden":false,"title":"","statusText":"Change generated","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/templates/chinh_sua_lich_hen.html","path":"nhakhoaso/templates/chinh_sua_lich_hen.html","displayPath":"nhakhoaso/templates/chinh_sua_lich_hen.html"}]}},{"type":"codeHunk","lineBasedDiff":"--- nhakhoaso/templates/chinh_sua_lich_hen.html\n+++ nhakhoaso/templates/chinh_sua_lich_hen.html\n@@ -0,0 +1,215 @@\n+{% extends 'layout.html' %}\n+\n+{% block title %}Chỉnh sửa lịch hẹn - NHAKHOASO{% endblock %}\n+\n+{% block content %}\n+<div class=\"section-title\">\n+    <h2>QUẢN LÝ LỊCH HẸN</h2>\n+</div>\n+\n+<!-- Flash messages -->\n+{% with messages = get_flashed_messages(with_categories=true) %}\n+    {% if messages %}\n+        <div class=\"flash-messages\">\n+            {% for category, message in messages %}\n+                <div class=\"flash-message {{ category }}\">{{ message }}</div>\n+            {% endfor %}\n+        </div>\n+    {% endif %}\n+{% endwith %}\n+\n+<div class=\"page-container\">\n+    <!-- Sidebar -->\n+    <div class=\"sidebar\">\n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-user-injured\"></i> Quản lý bệnh nhân\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_benh_nhan') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới bệnh nhân\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_benh_nhan') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm bệnh nhân\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('benh_nhan_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách bệnh nhân\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-clipboard-list\"></i> Quản lý bác sĩ\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_bac_si') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới bác sĩ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_bac_si') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm bác sĩ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('bac_si_page') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách bác sĩ\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <a href=\"{{ url_for('phieu_kham_list') }}\" style=\"text-decoration: none; color: inherit;\">\n+                <i class=\"fas fa-chart-line\"></i> Quản lý phiếu khám\n+            </a>\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_phieu_kham') }}\">\n+                    <i class=\"fas fa-plus\"></i> Tạo phiếu khám\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_phieu_kham') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm phiếu khám\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('phieu_kham_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách phiếu khám\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-calendar-check\"></i> Quản lý lịch hẹn\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_lich_hen') }}\">\n+                    <i class=\"fas fa-plus\"></i> Đặt lịch hẹn\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_lich_hen') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm lịch hẹn\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('lich_hen_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách lịch hẹn\n+                </a>\n+            </li>\n+        </ul>\n+    </div>\n+\n+    <!-- Main content -->\n+    <div class=\"main-content\">\n+        <div class=\"content-header\">\n+            <h2>Chỉnh sửa lịch hẹn</h2>\n+        </div>\n+        \n+        <div class=\"form-container\">\n+            <form action=\"{{ url_for('chinh_sua_lich_hen', ma_lh=lich_hen.MaLH) }}\" method=\"POST\">\n+                <div class=\"form-group\">\n+                    <label for=\"ma_lich_hen\">Mã lịch hẹn:</label>\n+                    <input type=\"text\" id=\"ma_lich_hen\" name=\"ma_lich_hen\" value=\"{{ lich_hen.MaLH }}\" readonly>\n+                    <small>Mã lịch hẹn không thể thay đổi</small>\n+                </div>\n+                \n+                <div class=\"form-group\">\n+                    <label for=\"ma_benh_nhan\">Bệnh nhân:</label>\n+                    <select id=\"ma_benh_nhan\" name=\"ma_benh_nhan\" required>\n+                        <option value=\"\">-- Chọn bệnh nhân --</option>\n+                        {% for bn in benh_nhan_list %}\n+                            <option value=\"{{ bn.MaBN }}\" {% if bn.MaBN == lich_hen.MaBN %}selected{% endif %}>\n+                                {{ bn.MaBN }} - {{ bn.HoTen }}\n+                            </option>\n+                        {% endfor %}\n+                    </select>\n+                </div>\n+                \n+                <div class=\"form-group\">\n+                    <label for=\"ngay_hen\">Ngày hẹn:</label>\n+                    <input type=\"datetime-local\" id=\"ngay_hen\" name=\"ngay_hen\" value=\"{{ lich_hen.NgayHen|replace(' ', 'T') }}\" required>\n+                </div>\n+                \n+                <div class=\"form-group\">\n+                    <label for=\"trang_thai\">Trạng thái:</label>\n+                    <select id=\"trang_thai\" name=\"trang_thai\">\n+                        <option value=\"Chưa khám\" {% if lich_hen.TrangThai == 'Chưa khám' %}selected{% endif %}>Chưa khám</option>\n+                        <option value=\"Đã khám\" {% if lich_hen.TrangThai == 'Đã khám' %}selected{% endif %}>Đã khám</option>\n+                        <option value=\"Đã huỷ\" {% if lich_hen.TrangThai == 'Đã huỷ' %}selected{% endif %}>Đã huỷ</option>\n+                    </select>\n+                </div>\n+                \n+                <div class=\"form-actions\">\n+                    <button type=\"submit\" class=\"btn btn-primary\">\n+                        <i class=\"fas fa-save\"></i> Lưu thay đổi\n+                    </button>\n+                    <a href=\"{{ url_for('chi_tiet_lich_hen', ma_lh=lich_hen.MaLH) }}\" class=\"btn btn-secondary\">\n+                        <i class=\"fas fa-times\"></i> Hủy\n+                    </a>\n+                </div>\n+            </form>\n+        </div>\n+    </div>\n+</div>\n+\n+<style>\n+    .form-container {\n+        background-color: #fff;\n+        padding: 20px;\n+        border-radius: 8px;\n+        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n+    }\n+    \n+    .form-group {\n+        margin-bottom: 20px;\n+    }\n+    \n+    .form-group label {\n+        display: block;\n+        margin-bottom: 5px;\n+        font-weight: 500;\n+    }\n+    \n+    .form-group input,\n+    .form-group select,\n+    .form-group textarea {\n+        width: 100%;\n+        padding: 10px;\n+        border: 1px solid #ddd;\n+        border-radius: 4px;\n+        font-size: 16px;\n+    }\n+    \n+    .form-group small {\n+        display: block;\n+        margin-top: 5px;\n+        color: #666;\n+        font-size: 0.85em;\n+    }\n+    \n+    .form-actions {\n+        display: flex;\n+        gap: 10px;\n+        margin-top: 30px;\n+    }\n+    \n+    .btn-primary {\n+        background-color: var(--primary-color);\n+        color: white;\n+    }\n+    \n+    .btn-secondary {\n+        background-color: #6c757d;\n+        color: white;\n+    }\n+</style>\n+{% endblock %}","refToolCallId":"toolu_01TSW51yjFXMR2Tdb4v5vaQ8"},{"type":"text","text":"Tôi đã hoàn thành việc tạo các file cần thiết cho chức năng quản lý lịch hẹn. Dưới đây là tổng kết những gì đã làm:\n\n1. **Database Layer**:\n   - Tạo file `database/lich_hen.py` với các hàm CRUD cho bảng LICHHEN\n   - Sử dụng hàm `get_next_lich_hen_id()` từ `utils.py` để tạo ID mới\n\n2. **Routes trong app.py**:\n   - Thêm import từ module `lich_hen`\n   - Tạo các route cho danh sách lịch hẹn, thêm mới, tìm kiếm, chi tiết, chỉnh sửa\n   - Thêm API endpoint để xóa lịch hẹn\n\n3. **Templates**:\n   - `lich_hen.html`: Hiển thị danh sách lịch hẹn\n   - `them_moi_lich_hen.html`: Form thêm mới lịch hẹn\n   - `tim_kiem_lich_hen.html`: Form tìm kiếm và hiển thị kết quả\n   - `chi_tiet_lich_hen.html`: Hiển thị chi tiết lịch hẹn\n   - `chinh_sua_lich_hen.html`: Form chỉnh sửa lịch hẹn\n\nTất cả các chức năng đã được triển khai đầy đủ và tương tự như chức năng quản lý phiếu khám, bao gồm:\n- Thêm mới lịch hẹn\n- Tìm kiếm lịch hẹn\n- Xem danh sách lịch hẹn\n- Xem chi tiết lịch hẹn\n- Chỉnh sửa lịch hẹn\n- Xóa lịch hẹn\n\nCác template đã được thiết kế với giao diện nhất quán với các phần khác của ứng dụng, và các chức năng JavaScript cần thiết đã được thêm vào để xử lý các tác vụ như xóa lịch hẹn.\n\nBạn có thể truy cập các chức năng này thông qua menu sidebar trong ứng dụng, phần \"Quản lý lịch hẹn\"."},{"type":"codePatch","diffs":[{"path":"nhakhoaso/templates/lich_hen.html","patch":"@@ -0,0 +1,10155 @@\n+%7B%25 extends 'layout.html' %25%7D%0A%0A%7B%25 block title %25%7DQu%E1%BA%A3n l%C3%BD l%E1%BB%8Bch h%E1%BA%B9n - NHAKHOASO%7B%25 endblock %25%7D%0A%0A%7B%25 block content %25%7D%0A%3Cdiv class=%22section-title%22%3E%0A    %3Ch2%3EQU%E1%BA%A2N L%C3%9D L%E1%BB%8ACH H%E1%BA%B8N%3C/h2%3E%0A%3C/div%3E%0A%0A%3C!-- Flash messages --%3E%0A%7B%25 with messages = get_flashed_messages(with_categories=true) %25%7D%0A    %7B%25 if messages %25%7D%0A        %3Cdiv class=%22flash-messages%22%3E%0A            %7B%25 for category, message in messages %25%7D%0A                %3Cdiv class=%22flash-message %7B%7B category %7D%7D%22%3E%7B%7B message %7D%7D%3C/div%3E%0A            %7B%25 endfor %25%7D%0A        %3C/div%3E%0A    %7B%25 endif %25%7D%0A%7B%25 endwith %25%7D%0A%0A%3Cdiv class=%22page-container%22%3E%0A    %3C!-- Sidebar --%3E%0A    %3Cdiv class=%22sidebar%22%3E%0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-user-injured%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD b%E1%BB%87nh nh%C3%A2n%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_benh_nhan') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_benh_nhan') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('benh_nhan_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-clipboard-list%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD b%C3%A1c s%C4%A9%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_bac_si') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_bac_si') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('bac_si_page') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ca href=%22%7B%7B url_for('phieu_kham_list') %7D%7D%22 style=%22text-decoration: none; color: inherit;%22%3E%0A                %3Ci class=%22fas fa-chart-line%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD phi%E1%BA%BFu kh%C3%A1m%0A            %3C/a%3E%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_phieu_kham') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E T%E1%BA%A1o phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_phieu_kham') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('phieu_kham_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-calendar-check%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD l%E1%BB%8Bch h%E1%BA%B9n%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_lich_hen') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E %C4%90%E1%BA%B7t l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_lich_hen') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('lich_hen_list') %7D%7D%22 class=%22active%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A    %3C/div%3E%0A%0A    %3C!-- Main content --%3E%0A    %3Cdiv class=%22main-content%22%3E%0A        %3Cdiv class=%22content-header%22%3E%0A            %3Ch2%3EDanh s%C3%A1ch l%E1%BB%8Bch h%E1%BA%B9n%3C/h2%3E%0A        %3C/div%3E%0A        %0A        %3Cdiv class=%22module-actions%22%3E%0A            %3Ca href=%22%7B%7B url_for('them_moi_lich_hen') %7D%7D%22 class=%22btn%22%3E%3Ci class=%22fas fa-plus%22%3E%3C/i%3E %C4%90%E1%BA%B7t l%E1%BB%8Bch h%E1%BA%B9n m%E1%BB%9Bi%3C/a%3E%0A            %3Cdiv class=%22search-box%22%3E%0A                %3Cinput type=%22text%22 placeholder=%22T%C3%ACm ki%E1%BA%BFm l%E1%BB%8Bch h%E1%BA%B9n...%22%3E%0A                %3Cbutton class=%22btn%22%3E%3Ci class=%22fas fa-search%22%3E%3C/i%3E%3C/button%3E%0A            %3C/div%3E%0A        %3C/div%3E%0A%0A        %3Cdiv class=%22module-content%22%3E%0A            %3Ctable class=%22data-table%22%3E%0A                %3Cthead%3E%0A                    %3Ctr%3E%0A                        %3Cth%3EM%C3%A3 LH%3C/th%3E%0A                        %3Cth%3EM%C3%A3 BN%3C/th%3E%0A                        %3Cth%3ET%C3%AAn b%E1%BB%87nh nh%C3%A2n%3C/th%3E%0A                        %3Cth%3ENg%C3%A0y h%E1%BA%B9n%3C/th%3E%0A                        %3Cth%3ETr%E1%BA%A1ng th%C3%A1i%3C/th%3E%0A                        %3Cth%3EThao t%C3%A1c%3C/th%3E%0A                    %3C/tr%3E%0A                %3C/thead%3E%0A                %3Ctbody%3E%0A                    %7B%25 if lich_hen_list %25%7D%0A                        %7B%25 for lich_hen in lich_hen_list %25%7D%0A                        %3Ctr id=%22lich-hen-%7B%7B lich_hen.MaLH %7D%7D%22%3E%0A                            %3Ctd%3E%7B%7B lich_hen.MaLH %7D%7D%3C/td%3E%0A                            %3Ctd%3E%7B%7B lich_hen.MaBN %7D%7D%3C/td%3E%0A                            %3Ctd%3E%7B%7B lich_hen.TenBenhNhan %7D%7D%3C/td%3E%0A                            %3Ctd%3E%7B%7B lich_hen.NgayHen %7D%7D%3C/td%3E%0A                            %3Ctd%3E%0A                                %3Cspan class=%22status-badge %0A                                    %7B%25 if lich_hen.TrangThai == 'Ch%C6%B0a kh%C3%A1m' %25%7Dstatus-pending%0A                                    %7B%25 elif lich_hen.TrangThai == '%C4%90%C3%A3 kh%C3%A1m' %25%7Dstatus-completed%0A                                    %7B%25 elif lich_hen.TrangThai == '%C4%90%C3%A3 hu%E1%BB%B7' %25%7Dstatus-cancelled%0A                                    %7B%25 endif %25%7D%22%3E%0A                                    %7B%7B lich_hen.TrangThai %7D%7D%0A                                %3C/span%3E%0A                            %3C/td%3E%0A                            %3Ctd%3E%0A                                %3Ca %0A                                    href=%22%7B%7B url_for('chi_tiet_lich_hen', ma_lh=lich_hen.MaLH) %7D%7D%22 %0A                                    class=%22action-btn view-btn%22 %0A                                    title=%22Xem chi ti%E1%BA%BFt%22%3E%0A                                    %3Ci class=%22fas fa-eye%22%3E%3C/i%3E%0A                                %3C/a%3E%0A                                %3Ca %0A                                    href=%22%7B%7B url_for('chinh_sua_lich_hen', ma_lh=lich_hen.MaLH) %7D%7D%22 %0A                                    class=%22action-btn edit-btn%22 %0A                                    title=%22Ch%E1%BB%89nh s%E1%BB%ADa%22%3E%0A                                    %3Ci class=%22fas fa-edit%22%3E%3C/i%3E%0A                                %3C/a%3E%0A                                %3Ca %0A                                    href=%22#%22 %0A                                    class=%22action-btn delete-btn%22 %0A                                    title=%22X%C3%B3a%22 %0A                                    onclick=%22deleteLichHen('%7B%7B lich_hen.MaLH %7D%7D')%22%3E%0A                                    %3Ci class=%22fas fa-trash%22%3E%3C/i%3E%0A                                %3C/a%3E%0A                            %3C/td%3E%0A                        %3C/tr%3E%0A                        %7B%25 endfor %25%7D%0A                    %7B%25 else %25%7D%0A                        %3Ctr%3E%0A                            %3Ctd colspan=%226%22 class=%22text-center%22%3E%0A                                %3Cdiv class=%22no-data%22%3E%0A                                    %3Ci class=%22fas fa-database%22%3E%3C/i%3E%0A                                    %3Cp%3ECh%C6%B0a c%C3%B3 d%E1%BB%AF li%E1%BB%87u l%E1%BB%8Bch h%E1%BA%B9n%3C/p%3E%0A                                    %3Ca href=%22%7B%7B url_for('them_moi_lich_hen') %7D%7D%22 class=%22btn%22%3E%0A                                        %3Ci class=%22fas fa-plus%22%3E%3C/i%3E %C4%90%E1%BA%B7t l%E1%BB%8Bch h%E1%BA%B9n m%E1%BB%9Bi%0A                                    %3C/a%3E%0A                                %3C/div%3E%0A                            %3C/td%3E%0A                        %3C/tr%3E%0A                    %7B%25 endif %25%7D%0A                %3C/tbody%3E%0A            %3C/table%3E%0A        %3C/div%3E%0A%0A        %3Cdiv class=%22pagination%22%3E%0A            %3Ca href=%22#%22 class=%22page-link%22%3E&laquo;%3C/a%3E%0A            %3Ca href=%22#%22 class=%22page-link active%22%3E1%3C/a%3E%0A            %3Ca href=%22#%22 class=%22page-link%22%3E2%3C/a%3E%0A            %3Ca href=%22#%22 class=%22page-link%22%3E3%3C/a%3E%0A            %3Ca href=%22#%22 class=%22page-link%22%3E&raquo;%3C/a%3E%0A        %3C/div%3E%0A    %3C/div%3E%0A%3C/div%3E%0A%0A%7B%25 block extra_js %25%7D%0A%3Cscript%3E%0A    // H%C3%A0m x%C3%B3a l%E1%BB%8Bch h%E1%BA%B9n%0A    function deleteLichHen(maLH) %7B%0A        if (confirm('B%E1%BA%A1n c%C3%B3 ch%E1%BA%AFc ch%E1%BA%AFn mu%E1%BB%91n x%C3%B3a l%E1%BB%8Bch h%E1%BA%B9n n%C3%A0y?')) %7B%0A            // G%E1%BB%8Di API x%C3%B3a l%E1%BB%8Bch h%E1%BA%B9n%0A            fetch(%60/api/lich-hen/$%7BmaLH%7D%60, %7B%0A                method: 'DELETE'%0A            %7D)%0A            .then(response =%3E response.json())%0A            .then(data =%3E %7B%0A                if (data.success) %7B%0A                    // X%C3%B3a d%C3%B2ng kh%E1%BB%8Fi b%E1%BA%A3ng%0A                    document.getElementById(%60lich-hen-$%7BmaLH%7D%60).remove();%0A                    alert('X%C3%B3a l%E1%BB%8Bch h%E1%BA%B9n th%C3%A0nh c%C3%B4ng!');%0A                    %0A                    // Ki%E1%BB%83m tra n%E1%BA%BFu kh%C3%B4ng c%C3%B2n l%E1%BB%8Bch h%E1%BA%B9n n%C3%A0o, hi%E1%BB%83n th%E1%BB%8B th%C3%B4ng b%C3%A1o%0A                    const tbody = document.querySelector('.data-table tbody');%0A                    if (tbody.children.length === 0) %7B%0A                        tbody.innerHTML = %60%0A                        %3Ctr%3E%0A                            %3Ctd colspan=%226%22 class=%22text-center%22%3E%0A                                %3Cdiv class=%22no-data%22%3E%0A                                    %3Ci class=%22fas fa-database%22%3E%3C/i%3E%0A                                    %3Cp%3ECh%C6%B0a c%C3%B3 d%E1%BB%AF li%E1%BB%87u l%E1%BB%8Bch h%E1%BA%B9n%3C/p%3E%0A                                    %3Ca href=%22%7B%7B url_for('them_moi_lich_hen') %7D%7D%22 class=%22btn%22%3E%0A                                        %3Ci class=%22fas fa-plus%22%3E%3C/i%3E %C4%90%E1%BA%B7t l%E1%BB%8Bch h%E1%BA%B9n m%E1%BB%9Bi%0A                                    %3C/a%3E%0A                                %3C/div%3E%0A                            %3C/td%3E%0A                        %3C/tr%3E%0A                        %60;%0A                    %7D%0A                %7D else %7B%0A                    alert('L%E1%BB%97i: ' + data.message);%0A                %7D%0A            %7D)%0A            .catch(error =%3E %7B%0A                console.error('Error:', error);%0A                alert('%C4%90%C3%A3 x%E1%BA%A3y ra l%E1%BB%97i khi x%C3%B3a l%E1%BB%8Bch h%E1%BA%B9n');%0A            %7D);%0A        %7D%0A    %7D%0A%3C/script%3E%0A%7B%25 endblock %25%7D%0A%0A%3Cstyle%3E%0A    .status-badge %7B%0A        display: inline-block;%0A        padding: 4px 8px;%0A        border-radius: 4px;%0A        font-size: 0.85em;%0A        font-weight: 500;%0A    %7D%0A    %0A    .status-pending %7B%0A        background-color: #ffeeba;%0A        color: #856404;%0A    %7D%0A    %0A    .status-completed %7B%0A        background-color: #d4edda;%0A        color: #155724;%0A    %7D%0A    %0A    .status-cancelled %7B%0A        background-color: #f8d7da;%0A        color: #721c24;%0A    %7D%0A%3C/style%3E%0A%7B%25 endblock %25%7D\n","isNew":true,"isApplied":true,"isUnread":false},{"path":"nhakhoaso/templates/tim_kiem_lich_hen.html","patch":"@@ -0,0 +1,11304 @@\n+%7B%25 extends 'layout.html' %25%7D%0A%0A%7B%25 block title %25%7DT%C3%ACm ki%E1%BA%BFm l%E1%BB%8Bch h%E1%BA%B9n - NHAKHOASO%7B%25 endblock %25%7D%0A%0A%7B%25 block content %25%7D%0A%3Cdiv class=%22section-title%22%3E%0A    %3Ch2%3EQU%E1%BA%A2N L%C3%9D L%E1%BB%8ACH H%E1%BA%B8N%3C/h2%3E%0A%3C/div%3E%0A%0A%3C!-- Flash messages --%3E%0A%7B%25 with messages = get_flashed_messages(with_categories=true) %25%7D%0A    %7B%25 if messages %25%7D%0A        %3Cdiv class=%22flash-messages%22%3E%0A            %7B%25 for category, message in messages %25%7D%0A                %3Cdiv class=%22flash-message %7B%7B category %7D%7D%22%3E%0A                    %7B%7B message %7D%7D%0A                %3C/div%3E%0A            %7B%25 endfor %25%7D%0A        %3C/div%3E%0A    %7B%25 endif %25%7D%0A%7B%25 endwith %25%7D%0A%0A%3Cdiv class=%22page-container%22%3E%0A    %3C!-- Sidebar --%3E%0A    %3Cdiv class=%22sidebar%22%3E%0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-user-injured%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD b%E1%BB%87nh nh%C3%A2n%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_benh_nhan') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_benh_nhan') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('benh_nhan_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-clipboard-list%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD b%C3%A1c s%C4%A9%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_bac_si') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_bac_si') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('bac_si_page') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ca href=%22%7B%7B url_for('phieu_kham_list') %7D%7D%22 style=%22text-decoration: none; color: inherit;%22%3E%0A                %3Ci class=%22fas fa-chart-line%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD phi%E1%BA%BFu kh%C3%A1m%0A            %3C/a%3E%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_phieu_kham') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E T%E1%BA%A1o phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_phieu_kham') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('phieu_kham_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-calendar-check%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD l%E1%BB%8Bch h%E1%BA%B9n%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_lich_hen') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E %C4%90%E1%BA%B7t l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_lich_hen') %7D%7D%22 class=%22active%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('lich_hen_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A    %3C/div%3E%0A%0A    %3C!-- Main content --%3E%0A    %3Cdiv class=%22main-content%22%3E%0A        %3Cdiv class=%22content-header%22%3E%0A            %3Ch2%3ET%C3%ACm ki%E1%BA%BFm l%E1%BB%8Bch h%E1%BA%B9n%3C/h2%3E%0A        %3C/div%3E%0A        %0A        %3Cdiv class=%22search-container%22%3E%0A            %3Cform action=%22%7B%7B url_for('tim_kiem_lich_hen') %7D%7D%22 method=%22POST%22 class=%22search-form%22%3E%0A                %3Cdiv class=%22search-input-group%22%3E%0A                    %3Cinput type=%22text%22 name=%22tu_khoa%22 class=%22form-control%22 placeholder=%22Nh%E1%BA%ADp m%C3%A3 l%E1%BB%8Bch h%E1%BA%B9n, m%C3%A3 b%E1%BB%87nh nh%C3%A2n ho%E1%BA%B7c tr%E1%BA%A1ng th%C3%A1i...%22 value=%22%7B%7B request.form.get('tu_khoa', '') %7D%7D%22%3E%0A                    %3Cbutton type=%22submit%22 class=%22btn-search%22%3E%0A                        %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm%0A                    %3C/button%3E%0A                %3C/div%3E%0A                %3Cdiv class=%22search-options%22%3E%0A                    %3Clabel class=%22search-option%22%3E%0A                        %3Cinput type=%22radio%22 name=%22loai_tim_kiem%22 value=%22ma_lich_hen%22 checked%3E M%C3%A3 l%E1%BB%8Bch h%E1%BA%B9n%0A                    %3C/label%3E%0A                    %3Clabel class=%22search-option%22%3E%0A                        %3Cinput type=%22radio%22 name=%22loai_tim_kiem%22 value=%22ma_benh_nhan%22%3E M%C3%A3 b%E1%BB%87nh nh%C3%A2n%0A                    %3C/label%3E%0A                    %3Clabel class=%22search-option%22%3E%0A                        %3Cinput type=%22radio%22 name=%22loai_tim_kiem%22 value=%22trang_thai%22%3E Tr%E1%BA%A1ng th%C3%A1i%0A                    %3C/label%3E%0A                %3C/div%3E%0A            %3C/form%3E%0A        %3C/div%3E%0A        %0A        %3Cdiv class=%22search-results%22%3E%0A            %7B%25 if request.method == 'POST' %25%7D%0A                %7B%25 if ket_qua %25%7D%0A                    %3Cdiv class=%22result-header%22%3E%0A                        %3Ch3%3EK%E1%BA%BFt qu%E1%BA%A3 t%C3%ACm ki%E1%BA%BFm%3C/h3%3E%0A                        %3Cp%3ET%C3%ACm th%E1%BA%A5y %7B%7B ket_qua%7Clength %7D%7D l%E1%BB%8Bch h%E1%BA%B9n%3C/p%3E%0A                    %3C/div%3E%0A                    %0A                    %3Ctable class=%22data-table%22%3E%0A                        %3Cthead%3E%0A                            %3Ctr%3E%0A                                %3Cth%3EM%C3%A3 LH%3C/th%3E%0A                                %3Cth%3EM%C3%A3 BN%3C/th%3E%0A                                %3Cth%3ET%C3%AAn b%E1%BB%87nh nh%C3%A2n%3C/th%3E%0A                                %3Cth%3ENg%C3%A0y h%E1%BA%B9n%3C/th%3E%0A                                %3Cth%3ETr%E1%BA%A1ng th%C3%A1i%3C/th%3E%0A                                %3Cth%3EThao t%C3%A1c%3C/th%3E%0A                            %3C/tr%3E%0A                        %3C/thead%3E%0A                        %3Ctbody%3E%0A                            %7B%25 for lh in ket_qua %25%7D%0A                                %3Ctr id=%22lich-hen-%7B%7B lh.MaLH %7D%7D%22%3E%0A                                    %3Ctd%3E%7B%7B lh.MaLH %7D%7D%3C/td%3E%0A                                    %3Ctd%3E%7B%7B lh.MaBN %7D%7D%3C/td%3E%0A                                    %3Ctd%3E%7B%7B lh.TenBenhNhan %7D%7D%3C/td%3E%0A                                    %3Ctd%3E%7B%7B lh.NgayHen %7D%7D%3C/td%3E%0A                                    %3Ctd%3E%0A                                        %3Cspan class=%22status-badge %0A                                            %7B%25 if lh.TrangThai == 'Ch%C6%B0a kh%C3%A1m' %25%7Dstatus-pending%0A                                            %7B%25 elif lh.TrangThai == '%C4%90%C3%A3 kh%C3%A1m' %25%7Dstatus-completed%0A                                            %7B%25 elif lh.TrangThai == '%C4%90%C3%A3 hu%E1%BB%B7' %25%7Dstatus-cancelled%0A                                            %7B%25 endif %25%7D%22%3E%0A                                            %7B%7B lh.TrangThai %7D%7D%0A                                        %3C/span%3E%0A                                    %3C/td%3E%0A                                    %3Ctd%3E%0A                                        %3Ca href=%22%7B%7B url_for('chi_tiet_lich_hen', ma_lh=lh.MaLH) %7D%7D%22 class=%22action-btn view-btn%22 title=%22Xem chi ti%E1%BA%BFt%22%3E%3Ci class=%22fas fa-eye%22%3E%3C/i%3E%3C/a%3E%0A                                        %3Ca href=%22%7B%7B url_for('chinh_sua_lich_hen', ma_lh=lh.MaLH) %7D%7D%22 class=%22action-btn edit-btn%22 title=%22Ch%E1%BB%89nh s%E1%BB%ADa%22%3E%3Ci class=%22fas fa-edit%22%3E%3C/i%3E%3C/a%3E%0A                                        %3Ca href=%22#%22 class=%22action-btn delete-btn%22 title=%22X%C3%B3a%22 onclick=%22deleteLichHen('%7B%7B lh.MaLH %7D%7D')%22%3E%3Ci class=%22fas fa-trash%22%3E%3C/i%3E%3C/a%3E%0A                                    %3C/td%3E%0A                                %3C/tr%3E%0A                            %7B%25 endfor %25%7D%0A                        %3C/tbody%3E%0A                    %3C/table%3E%0A                %7B%25 else %25%7D%0A                    %3Cdiv class=%22no-results%22%3E%0A                        %3Ci class=%22fas fa-search%22%3E%3C/i%3E%0A                        %3Cp%3EKh%C3%B4ng t%C3%ACm th%E1%BA%A5y l%E1%BB%8Bch h%E1%BA%B9n n%C3%A0o ph%C3%B9 h%E1%BB%A3p v%E1%BB%9Bi t%E1%BB%AB kh%C3%B3a t%C3%ACm ki%E1%BA%BFm.%3C/p%3E%0A                        %3Cp%3EVui l%C3%B2ng th%E1%BB%AD l%E1%BA%A1i v%E1%BB%9Bi t%E1%BB%AB kh%C3%B3a kh%C3%A1c ho%E1%BA%B7c %3Ca href=%22%7B%7B url_for('them_moi_lich_hen') %7D%7D%22%3E%C4%91%E1%BA%B7t l%E1%BB%8Bch h%E1%BA%B9n m%E1%BB%9Bi%3C/a%3E.%3C/p%3E%0A                    %3C/div%3E%0A                %7B%25 endif %25%7D%0A            %7B%25 endif %25%7D%0A        %3C/div%3E%0A    %3C/div%3E%0A%3C/div%3E%0A%0A%3Cstyle%3E%0A    .search-container %7B%0A        background-color: var(--secondary-color);%0A        padding: 20px;%0A        border-radius: 8px;%0A        margin-bottom: 30px;%0A    %7D%0A    %0A    .search-form %7B%0A        width: 100%25;%0A    %7D%0A    %0A    .search-input-group %7B%0A        display: flex;%0A        margin-bottom: 15px;%0A    %7D%0A    %0A    .search-input-group input %7B%0A        flex: 1;%0A        padding: 12px 15px;%0A        border: 1px solid var(--border-color);%0A        border-radius: 5px 0 0 5px;%0A        font-size: 16px;%0A    %7D%0A    %0A    .btn-search %7B%0A        padding: 0 20px;%0A        background-color: var(--primary-color);%0A        color: white;%0A        border: none;%0A        border-radius: 0 5px 5px 0;%0A        cursor: pointer;%0A        font-size: 16px;%0A        display: flex;%0A        align-items: center;%0A    %7D%0A    %0A    .btn-search i %7B%0A        margin-right: 8px;%0A    %7D%0A    %0A    .search-options %7B%0A        display: flex;%0A        flex-wrap: wrap;%0A        gap: 15px;%0A    %7D%0A    %0A    .search-option %7B%0A        display: flex;%0A        align-items: center;%0A        cursor: pointer;%0A    %7D%0A    %0A    .search-option input %7B%0A        margin-right: 5px;%0A    %7D%0A    %0A    .result-header %7B%0A        display: flex;%0A        justify-content: space-between;%0A        align-items: center;%0A        margin-bottom: 15px;%0A    %7D%0A    %0A    .result-header h3 %7B%0A        margin: 0;%0A        font-size: 18px;%0A    %7D%0A    %0A    .result-header p %7B%0A        margin: 0;%0A        color: var(--text-muted);%0A    %7D%0A    %0A    .no-results %7B%0A        text-align: center;%0A        padding: 40px 20px;%0A        background-color: #f8f9fa;%0A        border-radius: 8px;%0A    %7D%0A    %0A    .no-results i %7B%0A        font-size: 48px;%0A        color: #adb5bd;%0A        margin-bottom: 15px;%0A    %7D%0A    %0A    .no-results p %7B%0A        margin: 10px 0;%0A        color: #6c757d;%0A    %7D%0A    %0A    .no-results a %7B%0A        color: var(--primary-color);%0A        text-decoration: none;%0A        font-weight: 500;%0A    %7D%0A    %0A    .status-badge %7B%0A        display: inline-block;%0A        padding: 4px 8px;%0A        border-radius: 4px;%0A        font-size: 0.85em;%0A        font-weight: 500;%0A    %7D%0A    %0A    .status-pending %7B%0A        background-color: #ffeeba;%0A        color: #856404;%0A    %7D%0A    %0A    .status-completed %7B%0A        background-color: #d4edda;%0A        color: #155724;%0A    %7D%0A    %0A    .status-cancelled %7B%0A        background-color: #f8d7da;%0A        color: #721c24;%0A    %7D%0A%3C/style%3E%0A%0A%7B%25 block extra_js %25%7D%0A%3Cscript%3E%0A    // H%C3%A0m x%C3%B3a l%E1%BB%8Bch h%E1%BA%B9n%0A    function deleteLichHen(maLH) %7B%0A        if (confirm('B%E1%BA%A1n c%C3%B3 ch%E1%BA%AFc ch%E1%BA%AFn mu%E1%BB%91n x%C3%B3a l%E1%BB%8Bch h%E1%BA%B9n n%C3%A0y?')) %7B%0A            // G%E1%BB%8Di API x%C3%B3a l%E1%BB%8Bch h%E1%BA%B9n%0A            fetch(%60/api/lich-hen/$%7BmaLH%7D%60, %7B%0A                method: 'DELETE'%0A            %7D)%0A            .then(response =%3E response.json())%0A            .then(data =%3E %7B%0A                if (data.success) %7B%0A                    // X%C3%B3a d%C3%B2ng kh%E1%BB%8Fi b%E1%BA%A3ng%0A                    document.getElementById(%60lich-hen-$%7BmaLH%7D%60).remove();%0A                    alert('X%C3%B3a l%E1%BB%8Bch h%E1%BA%B9n th%C3%A0nh c%C3%B4ng!');%0A                %7D else %7B%0A                    alert('L%E1%BB%97i: ' + data.message);%0A                %7D%0A            %7D)%0A            .catch(error =%3E %7B%0A                console.error('Error:', error);%0A                alert('%C4%90%C3%A3 x%E1%BA%A3y ra l%E1%BB%97i khi x%C3%B3a l%E1%BB%8Bch h%E1%BA%B9n');%0A            %7D);%0A        %7D%0A    %7D%0A%3C/script%3E%0A%7B%25 endblock %25%7D%0A%7B%25 endblock %25%7D\n","isNew":true,"isApplied":true,"isUnread":false},{"path":"nhakhoaso/templates/them_moi_lich_hen.html","patch":"@@ -0,0 +1,6859 @@\n+%7B%25 extends 'layout.html' %25%7D%0A%0A%7B%25 block title %25%7D%C4%90%E1%BA%B7t l%E1%BB%8Bch h%E1%BA%B9n - NHAKHOASO%7B%25 endblock %25%7D%0A%0A%7B%25 block content %25%7D%0A%3Cdiv class=%22section-title%22%3E%0A    %3Ch2%3EQU%E1%BA%A2N L%C3%9D L%E1%BB%8ACH H%E1%BA%B8N%3C/h2%3E%0A%3C/div%3E%0A%0A%3C!-- Flash messages --%3E%0A%7B%25 with messages = get_flashed_messages(with_categories=true) %25%7D%0A    %7B%25 if messages %25%7D%0A        %3Cdiv class=%22flash-messages%22%3E%0A            %7B%25 for category, message in messages %25%7D%0A                %3Cdiv class=%22flash-message %7B%7B category %7D%7D%22%3E%7B%7B message %7D%7D%3C/div%3E%0A            %7B%25 endfor %25%7D%0A        %3C/div%3E%0A    %7B%25 endif %25%7D%0A%7B%25 endwith %25%7D%0A%0A%3Cdiv class=%22page-container%22%3E%0A    %3C!-- Sidebar --%3E%0A    %3Cdiv class=%22sidebar%22%3E%0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-user-injured%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD b%E1%BB%87nh nh%C3%A2n%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_benh_nhan') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_benh_nhan') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('benh_nhan_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-clipboard-list%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD b%C3%A1c s%C4%A9%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_bac_si') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_bac_si') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('bac_si_page') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ca href=%22%7B%7B url_for('phieu_kham_list') %7D%7D%22 style=%22text-decoration: none; color: inherit;%22%3E%0A                %3Ci class=%22fas fa-chart-line%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD phi%E1%BA%BFu kh%C3%A1m%0A            %3C/a%3E%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_phieu_kham') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E T%E1%BA%A1o phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_phieu_kham') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('phieu_kham_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-calendar-check%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD l%E1%BB%8Bch h%E1%BA%B9n%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_lich_hen') %7D%7D%22 class=%22active%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E %C4%90%E1%BA%B7t l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_lich_hen') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('lich_hen_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A    %3C/div%3E%0A%0A    %3C!-- Main content --%3E%0A    %3Cdiv class=%22main-content%22%3E%0A        %3Cdiv class=%22content-header%22%3E%0A            %3Ch2%3E%C4%90%E1%BA%B7t l%E1%BB%8Bch h%E1%BA%B9n m%E1%BB%9Bi%3C/h2%3E%0A        %3C/div%3E%0A        %0A        %3Cdiv class=%22form-container%22%3E%0A            %3Cform action=%22%7B%7B url_for('them_moi_lich_hen') %7D%7D%22 method=%22POST%22%3E%0A                %3Cdiv class=%22form-group%22%3E%0A                    %3Clabel for=%22ma_lich_hen%22%3EM%C3%A3 l%E1%BB%8Bch h%E1%BA%B9n:%3C/label%3E%0A                    %3Cinput type=%22text%22 id=%22ma_lich_hen%22 name=%22ma_lich_hen%22 value=%22%7B%7B ma_lich_hen %7D%7D%22 readonly%3E%0A                    %3Csmall%3EM%C3%A3 l%E1%BB%8Bch h%E1%BA%B9n %C4%91%C6%B0%E1%BB%A3c t%E1%BA%A1o t%E1%BB%B1 %C4%91%E1%BB%99ng%3C/small%3E%0A                %3C/div%3E%0A                %0A                %3Cdiv class=%22form-group%22%3E%0A                    %3Clabel for=%22ma_benh_nhan%22%3EB%E1%BB%87nh nh%C3%A2n:%3C/label%3E%0A                    %3Cselect id=%22ma_benh_nhan%22 name=%22ma_benh_nhan%22 required%3E%0A                        %3Coption value=%22%22%3E-- Ch%E1%BB%8Dn b%E1%BB%87nh nh%C3%A2n --%3C/option%3E%0A                        %7B%25 for bn in benh_nhan_list %25%7D%0A                            %3Coption value=%22%7B%7B bn.MaBN %7D%7D%22%3E%7B%7B bn.MaBN %7D%7D - %7B%7B bn.HoTen %7D%7D%3C/option%3E%0A                        %7B%25 endfor %25%7D%0A                    %3C/select%3E%0A                %3C/div%3E%0A                %0A                %3Cdiv class=%22form-group%22%3E%0A                    %3Clabel for=%22ngay_hen%22%3ENg%C3%A0y h%E1%BA%B9n:%3C/label%3E%0A                    %3Cinput type=%22datetime-local%22 id=%22ngay_hen%22 name=%22ngay_hen%22 required%3E%0A                %3C/div%3E%0A                %0A                %3Cdiv class=%22form-group%22%3E%0A                    %3Clabel for=%22trang_thai%22%3ETr%E1%BA%A1ng th%C3%A1i:%3C/label%3E%0A                    %3Cselect id=%22trang_thai%22 name=%22trang_thai%22%3E%0A                        %3Coption value=%22Ch%C6%B0a kh%C3%A1m%22 selected%3ECh%C6%B0a kh%C3%A1m%3C/option%3E%0A                        %3Coption value=%22%C4%90%C3%A3 kh%C3%A1m%22%3E%C4%90%C3%A3 kh%C3%A1m%3C/option%3E%0A                        %3Coption value=%22%C4%90%C3%A3 hu%E1%BB%B7%22%3E%C4%90%C3%A3 hu%E1%BB%B7%3C/option%3E%0A                    %3C/select%3E%0A                %3C/div%3E%0A                %0A                %3Cdiv class=%22form-actions%22%3E%0A                    %3Cbutton type=%22submit%22 class=%22btn btn-primary%22%3E%0A                        %3Ci class=%22fas fa-save%22%3E%3C/i%3E L%C6%B0u l%E1%BB%8Bch h%E1%BA%B9n%0A                    %3C/button%3E%0A                    %3Ca href=%22%7B%7B url_for('lich_hen_list') %7D%7D%22 class=%22btn btn-secondary%22%3E%0A                        %3Ci class=%22fas fa-times%22%3E%3C/i%3E H%E1%BB%A7y%0A                    %3C/a%3E%0A                %3C/div%3E%0A            %3C/form%3E%0A        %3C/div%3E%0A    %3C/div%3E%0A%3C/div%3E%0A%0A%3Cstyle%3E%0A    .form-container %7B%0A        background-color: #fff;%0A        padding: 20px;%0A        border-radius: 8px;%0A        box-shadow: 0 2px 4px rgba(0,0,0,0.1);%0A    %7D%0A    %0A    .form-group %7B%0A        margin-bottom: 20px;%0A    %7D%0A    %0A    .form-group label %7B%0A        display: block;%0A        margin-bottom: 5px;%0A        font-weight: 500;%0A    %7D%0A    %0A    .form-group input,%0A    .form-group select,%0A    .form-group textarea %7B%0A        width: 100%25;%0A        padding: 10px;%0A        border: 1px solid #ddd;%0A        border-radius: 4px;%0A        font-size: 16px;%0A    %7D%0A    %0A    .form-group small %7B%0A        display: block;%0A        margin-top: 5px;%0A        color: #666;%0A        font-size: 0.85em;%0A    %7D%0A    %0A    .form-actions %7B%0A        display: flex;%0A        gap: 10px;%0A        margin-top: 30px;%0A    %7D%0A    %0A    .btn-primary %7B%0A        background-color: var(--primary-color);%0A        color: white;%0A    %7D%0A    %0A    .btn-secondary %7B%0A        background-color: #6c757d;%0A        color: white;%0A    %7D%0A%3C/style%3E%0A%7B%25 endblock %25%7D\n","isNew":true,"isApplied":true,"isUnread":false},{"path":"nhakhoaso/database/lich_hen.py","patch":"@@ -0,0 +1,3372 @@\n+from .db import execute_query%0Aimport datetime%0Afrom .utils import get_next_lich_hen_id%0A%0Adef get_all_lich_hen():%0A    %22%22%22%0A    L%E1%BA%A5y danh s%C3%A1ch t%E1%BA%A5t c%E1%BA%A3 l%E1%BB%8Bch h%E1%BA%B9n%0A    %22%22%22%0A    query = %22%22%22%0A    SELECT lh.*, bn.HoTen as TenBenhNhan%0A    FROM LICHHEN lh%0A    JOIN BENHNHAN bn ON lh.MaBN = bn.MaBN%0A    ORDER BY lh.NgayHen DESC%0A    %22%22%22%0A    return execute_query(query, fetch=True)%0A%0Adef get_lich_hen_by_id(ma_lh):%0A    %22%22%22%0A    L%E1%BA%A5y th%C3%B4ng tin l%E1%BB%8Bch h%E1%BA%B9n theo m%C3%A3%0A    %22%22%22%0A    query = %22%22%22%0A    SELECT lh.*, bn.HoTen as TenBenhNhan%0A    FROM LICHHEN lh%0A    JOIN BENHNHAN bn ON lh.MaBN = bn.MaBN%0A    WHERE lh.MaLH = %25s%0A    %22%22%22%0A    result = execute_query(query, (ma_lh,), fetch=True)%0A    return result%5B0%5D if result else None%0A%0Adef search_lich_hen(tu_khoa, loai_tim_kiem='ma_lich_hen'):%0A    %22%22%22%0A    T%C3%ACm ki%E1%BA%BFm l%E1%BB%8Bch h%E1%BA%B9n theo t%E1%BB%AB kh%C3%B3a v%C3%A0 lo%E1%BA%A1i t%C3%ACm ki%E1%BA%BFm%0A    %0A    Args:%0A        tu_khoa (str): T%E1%BB%AB kh%C3%B3a t%C3%ACm ki%E1%BA%BFm%0A        loai_tim_kiem (str): Lo%E1%BA%A1i t%C3%ACm ki%E1%BA%BFm (ma_lich_hen, ma_benh_nhan, trang_thai)%0A        %0A    Returns:%0A        list: Danh s%C3%A1ch l%E1%BB%8Bch h%E1%BA%B9n t%C3%ACm th%E1%BA%A5y%0A    %22%22%22%0A    if loai_tim_kiem == 'ma_lich_hen':%0A        query = %22%22%22%0A        SELECT lh.*, bn.HoTen as TenBenhNhan%0A        FROM LICHHEN lh%0A        JOIN BENHNHAN bn ON lh.MaBN = bn.MaBN%0A        WHERE lh.MaLH LIKE %25s%0A        %22%22%22%0A    elif loai_tim_kiem == 'ma_benh_nhan':%0A        query = %22%22%22%0A        SELECT lh.*, bn.HoTen as TenBenhNhan%0A        FROM LICHHEN lh%0A        JOIN BENHNHAN bn ON lh.MaBN = bn.MaBN%0A        WHERE lh.MaBN LIKE %25s%0A        %22%22%22%0A    elif loai_tim_kiem == 'trang_thai':%0A        query = %22%22%22%0A        SELECT lh.*, bn.HoTen as TenBenhNhan%0A        FROM LICHHEN lh%0A        JOIN BENHNHAN bn ON lh.MaBN = bn.MaBN%0A        WHERE lh.TrangThai LIKE %25s COLLATE NOCASE%0A        %22%22%22%0A    else:%0A        return %5B%5D%0A        %0A    return execute_query(query, (f'%25%7Btu_khoa%7D%25',), fetch=True)%0A%0Adef create_lich_hen(ma_bn, ngay_hen, trang_thai=%22Ch%C6%B0a kh%C3%A1m%22, ma_lh=None):%0A    %22%22%22%0A    T%E1%BA%A1o m%E1%BB%9Bi l%E1%BB%8Bch h%E1%BA%B9n%0A    %0A    Args:%0A        ma_bn (str): M%C3%A3 b%E1%BB%87nh nh%C3%A2n%0A        ngay_hen (str): Ng%C3%A0y h%E1%BA%B9n (%C4%91%E1%BB%8Bnh d%E1%BA%A1ng YYYY-MM-DD HH:MM:SS)%0A        trang_thai (str, optional): Tr%E1%BA%A1ng th%C3%A1i l%E1%BB%8Bch h%E1%BA%B9n%0A        ma_lh (str, optional): M%C3%A3 l%E1%BB%8Bch h%E1%BA%B9n (n%E1%BA%BFu kh%C3%B4ng cung c%E1%BA%A5p s%E1%BA%BD t%E1%BB%B1 %C4%91%E1%BB%99ng t%E1%BA%A1o)%0A        %0A    Returns:%0A        tuple: (ma_lh, success) - M%C3%A3 l%E1%BB%8Bch h%E1%BA%B9n v%C3%A0 k%E1%BA%BFt qu%E1%BA%A3 th%C3%A0nh c%C3%B4ng hay kh%C3%B4ng%0A    %22%22%22%0A    # N%E1%BA%BFu kh%C3%B4ng c%C3%B3 m%C3%A3 l%E1%BB%8Bch h%E1%BA%B9n, t%E1%BA%A1o m%C3%A3 m%E1%BB%9Bi%0A    if not ma_lh:%0A        ma_lh = get_next_lich_hen_id()%0A        %0A    query = %22%22%22%0A    INSERT INTO LICHHEN (MaLH, MaBN, NgayHen, TrangThai)%0A    VALUES (%25s, %25s, %25s, %25s)%0A    %22%22%22%0A    %0A    try:%0A        execute_query(query, (ma_lh, ma_bn, ngay_hen, trang_thai))%0A        return ma_lh, True%0A    except Exception as e:%0A        print(f%22L%E1%BB%97i khi t%E1%BA%A1o l%E1%BB%8Bch h%E1%BA%B9n: %7Be%7D%22)%0A        return None, False%0A%0Adef update_lich_hen(ma_lh, ma_bn, ngay_hen, trang_thai):%0A    %22%22%22%0A    C%E1%BA%ADp nh%E1%BA%ADt th%C3%B4ng tin l%E1%BB%8Bch h%E1%BA%B9n%0A    %22%22%22%0A    query = %22%22%22%0A    UPDATE LICHHEN%0A    SET MaBN = %25s, NgayHen = %25s, TrangThai = %25s%0A    WHERE MaLH = %25s%0A    %22%22%22%0A    %0A    try:%0A        execute_query(query, (ma_bn, ngay_hen, trang_thai, ma_lh))%0A        return True%0A    except Exception as e:%0A        print(f%22L%E1%BB%97i khi c%E1%BA%ADp nh%E1%BA%ADt l%E1%BB%8Bch h%E1%BA%B9n: %7Be%7D%22)%0A        return False%0A%0Adef delete_lich_hen(ma_lh):%0A    %22%22%22%0A    X%C3%B3a l%E1%BB%8Bch h%E1%BA%B9n theo m%C3%A3%0A    %22%22%22%0A    query = %22DELETE FROM LICHHEN WHERE MaLH = %25s%22%0A    try:%0A        execute_query(query, (ma_lh,))%0A        return True%0A    except Exception as e:%0A        print(f%22L%E1%BB%97i khi x%C3%B3a l%E1%BB%8Bch h%E1%BA%B9n: %7Be%7D%22)%0A        return False\n","isNew":true,"isApplied":true,"isUnread":false},{"path":"nhakhoaso/app.py","patch":"@@ -389,16 +389,151 @@\n eu_kham%0A\n+from database.lich_hen import get_all_lich_hen, get_lich_hen_by_id, search_lich_hen, create_lich_hen, update_lich_hen, delete_lich_hen%0A\n from dat\n@@ -4757,24 +4757,29 @@\n lich_hen\n+_list\n ():%0A    \n return r\n@@ -4774,46 +4774,3681 @@\n     \n-return render_template('lich_hen.html'\n+lich_hen_list = get_all_lich_hen()%0A    return render_template('lich_hen.html', lich_hen_list=lich_hen_list)%0A%0A# Th%C3%AAm m%E1%BB%9Bi l%E1%BB%8Bch h%E1%BA%B9n%0A@app.route('/lich-hen/them-moi', methods=%5B'GET', 'POST'%5D)%0Adef them_moi_lich_hen():%0A    if request.method == 'POST':%0A        # X%E1%BB%AD l%C3%BD d%E1%BB%AF li%E1%BB%87u form khi submit%0A        ma_lich_hen = request.form.get('ma_lich_hen')%0A        ma_benh_nhan = request.form.get('ma_benh_nhan')%0A        ngay_hen = request.form.get('ngay_hen')%0A        trang_thai = request.form.get('trang_thai', 'Ch%C6%B0a kh%C3%A1m')%0A        %0A        # Ki%E1%BB%83m tra d%E1%BB%AF li%E1%BB%87u %C4%91%E1%BA%A7u v%C3%A0o%0A        if not ma_benh_nhan or not ngay_hen:%0A            flash('Vui l%C3%B2ng %C4%91i%E1%BB%81n %C4%91%E1%BA%A7y %C4%91%E1%BB%A7 th%C3%B4ng tin b%E1%BA%AFt bu%E1%BB%99c', 'error')%0A        else:%0A            # L%C6%B0u v%C3%A0o database%0A            ma_lh, result = create_lich_hen(%0A                ma_benh_nhan,%0A                ngay_hen,%0A                trang_thai,%0A                ma_lich_hen%0A            )%0A            %0A            if result:%0A                flash(f'Th%C3%AAm l%E1%BB%8Bch h%E1%BA%B9n th%C3%A0nh c%C3%B4ng v%E1%BB%9Bi m%C3%A3 %7Bma_lh%7D!', 'success')%0A                return redirect(url_for('lich_hen_list'))%0A            else:%0A                flash('C%C3%B3 l%E1%BB%97i x%E1%BA%A3y ra khi th%C3%AAm l%E1%BB%8Bch h%E1%BA%B9n', 'error')%0A                    %0A    # GET request - hi%E1%BB%83n th%E1%BB%8B form v%E1%BB%9Bi m%C3%A3 l%E1%BB%8Bch h%E1%BA%B9n m%E1%BB%9Bi%0A    ma_lich_hen = get_next_lich_hen_id()%0A    benh_nhan_list = benh_nhan.get_all_benh_nhan()%0A    %0A    return render_template('them_moi_lich_hen.html', %0A                          ma_lich_hen=ma_lich_hen,%0A                          benh_nhan_list=benh_nhan_list)%0A%0A# T%C3%ACm ki%E1%BA%BFm l%E1%BB%8Bch h%E1%BA%B9n%0A@app.route('/lich-hen/tim-kiem', methods=%5B'GET', 'POST'%5D)%0Adef tim_kiem_lich_hen():%0A    # D%E1%BB%AF li%E1%BB%87u m%E1%BA%ABu cho k%E1%BA%BFt qu%E1%BA%A3 t%C3%ACm ki%E1%BA%BFm%0A    ket_qua = %5B%5D%0A%0A    if request.method == 'POST':%0A        tu_khoa = request.form.get('tu_khoa')%0A        loai_tim_kiem = request.form.get('loai_tim_kiem', 'ma_lich_hen')%0A        %0A        if tu_khoa:%0A            ket_qua = search_lich_hen(tu_khoa, loai_tim_kiem)%0A            %0A    return render_template('tim_kiem_lich_hen.html', ket_qua=ket_qua)%0A%0A# Chi ti%E1%BA%BFt l%E1%BB%8Bch h%E1%BA%B9n%0A@app.route('/lich-hen/chi-tiet/%3Cma_lh%3E')%0Adef chi_tiet_lich_hen(ma_lh):%0A    lh = get_lich_hen_by_id(ma_lh)%0A    if not lh:%0A        flash('Kh%C3%B4ng t%C3%ACm th%E1%BA%A5y l%E1%BB%8Bch h%E1%BA%B9n', 'error')%0A        return redirect(url_for('lich_hen_list'))%0A    return render_template('chi_tiet_lich_hen.html', lich_hen=lh)%0A%0A# Ch%E1%BB%89nh s%E1%BB%ADa l%E1%BB%8Bch h%E1%BA%B9n%0A@app.route('/lich-hen/chinh-sua/%3Cma_lh%3E', methods=%5B'GET', 'POST'%5D)%0Adef chinh_sua_lich_hen(ma_lh):%0A    # L%E1%BA%A5y th%C3%B4ng tin l%E1%BB%8Bch h%E1%BA%B9n%0A    lh = get_lich_hen_by_id(ma_lh)%0A    if not lh:%0A        flash('Kh%C3%B4ng t%C3%ACm th%E1%BA%A5y l%E1%BB%8Bch h%E1%BA%B9n', 'error')%0A        return redirect(url_for('lich_hen_list'))%0A    %0A    if request.method == 'POST':%0A        # X%E1%BB%AD l%C3%BD d%E1%BB%AF li%E1%BB%87u form khi submit%0A        ma_benh_nhan = request.form.get('ma_benh_nhan')%0A        ngay_hen = request.form.get('ngay_hen')%0A        trang_thai = request.form.get('trang_thai')%0A        %0A        # Ki%E1%BB%83m tra d%E1%BB%AF li%E1%BB%87u %C4%91%E1%BA%A7u v%C3%A0o%0A        if not ma_benh_nhan or not ngay_hen:%0A            flash('Vui l%C3%B2ng %C4%91i%E1%BB%81n %C4%91%E1%BA%A7y %C4%91%E1%BB%A7 th%C3%B4ng tin b%E1%BA%AFt bu%E1%BB%99c', 'error')%0A        else:%0A            # C%E1%BA%ADp nh%E1%BA%ADt v%C3%A0o database%0A            result = update_lich_hen(%0A                ma_lh,%0A                ma_benh_nhan,%0A                ngay_hen,%0A                trang_thai%0A            )%0A            %0A            if result:%0A                flash('C%E1%BA%ADp nh%E1%BA%ADt l%E1%BB%8Bch h%E1%BA%B9n th%C3%A0nh c%C3%B4ng!', 'success')%0A                return redirect(url_for('chi_tiet_lich_hen', ma_lh=ma_lh))%0A            else:%0A                flash('C%C3%B3 l%E1%BB%97i x%E1%BA%A3y ra khi c%E1%BA%ADp nh%E1%BA%ADt l%E1%BB%8Bch h%E1%BA%B9n', 'error')%0A    %0A    # L%E1%BA%A5y danh s%C3%A1ch b%E1%BB%87nh nh%C3%A2n%0A    benh_nhan_list = benh_nhan.get_all_benh_nhan()%0A    %0A    return render_template('chinh_sua_lich_hen.html', %0A                          lich_hen=lh,%0A                          benh_nhan_list=benh_nhan_list\n )%0A%0A#\n@@ -18990,16 +18990,479 @@\n ), 500%0A%0A\n+# API x%C3%B3a l%E1%BB%8Bch h%E1%BA%B9n%0A@app.route('/api/lich-hen/%3Cma_lh%3E', methods=%5B'DELETE'%5D)%0Adef api_delete_lich_hen(ma_lh):%0A    try:%0A        result = delete_lich_hen(ma_lh)%0A        if not result:%0A            return jsonify(%7B%22success%22: False, %22message%22: %22Kh%C3%B4ng t%C3%ACm th%E1%BA%A5y l%E1%BB%8Bch h%E1%BA%B9n ho%E1%BA%B7c c%C3%B3 l%E1%BB%97i x%E1%BA%A3y ra%22%7D), 404%0A        return jsonify(%7B%22success%22: True, %22message%22: %22X%C3%B3a l%E1%BB%8Bch h%E1%BA%B9n th%C3%A0nh c%C3%B4ng%22%7D)%0A    except Exception as e:%0A        return jsonify(%7B%22success%22: False, %22message%22: str(e)%7D), 500%0A%0A\n if __nam\n","isNew":false,"isApplied":true,"isUnread":false},{"path":"nhakhoaso/templates/chinh_sua_lich_hen.html","patch":"@@ -0,0 +1,7239 @@\n+%7B%25 extends 'layout.html' %25%7D%0A%0A%7B%25 block title %25%7DCh%E1%BB%89nh s%E1%BB%ADa l%E1%BB%8Bch h%E1%BA%B9n - NHAKHOASO%7B%25 endblock %25%7D%0A%0A%7B%25 block content %25%7D%0A%3Cdiv class=%22section-title%22%3E%0A    %3Ch2%3EQU%E1%BA%A2N L%C3%9D L%E1%BB%8ACH H%E1%BA%B8N%3C/h2%3E%0A%3C/div%3E%0A%0A%3C!-- Flash messages --%3E%0A%7B%25 with messages = get_flashed_messages(with_categories=true) %25%7D%0A    %7B%25 if messages %25%7D%0A        %3Cdiv class=%22flash-messages%22%3E%0A            %7B%25 for category, message in messages %25%7D%0A                %3Cdiv class=%22flash-message %7B%7B category %7D%7D%22%3E%7B%7B message %7D%7D%3C/div%3E%0A            %7B%25 endfor %25%7D%0A        %3C/div%3E%0A    %7B%25 endif %25%7D%0A%7B%25 endwith %25%7D%0A%0A%3Cdiv class=%22page-container%22%3E%0A    %3C!-- Sidebar --%3E%0A    %3Cdiv class=%22sidebar%22%3E%0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-user-injured%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD b%E1%BB%87nh nh%C3%A2n%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_benh_nhan') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_benh_nhan') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('benh_nhan_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-clipboard-list%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD b%C3%A1c s%C4%A9%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_bac_si') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_bac_si') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('bac_si_page') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ca href=%22%7B%7B url_for('phieu_kham_list') %7D%7D%22 style=%22text-decoration: none; color: inherit;%22%3E%0A                %3Ci class=%22fas fa-chart-line%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD phi%E1%BA%BFu kh%C3%A1m%0A            %3C/a%3E%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_phieu_kham') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E T%E1%BA%A1o phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_phieu_kham') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('phieu_kham_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-calendar-check%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD l%E1%BB%8Bch h%E1%BA%B9n%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_lich_hen') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E %C4%90%E1%BA%B7t l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_lich_hen') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('lich_hen_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A    %3C/div%3E%0A%0A    %3C!-- Main content --%3E%0A    %3Cdiv class=%22main-content%22%3E%0A        %3Cdiv class=%22content-header%22%3E%0A            %3Ch2%3ECh%E1%BB%89nh s%E1%BB%ADa l%E1%BB%8Bch h%E1%BA%B9n%3C/h2%3E%0A        %3C/div%3E%0A        %0A        %3Cdiv class=%22form-container%22%3E%0A            %3Cform action=%22%7B%7B url_for('chinh_sua_lich_hen', ma_lh=lich_hen.MaLH) %7D%7D%22 method=%22POST%22%3E%0A                %3Cdiv class=%22form-group%22%3E%0A                    %3Clabel for=%22ma_lich_hen%22%3EM%C3%A3 l%E1%BB%8Bch h%E1%BA%B9n:%3C/label%3E%0A                    %3Cinput type=%22text%22 id=%22ma_lich_hen%22 name=%22ma_lich_hen%22 value=%22%7B%7B lich_hen.MaLH %7D%7D%22 readonly%3E%0A                    %3Csmall%3EM%C3%A3 l%E1%BB%8Bch h%E1%BA%B9n kh%C3%B4ng th%E1%BB%83 thay %C4%91%E1%BB%95i%3C/small%3E%0A                %3C/div%3E%0A                %0A                %3Cdiv class=%22form-group%22%3E%0A                    %3Clabel for=%22ma_benh_nhan%22%3EB%E1%BB%87nh nh%C3%A2n:%3C/label%3E%0A                    %3Cselect id=%22ma_benh_nhan%22 name=%22ma_benh_nhan%22 required%3E%0A                        %3Coption value=%22%22%3E-- Ch%E1%BB%8Dn b%E1%BB%87nh nh%C3%A2n --%3C/option%3E%0A                        %7B%25 for bn in benh_nhan_list %25%7D%0A                            %3Coption value=%22%7B%7B bn.MaBN %7D%7D%22 %7B%25 if bn.MaBN == lich_hen.MaBN %25%7Dselected%7B%25 endif %25%7D%3E%0A                                %7B%7B bn.MaBN %7D%7D - %7B%7B bn.HoTen %7D%7D%0A                            %3C/option%3E%0A                        %7B%25 endfor %25%7D%0A                    %3C/select%3E%0A                %3C/div%3E%0A                %0A                %3Cdiv class=%22form-group%22%3E%0A                    %3Clabel for=%22ngay_hen%22%3ENg%C3%A0y h%E1%BA%B9n:%3C/label%3E%0A                    %3Cinput type=%22datetime-local%22 id=%22ngay_hen%22 name=%22ngay_hen%22 value=%22%7B%7B lich_hen.NgayHen%7Creplace(' ', 'T') %7D%7D%22 required%3E%0A                %3C/div%3E%0A                %0A                %3Cdiv class=%22form-group%22%3E%0A                    %3Clabel for=%22trang_thai%22%3ETr%E1%BA%A1ng th%C3%A1i:%3C/label%3E%0A                    %3Cselect id=%22trang_thai%22 name=%22trang_thai%22%3E%0A                        %3Coption value=%22Ch%C6%B0a kh%C3%A1m%22 %7B%25 if lich_hen.TrangThai == 'Ch%C6%B0a kh%C3%A1m' %25%7Dselected%7B%25 endif %25%7D%3ECh%C6%B0a kh%C3%A1m%3C/option%3E%0A                        %3Coption value=%22%C4%90%C3%A3 kh%C3%A1m%22 %7B%25 if lich_hen.TrangThai == '%C4%90%C3%A3 kh%C3%A1m' %25%7Dselected%7B%25 endif %25%7D%3E%C4%90%C3%A3 kh%C3%A1m%3C/option%3E%0A                        %3Coption value=%22%C4%90%C3%A3 hu%E1%BB%B7%22 %7B%25 if lich_hen.TrangThai == '%C4%90%C3%A3 hu%E1%BB%B7' %25%7Dselected%7B%25 endif %25%7D%3E%C4%90%C3%A3 hu%E1%BB%B7%3C/option%3E%0A                    %3C/select%3E%0A                %3C/div%3E%0A                %0A                %3Cdiv class=%22form-actions%22%3E%0A                    %3Cbutton type=%22submit%22 class=%22btn btn-primary%22%3E%0A                        %3Ci class=%22fas fa-save%22%3E%3C/i%3E L%C6%B0u thay %C4%91%E1%BB%95i%0A                    %3C/button%3E%0A                    %3Ca href=%22%7B%7B url_for('chi_tiet_lich_hen', ma_lh=lich_hen.MaLH) %7D%7D%22 class=%22btn btn-secondary%22%3E%0A                        %3Ci class=%22fas fa-times%22%3E%3C/i%3E H%E1%BB%A7y%0A                    %3C/a%3E%0A                %3C/div%3E%0A            %3C/form%3E%0A        %3C/div%3E%0A    %3C/div%3E%0A%3C/div%3E%0A%0A%3Cstyle%3E%0A    .form-container %7B%0A        background-color: #fff;%0A        padding: 20px;%0A        border-radius: 8px;%0A        box-shadow: 0 2px 4px rgba(0,0,0,0.1);%0A    %7D%0A    %0A    .form-group %7B%0A        margin-bottom: 20px;%0A    %7D%0A    %0A    .form-group label %7B%0A        display: block;%0A        margin-bottom: 5px;%0A        font-weight: 500;%0A    %7D%0A    %0A    .form-group input,%0A    .form-group select,%0A    .form-group textarea %7B%0A        width: 100%25;%0A        padding: 10px;%0A        border: 1px solid #ddd;%0A        border-radius: 4px;%0A        font-size: 16px;%0A    %7D%0A    %0A    .form-group small %7B%0A        display: block;%0A        margin-top: 5px;%0A        color: #666;%0A        font-size: 0.85em;%0A    %7D%0A    %0A    .form-actions %7B%0A        display: flex;%0A        gap: 10px;%0A        margin-top: 30px;%0A    %7D%0A    %0A    .btn-primary %7B%0A        background-color: var(--primary-color);%0A        color: white;%0A    %7D%0A    %0A    .btn-secondary %7B%0A        background-color: #6c757d;%0A        color: white;%0A    %7D%0A%3C/style%3E%0A%7B%25 endblock %25%7D\n","isNew":true,"isApplied":true,"isUnread":false},{"path":"nhakhoaso/templates/chi_tiet_lich_hen.html","patch":"@@ -0,0 +1,9986 @@\n+%7B%25 extends 'layout.html' %25%7D%0A%0A%7B%25 block title %25%7DChi ti%E1%BA%BFt l%E1%BB%8Bch h%E1%BA%B9n - NHAKHOASO%7B%25 endblock %25%7D%0A%0A%7B%25 block content %25%7D%0A%3Cdiv class=%22section-title%22%3E%0A    %3Ch2%3EQU%E1%BA%A2N L%C3%9D L%E1%BB%8ACH H%E1%BA%B8N%3C/h2%3E%0A%3C/div%3E%0A%0A%3C!-- Flash messages --%3E%0A%7B%25 with messages = get_flashed_messages(with_categories=true) %25%7D%0A    %7B%25 if messages %25%7D%0A        %3Cdiv class=%22flash-messages%22%3E%0A            %7B%25 for category, message in messages %25%7D%0A                %3Cdiv class=%22flash-message %7B%7B category %7D%7D%22%3E%7B%7B message %7D%7D%3C/div%3E%0A            %7B%25 endfor %25%7D%0A        %3C/div%3E%0A    %7B%25 endif %25%7D%0A%7B%25 endwith %25%7D%0A%0A%3Cdiv class=%22page-container%22%3E%0A    %3C!-- Sidebar --%3E%0A    %3Cdiv class=%22sidebar%22%3E%0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-user-injured%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD b%E1%BB%87nh nh%C3%A2n%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_benh_nhan') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_benh_nhan') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('benh_nhan_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-clipboard-list%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD b%C3%A1c s%C4%A9%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_bac_si') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_bac_si') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('bac_si_page') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ca href=%22%7B%7B url_for('phieu_kham_list') %7D%7D%22 style=%22text-decoration: none; color: inherit;%22%3E%0A                %3Ci class=%22fas fa-chart-line%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD phi%E1%BA%BFu kh%C3%A1m%0A            %3C/a%3E%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_phieu_kham') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E T%E1%BA%A1o phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_phieu_kham') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('phieu_kham_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-calendar-check%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD l%E1%BB%8Bch h%E1%BA%B9n%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_lich_hen') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E %C4%90%E1%BA%B7t l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_lich_hen') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('lich_hen_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A    %3C/div%3E%0A%0A    %3C!-- Main content --%3E%0A    %3Cdiv class=%22main-content%22%3E%0A        %3Cdiv class=%22content-header%22%3E%0A            %3Ch2%3EChi ti%E1%BA%BFt l%E1%BB%8Bch h%E1%BA%B9n%3C/h2%3E%0A            %3Cdiv class=%22header-actions%22%3E%0A                %3Ca href=%22%7B%7B url_for('chinh_sua_lich_hen', ma_lh=lich_hen.MaLH) %7D%7D%22 class=%22btn btn-primary%22%3E%0A                    %3Ci class=%22fas fa-edit%22%3E%3C/i%3E Ch%E1%BB%89nh s%E1%BB%ADa%0A                %3C/a%3E%0A                %3Ca href=%22%7B%7B url_for('lich_hen_list') %7D%7D%22 class=%22btn btn-secondary%22%3E%0A                    %3Ci class=%22fas fa-arrow-left%22%3E%3C/i%3E Quay l%E1%BA%A1i%0A                %3C/a%3E%0A            %3C/div%3E%0A        %3C/div%3E%0A        %0A        %3Cdiv class=%22detail-container%22%3E%0A            %3Cdiv class=%22detail-card%22%3E%0A                %3Cdiv class=%22detail-header%22%3E%0A                    %3Ch3%3ETh%C3%B4ng tin l%E1%BB%8Bch h%E1%BA%B9n%3C/h3%3E%0A                    %3Cspan class=%22status-badge %0A                        %7B%25 if lich_hen.TrangThai == 'Ch%C6%B0a kh%C3%A1m' %25%7Dstatus-pending%0A                        %7B%25 elif lich_hen.TrangThai == '%C4%90%C3%A3 kh%C3%A1m' %25%7Dstatus-completed%0A                        %7B%25 elif lich_hen.TrangThai == '%C4%90%C3%A3 hu%E1%BB%B7' %25%7Dstatus-cancelled%0A                        %7B%25 endif %25%7D%22%3E%0A                        %7B%7B lich_hen.TrangThai %7D%7D%0A                    %3C/span%3E%0A                %3C/div%3E%0A                %0A                %3Cdiv class=%22detail-content%22%3E%0A                    %3Cdiv class=%22detail-row%22%3E%0A                        %3Cdiv class=%22detail-label%22%3EM%C3%A3 l%E1%BB%8Bch h%E1%BA%B9n:%3C/div%3E%0A                        %3Cdiv class=%22detail-value%22%3E%7B%7B lich_hen.MaLH %7D%7D%3C/div%3E%0A                    %3C/div%3E%0A                    %0A                    %3Cdiv class=%22detail-row%22%3E%0A                        %3Cdiv class=%22detail-label%22%3EM%C3%A3 b%E1%BB%87nh nh%C3%A2n:%3C/div%3E%0A                        %3Cdiv class=%22detail-value%22%3E%7B%7B lich_hen.MaBN %7D%7D%3C/div%3E%0A                    %3C/div%3E%0A                    %0A                    %3Cdiv class=%22detail-row%22%3E%0A                        %3Cdiv class=%22detail-label%22%3ET%C3%AAn b%E1%BB%87nh nh%C3%A2n:%3C/div%3E%0A                        %3Cdiv class=%22detail-value%22%3E%7B%7B lich_hen.TenBenhNhan %7D%7D%3C/div%3E%0A                    %3C/div%3E%0A                    %0A                    %3Cdiv class=%22detail-row%22%3E%0A                        %3Cdiv class=%22detail-label%22%3ENg%C3%A0y h%E1%BA%B9n:%3C/div%3E%0A                        %3Cdiv class=%22detail-value%22%3E%7B%7B lich_hen.NgayHen %7D%7D%3C/div%3E%0A                    %3C/div%3E%0A                    %0A                    %3Cdiv class=%22detail-row%22%3E%0A                        %3Cdiv class=%22detail-label%22%3ETr%E1%BA%A1ng th%C3%A1i:%3C/div%3E%0A                        %3Cdiv class=%22detail-value%22%3E%7B%7B lich_hen.TrangThai %7D%7D%3C/div%3E%0A                    %3C/div%3E%0A                %3C/div%3E%0A                %0A                %3Cdiv class=%22detail-actions%22%3E%0A                    %3Ca href=%22%7B%7B url_for('chinh_sua_lich_hen', ma_lh=lich_hen.MaLH) %7D%7D%22 class=%22btn btn-primary%22%3E%0A                        %3Ci class=%22fas fa-edit%22%3E%3C/i%3E Ch%E1%BB%89nh s%E1%BB%ADa%0A                    %3C/a%3E%0A                    %3Cbutton class=%22btn btn-danger%22 onclick=%22deleteLichHen('%7B%7B lich_hen.MaLH %7D%7D')%22%3E%0A                        %3Ci class=%22fas fa-trash%22%3E%3C/i%3E X%C3%B3a%0A                    %3C/button%3E%0A                    %3Ca href=%22%7B%7B url_for('lich_hen_list') %7D%7D%22 class=%22btn btn-secondary%22%3E%0A                        %3Ci class=%22fas fa-arrow-left%22%3E%3C/i%3E Quay l%E1%BA%A1i%0A                    %3C/a%3E%0A                %3C/div%3E%0A            %3C/div%3E%0A        %3C/div%3E%0A    %3C/div%3E%0A%3C/div%3E%0A%0A%3Cstyle%3E%0A    .content-header %7B%0A        display: flex;%0A        justify-content: space-between;%0A        align-items: center;%0A        margin-bottom: 20px;%0A    %7D%0A    %0A    .header-actions %7B%0A        display: flex;%0A        gap: 10px;%0A    %7D%0A    %0A    .detail-container %7B%0A        background-color: #fff;%0A        border-radius: 8px;%0A        box-shadow: 0 2px 4px rgba(0,0,0,0.1);%0A        overflow: hidden;%0A    %7D%0A    %0A    .detail-card %7B%0A        padding: 0;%0A    %7D%0A    %0A    .detail-header %7B%0A        background-color: var(--secondary-color);%0A        padding: 15px 20px;%0A        display: flex;%0A        justify-content: space-between;%0A        align-items: center;%0A    %7D%0A    %0A    .detail-header h3 %7B%0A        margin: 0;%0A        font-size: 18px;%0A        color: var(--primary-color);%0A    %7D%0A    %0A    .detail-content %7B%0A        padding: 20px;%0A    %7D%0A    %0A    .detail-row %7B%0A        display: flex;%0A        margin-bottom: 15px;%0A        border-bottom: 1px solid #eee;%0A        padding-bottom: 15px;%0A    %7D%0A    %0A    .detail-row:last-child %7B%0A        margin-bottom: 0;%0A        border-bottom: none;%0A        padding-bottom: 0;%0A    %7D%0A    %0A    .detail-label %7B%0A        width: 150px;%0A        font-weight: 500;%0A        color: #555;%0A    %7D%0A    %0A    .detail-value %7B%0A        flex: 1;%0A    %7D%0A    %0A    .detail-actions %7B%0A        padding: 15px 20px;%0A        background-color: #f8f9fa;%0A        display: flex;%0A        gap: 10px;%0A        justify-content: flex-end;%0A    %7D%0A    %0A    .btn %7B%0A        padding: 8px 15px;%0A        border: none;%0A        border-radius: 4px;%0A        cursor: pointer;%0A        font-size: 14px;%0A        display: inline-flex;%0A        align-items: center;%0A        gap: 5px;%0A    %7D%0A    %0A    .btn-primary %7B%0A        background-color: var(--primary-color);%0A        color: white;%0A    %7D%0A    %0A    .btn-secondary %7B%0A        background-color: #6c757d;%0A        color: white;%0A    %7D%0A    %0A    .btn-danger %7B%0A        background-color: #dc3545;%0A        color: white;%0A    %7D%0A    %0A    .status-badge %7B%0A        display: inline-block;%0A        padding: 4px 8px;%0A        border-radius: 4px;%0A        font-size: 0.85em;%0A        font-weight: 500;%0A    %7D%0A    %0A    .status-pending %7B%0A        background-color: #ffeeba;%0A        color: #856404;%0A    %7D%0A    %0A    .status-completed %7B%0A        background-color: #d4edda;%0A        color: #155724;%0A    %7D%0A    %0A    .status-cancelled %7B%0A        background-color: #f8d7da;%0A        color: #721c24;%0A    %7D%0A%3C/style%3E%0A%0A%7B%25 block extra_js %25%7D%0A%3Cscript%3E%0A    // H%C3%A0m x%C3%B3a l%E1%BB%8Bch h%E1%BA%B9n%0A    function deleteLichHen(maLH) %7B%0A        if (confirm('B%E1%BA%A1n c%C3%B3 ch%E1%BA%AFc ch%E1%BA%AFn mu%E1%BB%91n x%C3%B3a l%E1%BB%8Bch h%E1%BA%B9n n%C3%A0y?')) %7B%0A            // G%E1%BB%8Di API x%C3%B3a l%E1%BB%8Bch h%E1%BA%B9n%0A            fetch(%60/api/lich-hen/$%7BmaLH%7D%60, %7B%0A                method: 'DELETE'%0A            %7D)%0A            .then(response =%3E response.json())%0A            .then(data =%3E %7B%0A                if (data.success) %7B%0A                    alert('X%C3%B3a l%E1%BB%8Bch h%E1%BA%B9n th%C3%A0nh c%C3%B4ng!');%0A                    window.location.href = %22%7B%7B url_for('lich_hen_list') %7D%7D%22;%0A                %7D else %7B%0A                    alert('L%E1%BB%97i: ' + data.message);%0A                %7D%0A            %7D)%0A            .catch(error =%3E %7B%0A                console.error('Error:', error);%0A                alert('%C4%90%C3%A3 x%E1%BA%A3y ra l%E1%BB%97i khi x%C3%B3a l%E1%BB%8Bch h%E1%BA%B9n');%0A            %7D);%0A        %7D%0A    %7D%0A%3C/script%3E%0A%7B%25 endblock %25%7D%0A%7B%25 endblock %25%7D\n","isNew":true,"isApplied":true,"isUnread":false}]}],"context":{"author":"Coding Agent","operationId":"c4fe8b16-5ced-47ca-9a3a-5d1ca90fa0c8","usedFilePaths":[{"fsPath":"/home/huong/.vscode-server/data/User/History/33c16031/Wr42.py","path":".vscode-server/data/User/History/33c16031/Wr42.py","displayPath":".vscode-server/data/User/History/33c16031/Wr42.py"},{"fsPath":"/home/huong/.vscode-server/data/User/History/6e6d2161/HGl3.html","path":".vscode-server/data/User/History/6e6d2161/HGl3.html","displayPath":".vscode-server/data/User/History/6e6d2161/HGl3.html"},{"fsPath":"/home/huong/qtcsdl/app.py","path":"qtcsdl/app.py","displayPath":"qtcsdl/app.py"},{"fsPath":"/home/huong/.vscode-server/data/User/History/-34b44c2c/VFqm.sql","path":".vscode-server/data/User/History/-34b44c2c/VFqm.sql","displayPath":".vscode-server/data/User/History/-34b44c2c/VFqm.sql"},{"fsPath":"/home/huong/.vscode-server/data/User/History/33c16031/wgdA.py","path":".vscode-server/data/User/History/33c16031/wgdA.py","displayPath":".vscode-server/data/User/History/33c16031/wgdA.py"},{"fsPath":"/home/huong/nhakhoaso/app.py","path":"nhakhoaso/app.py","displayPath":"nhakhoaso/app.py"},{"fsPath":"/home/huong/.vscode-server/data/User/History/22d83b17/I1lq.py","path":".vscode-server/data/User/History/22d83b17/I1lq.py","displayPath":".vscode-server/data/User/History/22d83b17/I1lq.py"},{"fsPath":"/home/huong/.vscode-server/data/User/History/-4a49b7a1/usv5.py","path":".vscode-server/data/User/History/-4a49b7a1/usv5.py","displayPath":".vscode-server/data/User/History/-4a49b7a1/usv5.py"},{"fsPath":"/home/huong/test/app.py","path":"test/app.py","displayPath":"test/app.py"},{"fsPath":"/home/huong/insert/app.py","path":"insert/app.py","displayPath":"insert/app.py"},{"fsPath":"/home/huong/nhakhoaso/database/bac_si.py","path":"nhakhoaso/database/bac_si.py","displayPath":"nhakhoaso/database/bac_si.py"},{"fsPath":"/home/huong/.vscode-server/data/User/History/-34b44c2c/0SN1.sql","path":".vscode-server/data/User/History/-34b44c2c/0SN1.sql","displayPath":".vscode-server/data/User/History/-34b44c2c/0SN1.sql"},{"fsPath":"/home/huong/.vscode-server/data/User/History/33c16031/Zqhg.py","path":".vscode-server/data/User/History/33c16031/Zqhg.py","displayPath":".vscode-server/data/User/History/33c16031/Zqhg.py"},{"fsPath":"/home/huong/.vscode-server/data/User/History/-34b44c2c/IiiB.sql","path":".vscode-server/data/User/History/-34b44c2c/IiiB.sql","displayPath":".vscode-server/data/User/History/-34b44c2c/IiiB.sql"},{"fsPath":"/home/huong/.vscode-server/data/User/History/33c16031/EwLH.py","path":".vscode-server/data/User/History/33c16031/EwLH.py","displayPath":".vscode-server/data/User/History/33c16031/EwLH.py"},{"fsPath":"/home/huong/.vscode-server/data/User/History/33c16031/B4sB.py","path":".vscode-server/data/User/History/33c16031/B4sB.py","displayPath":".vscode-server/data/User/History/33c16031/B4sB.py"},{"fsPath":"/home/huong/nhakhoaso/database/benh_nhan.py","path":"nhakhoaso/database/benh_nhan.py","displayPath":"nhakhoaso/database/benh_nhan.py"},{"fsPath":"/home/huong/.vscode-server/data/User/History/33c16031/mO0F.py","path":".vscode-server/data/User/History/33c16031/mO0F.py","displayPath":".vscode-server/data/User/History/33c16031/mO0F.py"},{"fsPath":"/home/huong/nhakhoaso/database/utils.py","path":"nhakhoaso/database/utils.py","displayPath":"nhakhoaso/database/utils.py"},{"fsPath":"/home/huong/.vscode-server/data/User/History/-5a31bc4f/VE4I.html","path":".vscode-server/data/User/History/-5a31bc4f/VE4I.html","displayPath":".vscode-server/data/User/History/-5a31bc4f/VE4I.html"},{"fsPath":"/home/huong/nhakhoaso/database/phieu_kham.py","path":"nhakhoaso/database/phieu_kham.py","displayPath":"nhakhoaso/database/phieu_kham.py"},{"fsPath":"/home/huong/.vscode-server/data/User/History/-34b44c2c/QC9J.sql","path":".vscode-server/data/User/History/-34b44c2c/QC9J.sql","displayPath":".vscode-server/data/User/History/-34b44c2c/QC9J.sql"},{"fsPath":"/home/huong/nhakhoaso/database/init_db.sql","path":"nhakhoaso/database/init_db.sql","displayPath":"nhakhoaso/database/init_db.sql"},{"fsPath":"/home/huong/.vscode-server/data/User/History/22d83b17/oCl0.py","path":".vscode-server/data/User/History/22d83b17/oCl0.py","displayPath":".vscode-server/data/User/History/22d83b17/oCl0.py"},{"fsPath":"/home/huong/.vscode-server/data/User/History/-158b8d14/76Eq.py","path":".vscode-server/data/User/History/-158b8d14/76Eq.py","displayPath":".vscode-server/data/User/History/-158b8d14/76Eq.py"}]},"isInternal":false},{"id":"5fabd6bd-1e9e-48fc-8754-c8264539f30d","role":"user","rawContent":{"type":"doc","content":[{"type":"paragraph","content":[{"type":"text","text":"tôi chạy thử và tôi đang thấy lỗi"}]}]},"content":[{"type":"text","text":"tôi chạy thử và tôi đang thấy lỗi"}],"context":{"currentFile":{"fsPath":"/home/huong/nhakhoaso/templates/chi_tiet_lich_hen.html","path":"nhakhoaso/templates/chi_tiet_lich_hen.html","displayPath":"nhakhoaso/templates/chi_tiet_lich_hen.html","content":"{% extends 'layout.html' %}\n\n{% block title %}Chi tiết lịch hẹn - NHAKHOASO{% endblock %}\n\n{% block content %}\n<div class=\"section-title\">\n    <h2>QUẢN LÝ LỊCH HẸN</h2>\n</div>\n\n<!-- Flash messages -->\n{% with messages = get_flashed_messages(with_categories=true) %}\n    {% if messages %}\n        <div class=\"flash-messages\">\n            {% for category, message in messages %}\n                <div class=\"flash-message {{ category }}\">{{ message }}</div>\n            {% endfor %}\n        </div>\n    {% endif %}\n{% endwith %}\n\n<div class=\"page-container\">\n    <!-- Sidebar -->\n    <div class=\"sidebar\">\n        <div class=\"sidebar-title\">\n            <i class=\"fas fa-user-injured\"></i> Quản lý bệnh nhân\n        </div>\n        <ul class=\"sidebar-menu\">\n            <li>\n                <a href=\"{{ url_for('them_moi_benh_nhan') }}\">\n                    <i class=\"fas fa-plus\"></i> Thêm mới bệnh nhân\n                </a>\n            </li>\n            <li>\n                <a href=\"{{ url_for('tim_kiem_benh_nhan') }}\">\n                    <i class=\"fas fa-search\"></i> Tìm kiếm bệnh nhân\n                </a>\n            </li>\n            <li>\n                <a href=\"{{ url_for('benh_nhan_list') }}\">\n                    <i class=\"fas fa-list\"></i> Danh sách bệnh nhân\n                </a>\n            </li>\n        </ul>\n        \n        <div class=\"sidebar-title\">\n            <i class=\"fas fa-clipboard-list\"></i> Quản lý bác sĩ\n        </div>\n        <ul class=\"sidebar-menu\">\n            <li>\n                <a href=\"{{ url_for('them_moi_bac_si') }}\">\n                    <i class=\"fas fa-plus\"></i> Thêm mới bác sĩ\n                </a>\n            </li>\n            <li>\n                <a href=\"{{ url_for('tim_kiem_bac_si') }}\">\n                    <i class=\"fas fa-search\"></i> Tìm kiếm bác sĩ\n                </a>\n            </li>\n            <li>\n                <a href=\"{{ url_for('bac_si_page') }}\">\n                    <i class=\"fas fa-list\"></i> Danh sách bác sĩ\n                </a>\n            </li>\n        </ul>\n        \n        <div class=\"sidebar-title\">\n            <a href=\"{{ url_for('phieu_kham_list') }}\" style=\"text-decoration: none; color: inherit;\">\n                <i class=\"fas fa-chart-line\"></i> Quản lý phiếu khám\n            </a>\n        </div>\n        <ul class=\"sidebar-menu\">\n            <li>\n                <a href=\"{{ url_for('them_moi_phieu_kham') }}\">\n                    <i class=\"fas fa-plus\"></i> Tạo phiếu khám\n                </a>\n            </li>\n            <li>\n                <a href=\"{{ url_for('tim_kiem_phieu_kham') }}\">\n                    <i class=\"fas fa-search\"></i> Tìm kiếm phiếu khám\n                </a>\n            </li>\n            <li>\n                <a href=\"{{ url_for('phieu_kham_list') }}\">\n                    <i class=\"fas fa-list\"></i> Danh sách phiếu khám\n                </a>\n            </li>\n        </ul>\n        \n        <div class=\"sidebar-title\">\n            <i class=\"fas fa-calendar-check\"></i> Quản lý lịch hẹn\n        </div>\n        <ul class=\"sidebar-menu\">\n            <li>\n                <a href=\"{{ url_for('them_moi_lich_hen') }}\">\n                    <i class=\"fas fa-plus\"></i> Đặt lịch hẹn\n                </a>\n            </li>\n            <li>\n                <a href=\"{{ url_for('tim_kiem_lich_hen') }}\">\n                    <i class=\"fas fa-search\"></i> Tìm kiếm lịch hẹn\n                </a>\n            </li>\n            <li>\n                <a href=\"{{ url_for('lich_hen_list') }}\">\n                    <i class=\"fas fa-list\"></i> Danh sách lịch hẹn\n                </a>\n            </li>\n        </ul>\n    </div>\n\n    <!-- Main content -->\n    <div class=\"main-content\">\n        <div class=\"content-header\">\n            <h2>Chi tiết lịch hẹn</h2>\n            <div class=\"header-actions\">\n                <a href=\"{{ url_for('chinh_sua_lich_hen', ma_lh=lich_hen.MaLH) }}\" class=\"btn btn-primary\">\n                    <i class=\"fas fa-edit\"></i> Chỉnh sửa\n                </a>\n                <a href=\"{{ url_for('lich_hen_list') }}\" class=\"btn btn-secondary\">\n                    <i class=\"fas fa-arrow-left\"></i> Quay lại\n                </a>\n            </div>\n        </div>\n        \n        <div class=\"detail-container\">\n            <div class=\"detail-card\">\n                <div class=\"detail-header\">\n                    <h3>Thông tin lịch hẹn</h3>\n                    <span class=\"status-badge \n                        {% if lich_hen.TrangThai == 'Chưa khám' %}status-pending\n                        {% elif lich_hen.TrangThai == 'Đã khám' %}status-completed\n                        {% elif lich_hen.TrangThai == 'Đã huỷ' %}status-cancelled\n                        {% endif %}\">\n                        {{ lich_hen.TrangThai }}\n                    </span>\n                </div>\n                \n                <div class=\"detail-content\">\n                    <div class=\"detail-row\">\n                        <div class=\"detail-label\">Mã lịch hẹn:</div>\n                        <div class=\"detail-value\">{{ lich_hen.MaLH }}</div>\n                    </div>\n                    \n                    <div class=\"detail-row\">\n                        <div class=\"detail-label\">Mã bệnh nhân:</div>\n                        <div class=\"detail-value\">{{ lich_hen.MaBN }}</div>\n                    </div>\n                    \n                    <div class=\"detail-row\">\n                        <div class=\"detail-label\">Tên bệnh nhân:</div>\n                        <div class=\"detail-value\">{{ lich_hen.TenBenhNhan }}</div>\n                    </div>\n                    \n                    <div class=\"detail-row\">\n                        <div class=\"detail-label\">Ngày hẹn:</div>\n                        <div class=\"detail-value\">{{ lich_hen.NgayHen }}</div>\n                    </div>\n                    \n                    <div class=\"detail-row\">\n                        <div class=\"detail-label\">Trạng thái:</div>\n                        <div class=\"detail-value\">{{ lich_hen.TrangThai }}</div>\n                    </div>\n                </div>\n                \n                <div class=\"detail-actions\">\n                    <a href=\"{{ url_for('chinh_sua_lich_hen', ma_lh=lich_hen.MaLH) }}\" class=\"btn btn-primary\">\n                        <i class=\"fas fa-edit\"></i> Chỉnh sửa\n                    </a>\n                    <button class=\"btn btn-danger\" onclick=\"deleteLichHen('{{ lich_hen.MaLH }}')\">\n                        <i class=\"fas fa-trash\"></i> Xóa\n                    </button>\n                    <a href=\"{{ url_for('lich_hen_list') }}\" class=\"btn btn-secondary\">\n                        <i class=\"fas fa-arrow-left\"></i> Quay lại\n                    </a>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<style>\n    .content-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: 20px;\n    }\n    \n    .header-actions {\n        display: flex;\n        gap: 10px;\n    }\n    \n    .detail-container {\n        background-color: #fff;\n        border-radius: 8px;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        overflow: hidden;\n    }\n    \n    .detail-card {\n        padding: 0;\n    }\n    \n    .detail-header {\n        background-color: var(--secondary-color);\n        padding: 15px 20px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n    }\n    \n    .detail-header h3 {\n        margin: 0;\n        font-size: 18px;\n        color: var(--primary-color);\n    }\n    \n    .detail-content {\n        padding: 20px;\n    }\n    \n    .detail-row {\n        display: flex;\n        margin-bottom: 15px;\n        border-bottom: 1px solid #eee;\n        padding-bottom: 15px;\n    }\n    \n    .detail-row:last-child {\n        margin-bottom: 0;\n        border-bottom: none;\n        padding-bottom: 0;\n    }\n    \n    .detail-label {\n        width: 150px;\n        font-weight: 500;\n        color: #555;\n    }\n    \n    .detail-value {\n        flex: 1;\n    }\n    \n    .detail-actions {\n        padding: 15px 20px;\n        background-color: #f8f9fa;\n        display: flex;\n        gap: 10px;\n        justify-content: flex-end;\n    }\n    \n    .btn {\n        padding: 8px 15px;\n        border: none;\n        border-radius: 4px;\n        cursor: pointer;\n        font-size: 14px;\n        display: inline-flex;\n        align-items: center;\n        gap: 5px;\n    }\n    \n    .btn-primary {\n        background-color: var(--primary-color);\n        color: white;\n    }\n    \n    .btn-secondary {\n        background-color: #6c757d;\n        color: white;\n    }\n    \n    .btn-danger {\n        background-color: #dc3545;\n        color: white;\n    }\n    \n    .status-badge {\n        display: inline-block;\n        padding: 4px 8px;\n        border-radius: 4px;\n        font-size: 0.85em;\n        font-weight: 500;\n    }\n    \n    .status-pending {\n        background-color: #ffeeba;\n        color: #856404;\n    }\n    \n    .status-completed {\n        background-color: #d4edda;\n        color: #155724;\n    }\n    \n    .status-cancelled {\n        background-color: #f8d7da;\n        color: #721c24;\n    }\n</style>\n\n{% block extra_js %}\n<script>\n    // Hàm xóa lịch hẹn\n    function deleteLichHen(maLH) {\n        if (confirm('Bạn có chắc chắn muốn xóa lịch hẹn này?')) {\n            // Gọi API xóa lịch hẹn\n            fetch(`/api/lich-hen/${maLH}`, {\n                method: 'DELETE'\n            })\n            .then(response => response.json())\n            .then(data => {\n                if (data.success) {\n                    alert('Xóa lịch hẹn thành công!');\n                    window.location.href = \"{{ url_for('lich_hen_list') }}\";\n                } else {\n                    alert('Lỗi: ' + data.message);\n                }\n            })\n            .catch(error => {\n                console.error('Error:', error);\n                alert('Đã xảy ra lỗi khi xóa lịch hẹn');\n            });\n        }\n    }\n</script>\n{% endblock %}\n{% endblock %}","language":"html"},"codebaseEnabled":true,"attachedFiles":[]},"createdAt":1745250691467,"isInternal":false},{"id":"eb6c553c-8765-4835-b36e-813fa06d23dc","role":"assistant","createdAt":1745250704492,"content":[{"type":"text","text":"Tôi sẽ giúp bạn xác định và sửa lỗi. Vui lòng cho tôi biết thông báo lỗi cụ thể bạn đang gặp phải hoặc mô tả chi tiết lỗi đang xảy ra khi bạn chạy ứng dụng."}],"context":{"author":"Coding Agent","operationId":"408bc9d3-9df0-4296-9772-84e1804032a9"},"isInternal":false},{"id":"a1896f36-30ed-41d3-8764-cc54838cca3c","role":"user","rawContent":{"type":"doc","content":[{"type":"paragraph","content":[{"type":"text","text":"lỗi ngày từ đầu khi tôi bắt đầu chạu flask"}]}]},"content":[{"type":"text","text":"lỗi ngày từ đầu khi tôi bắt đầu chạu flask"}],"context":{"currentFile":{"fsPath":"/home/huong/nhakhoaso/templates/chi_tiet_lich_hen.html","path":"nhakhoaso/templates/chi_tiet_lich_hen.html","displayPath":"nhakhoaso/templates/chi_tiet_lich_hen.html","content":"{% extends 'layout.html' %}\n\n{% block title %}Chi tiết lịch hẹn - NHAKHOASO{% endblock %}\n\n{% block content %}\n<div class=\"section-title\">\n    <h2>QUẢN LÝ LỊCH HẸN</h2>\n</div>\n\n<!-- Flash messages -->\n{% with messages = get_flashed_messages(with_categories=true) %}\n    {% if messages %}\n        <div class=\"flash-messages\">\n            {% for category, message in messages %}\n                <div class=\"flash-message {{ category }}\">{{ message }}</div>\n            {% endfor %}\n        </div>\n    {% endif %}\n{% endwith %}\n\n<div class=\"page-container\">\n    <!-- Sidebar -->\n    <div class=\"sidebar\">\n        <div class=\"sidebar-title\">\n            <i class=\"fas fa-user-injured\"></i> Quản lý bệnh nhân\n        </div>\n        <ul class=\"sidebar-menu\">\n            <li>\n                <a href=\"{{ url_for('them_moi_benh_nhan') }}\">\n                    <i class=\"fas fa-plus\"></i> Thêm mới bệnh nhân\n                </a>\n            </li>\n            <li>\n                <a href=\"{{ url_for('tim_kiem_benh_nhan') }}\">\n                    <i class=\"fas fa-search\"></i> Tìm kiếm bệnh nhân\n                </a>\n            </li>\n            <li>\n                <a href=\"{{ url_for('benh_nhan_list') }}\">\n                    <i class=\"fas fa-list\"></i> Danh sách bệnh nhân\n                </a>\n            </li>\n        </ul>\n        \n        <div class=\"sidebar-title\">\n            <i class=\"fas fa-clipboard-list\"></i> Quản lý bác sĩ\n        </div>\n        <ul class=\"sidebar-menu\">\n            <li>\n                <a href=\"{{ url_for('them_moi_bac_si') }}\">\n                    <i class=\"fas fa-plus\"></i> Thêm mới bác sĩ\n                </a>\n            </li>\n            <li>\n                <a href=\"{{ url_for('tim_kiem_bac_si') }}\">\n                    <i class=\"fas fa-search\"></i> Tìm kiếm bác sĩ\n                </a>\n            </li>\n            <li>\n                <a href=\"{{ url_for('bac_si_page') }}\">\n                    <i class=\"fas fa-list\"></i> Danh sách bác sĩ\n                </a>\n            </li>\n        </ul>\n        \n        <div class=\"sidebar-title\">\n            <a href=\"{{ url_for('phieu_kham_list') }}\" style=\"text-decoration: none; color: inherit;\">\n                <i class=\"fas fa-chart-line\"></i> Quản lý phiếu khám\n            </a>\n        </div>\n        <ul class=\"sidebar-menu\">\n            <li>\n                <a href=\"{{ url_for('them_moi_phieu_kham') }}\">\n                    <i class=\"fas fa-plus\"></i> Tạo phiếu khám\n                </a>\n            </li>\n            <li>\n                <a href=\"{{ url_for('tim_kiem_phieu_kham') }}\">\n                    <i class=\"fas fa-search\"></i> Tìm kiếm phiếu khám\n                </a>\n            </li>\n            <li>\n                <a href=\"{{ url_for('phieu_kham_list') }}\">\n                    <i class=\"fas fa-list\"></i> Danh sách phiếu khám\n                </a>\n            </li>\n        </ul>\n        \n        <div class=\"sidebar-title\">\n            <i class=\"fas fa-calendar-check\"></i> Quản lý lịch hẹn\n        </div>\n        <ul class=\"sidebar-menu\">\n            <li>\n                <a href=\"{{ url_for('them_moi_lich_hen') }}\">\n                    <i class=\"fas fa-plus\"></i> Đặt lịch hẹn\n                </a>\n            </li>\n            <li>\n                <a href=\"{{ url_for('tim_kiem_lich_hen') }}\">\n                    <i class=\"fas fa-search\"></i> Tìm kiếm lịch hẹn\n                </a>\n            </li>\n            <li>\n                <a href=\"{{ url_for('lich_hen_list') }}\">\n                    <i class=\"fas fa-list\"></i> Danh sách lịch hẹn\n                </a>\n            </li>\n        </ul>\n    </div>\n\n    <!-- Main content -->\n    <div class=\"main-content\">\n        <div class=\"content-header\">\n            <h2>Chi tiết lịch hẹn</h2>\n            <div class=\"header-actions\">\n                <a href=\"{{ url_for('chinh_sua_lich_hen', ma_lh=lich_hen.MaLH) }}\" class=\"btn btn-primary\">\n                    <i class=\"fas fa-edit\"></i> Chỉnh sửa\n                </a>\n                <a href=\"{{ url_for('lich_hen_list') }}\" class=\"btn btn-secondary\">\n                    <i class=\"fas fa-arrow-left\"></i> Quay lại\n                </a>\n            </div>\n        </div>\n        \n        <div class=\"detail-container\">\n            <div class=\"detail-card\">\n                <div class=\"detail-header\">\n                    <h3>Thông tin lịch hẹn</h3>\n                    <span class=\"status-badge \n                        {% if lich_hen.TrangThai == 'Chưa khám' %}status-pending\n                        {% elif lich_hen.TrangThai == 'Đã khám' %}status-completed\n                        {% elif lich_hen.TrangThai == 'Đã huỷ' %}status-cancelled\n                        {% endif %}\">\n                        {{ lich_hen.TrangThai }}\n                    </span>\n                </div>\n                \n                <div class=\"detail-content\">\n                    <div class=\"detail-row\">\n                        <div class=\"detail-label\">Mã lịch hẹn:</div>\n                        <div class=\"detail-value\">{{ lich_hen.MaLH }}</div>\n                    </div>\n                    \n                    <div class=\"detail-row\">\n                        <div class=\"detail-label\">Mã bệnh nhân:</div>\n                        <div class=\"detail-value\">{{ lich_hen.MaBN }}</div>\n                    </div>\n                    \n                    <div class=\"detail-row\">\n                        <div class=\"detail-label\">Tên bệnh nhân:</div>\n                        <div class=\"detail-value\">{{ lich_hen.TenBenhNhan }}</div>\n                    </div>\n                    \n                    <div class=\"detail-row\">\n                        <div class=\"detail-label\">Ngày hẹn:</div>\n                        <div class=\"detail-value\">{{ lich_hen.NgayHen }}</div>\n                    </div>\n                    \n                    <div class=\"detail-row\">\n                        <div class=\"detail-label\">Trạng thái:</div>\n                        <div class=\"detail-value\">{{ lich_hen.TrangThai }}</div>\n                    </div>\n                </div>\n                \n                <div class=\"detail-actions\">\n                    <a href=\"{{ url_for('chinh_sua_lich_hen', ma_lh=lich_hen.MaLH) }}\" class=\"btn btn-primary\">\n                        <i class=\"fas fa-edit\"></i> Chỉnh sửa\n                    </a>\n                    <button class=\"btn btn-danger\" onclick=\"deleteLichHen('{{ lich_hen.MaLH }}')\">\n                        <i class=\"fas fa-trash\"></i> Xóa\n                    </button>\n                    <a href=\"{{ url_for('lich_hen_list') }}\" class=\"btn btn-secondary\">\n                        <i class=\"fas fa-arrow-left\"></i> Quay lại\n                    </a>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<style>\n    .content-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: 20px;\n    }\n    \n    .header-actions {\n        display: flex;\n        gap: 10px;\n    }\n    \n    .detail-container {\n        background-color: #fff;\n        border-radius: 8px;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        overflow: hidden;\n    }\n    \n    .detail-card {\n        padding: 0;\n    }\n    \n    .detail-header {\n        background-color: var(--secondary-color);\n        padding: 15px 20px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n    }\n    \n    .detail-header h3 {\n        margin: 0;\n        font-size: 18px;\n        color: var(--primary-color);\n    }\n    \n    .detail-content {\n        padding: 20px;\n    }\n    \n    .detail-row {\n        display: flex;\n        margin-bottom: 15px;\n        border-bottom: 1px solid #eee;\n        padding-bottom: 15px;\n    }\n    \n    .detail-row:last-child {\n        margin-bottom: 0;\n        border-bottom: none;\n        padding-bottom: 0;\n    }\n    \n    .detail-label {\n        width: 150px;\n        font-weight: 500;\n        color: #555;\n    }\n    \n    .detail-value {\n        flex: 1;\n    }\n    \n    .detail-actions {\n        padding: 15px 20px;\n        background-color: #f8f9fa;\n        display: flex;\n        gap: 10px;\n        justify-content: flex-end;\n    }\n    \n    .btn {\n        padding: 8px 15px;\n        border: none;\n        border-radius: 4px;\n        cursor: pointer;\n        font-size: 14px;\n        display: inline-flex;\n        align-items: center;\n        gap: 5px;\n    }\n    \n    .btn-primary {\n        background-color: var(--primary-color);\n        color: white;\n    }\n    \n    .btn-secondary {\n        background-color: #6c757d;\n        color: white;\n    }\n    \n    .btn-danger {\n        background-color: #dc3545;\n        color: white;\n    }\n    \n    .status-badge {\n        display: inline-block;\n        padding: 4px 8px;\n        border-radius: 4px;\n        font-size: 0.85em;\n        font-weight: 500;\n    }\n    \n    .status-pending {\n        background-color: #ffeeba;\n        color: #856404;\n    }\n    \n    .status-completed {\n        background-color: #d4edda;\n        color: #155724;\n    }\n    \n    .status-cancelled {\n        background-color: #f8d7da;\n        color: #721c24;\n    }\n</style>\n\n{% block extra_js %}\n<script>\n    // Hàm xóa lịch hẹn\n    function deleteLichHen(maLH) {\n        if (confirm('Bạn có chắc chắn muốn xóa lịch hẹn này?')) {\n            // Gọi API xóa lịch hẹn\n            fetch(`/api/lich-hen/${maLH}`, {\n                method: 'DELETE'\n            })\n            .then(response => response.json())\n            .then(data => {\n                if (data.success) {\n                    alert('Xóa lịch hẹn thành công!');\n                    window.location.href = \"{{ url_for('lich_hen_list') }}\";\n                } else {\n                    alert('Lỗi: ' + data.message);\n                }\n            })\n            .catch(error => {\n                console.error('Error:', error);\n                alert('Đã xảy ra lỗi khi xóa lịch hẹn');\n            });\n        }\n    }\n</script>\n{% endblock %}\n{% endblock %}","language":"html"},"codebaseEnabled":true,"attachedFiles":[]},"createdAt":1745250799500,"isInternal":false},{"id":"a9f51a5f-841c-404e-b436-5e8742883836","role":"assistant","createdAt":1745250806794,"content":[{"type":"text","text":"Để giúp bạn giải quyết lỗi khi chạy Flask, tôi cần biết thông báo lỗi cụ thể. Hãy thử chạy ứng dụng và chia sẻ thông báo lỗi đầy đủ từ terminal. Tôi sẽ kiểm tra một số nguyên nhân phổ biến có thể gây ra lỗi:"},{"type":"toolCall","toolCallId":"toolu_01DCMDWb5s2Pwebydx1gLKNB","isHidden":true,"title":"","statusText":"","status":"IN_PROGRESS","localResult":"{\"status\":\"UNRECOGNIZED\",\"output\":\"Command 'python' not found, did you mean:\\n  command 'python3' from deb python3\\n  command 'python' from deb python-is-python3\\n\"}"},{"id":"027a80d3-5792-4c95-acd4-01167f10d27e","type":"shellCommand","status":"UNRECOGNIZED","shell":"bash","command":"cd /home/huong && python -m nhakhoaso.app","toolCallId":"toolu_01DCMDWb5s2Pwebydx1gLKNB","requiresConfirmation":true,"commandsRequiringConfirmation":[{"name":"python","arguments":["-m","nhakhoaso.app"]}],"output":"Command 'python' not found, did you mean:\n  command 'python3' from deb python3\n  command 'python' from deb python-is-python3\n","outputPath":"/tmp/c6328c8f-2520-4007-845f-0f283892dd4d.log"}],"context":{"author":"Coding Agent","operationId":"0f3497df-199b-44a2-9c92-bf18480e3221"},"isInternal":false},{"id":"ce75c121-5b78-426c-a38a-b9d6723954c9","role":"assistant","createdAt":1745250821527,"content":[{"type":"text","text":"Có vẻ như lệnh `python` không được nhận diện. Hãy thử với `python3`:"},{"type":"toolCall","toolCallId":"toolu_01GjeQDh4tvCX6MRHRQQ76cE","isHidden":true,"title":"","statusText":"","status":"IN_PROGRESS","localResult":"{\"status\":\"UNRECOGNIZED\",\"output\":\"Traceback (most recent call last):\\n  File \\\"<frozen runpy>\\\", line 198, in _run_module_as_main\\n  File \\\"<frozen runpy>\\\", line 88, in _run_code\\n  File \\\"/home/huong/nhakhoaso/app.py\\\", line 3, in <module>\\n    from database import benh_nhan\\nModuleNotFoundError: No module named 'database'\\n\"}"},{"id":"37512364-d5ec-4db7-98bf-91514f5ac751","type":"shellCommand","status":"UNRECOGNIZED","shell":"bash","command":"cd /home/huong && python3 -m nhakhoaso.app","toolCallId":"toolu_01GjeQDh4tvCX6MRHRQQ76cE","requiresConfirmation":true,"commandsRequiringConfirmation":[{"name":"python3","arguments":["-m","nhakhoaso.app"]}],"output":"Traceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/home/huong/nhakhoaso/app.py\", line 3, in <module>\n    from database import benh_nhan\nModuleNotFoundError: No module named 'database'\n","outputPath":"/tmp/755b5f1e-a38e-457e-a7a3-edcb862d729e.log"}],"context":{"author":"Coding Agent","operationId":"d9cd3851-2b67-47cc-8717-d3f5820d6b85"},"isInternal":false},{"id":"87e1786e-19ef-4b5b-af8a-d72d6cccf413","role":"assistant","createdAt":1745250861237,"content":[{"type":"text","text":"Tôi đã tìm ra lỗi đầu tiên: `ModuleNotFoundError: No module named 'database'`. Đây là lỗi về đường dẫn import. Khi bạn chạy ứng dụng như một module (`python3 -m nhakhoaso.app`), Python không tìm thấy module `database`.\n\nHãy thử chạy trực tiếp từ thư mục nhakhoaso:"},{"type":"toolCall","toolCallId":"toolu_01VU4vd4UeZ2mRtLAjdsUC8b","isHidden":true,"title":"","statusText":"","status":"IN_PROGRESS","localResult":"{\"status\":\"ERROR\",\"exitCode\":124,\"output\":\" * Serving Flask app 'app'\\n * Debug mode: on\\nWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.\\n * Running on all addresses (0.0.0.0)\\n * Running on http://127.0.0.1:5001\\n * Running on http://172.26.181.174:5001\\nPress CTRL+C to quit\\n * Restarting with stat\\n * Debugger is active!\\n * Debugger PIN: 110-037-917\\n\"}"},{"id":"b7696778-6739-4cba-8454-f67f878ff8ea","type":"shellCommand","status":"ERROR","shell":"bash","command":"cd /home/huong/nhakhoaso && python3 app.py","toolCallId":"toolu_01VU4vd4UeZ2mRtLAjdsUC8b","requiresConfirmation":true,"commandsRequiringConfirmation":[{"name":"python3","arguments":["app.py"]}],"exitCode":124,"output":" * Serving Flask app 'app'\n * Debug mode: on\nWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.\n * Running on all addresses (0.0.0.0)\n * Running on http://127.0.0.1:5001\n * Running on http://172.26.181.174:5001\nPress CTRL+C to quit\n * Restarting with stat\n * Debugger is active!\n * Debugger PIN: 110-037-917\n","outputPath":"/tmp/ec68af78-8803-4a4d-bbea-6f5182ed4678.log"}],"context":{"author":"Coding Agent","operationId":"4e9506db-7e7f-4a70-8573-33770a79b345"},"isInternal":false},{"id":"e8bd7450-6e8d-4168-9cba-dcdc2cf107b3","role":"assistant","createdAt":1745251133722,"content":[{"type":"text","text":"Ứng dụng đã chạy thành công! Tuy nhiên, có vẻ như chúng ta cần kiểm tra module `database.lich_hen` mà chúng ta đã import trong app.py. Hãy kiểm tra xem file này đã tồn tại chưa:"},{"type":"toolCall","toolCallId":"toolu_01MvEey2xesUUvq955jW3VMD","isHidden":false,"title":"","statusText":"Viewed folder","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/database","path":"nhakhoaso/database","displayPath":"nhakhoaso/database"}]}},{"type":"text","text":"Tôi thấy file `lich_hen.py` đã tồn tại trong thư mục database. Hãy kiểm tra nội dung của file này:"},{"type":"toolCall","toolCallId":"toolu_01GritcTM1gDARcqeoT2GhEu","isHidden":false,"title":"","statusText":"Viewed file","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/database/lich_hen.py","path":"nhakhoaso/database/lich_hen.py","displayPath":"nhakhoaso/database/lich_hen.py"}]}},{"type":"text","text":"File `lich_hen.py` đã tồn tại và có đầy đủ các hàm cần thiết. Tuy nhiên, tôi thấy có một vấn đề trong hàm `search_lich_hen()` ở dòng 60:\n\n```python\nWHERE lh.TrangThai LIKE %s COLLATE NOCASE\n```\n\nSQLite sử dụng `COLLATE NOCASE` nhưng nếu bạn đang sử dụng MySQL hoặc PostgreSQL, cú pháp này có thể không được hỗ trợ. Hãy kiểm tra xem bạn đang sử dụng cơ sở dữ liệu nào:"},{"type":"toolCall","toolCallId":"toolu_015XWYUJigpfCfay45czEr5W","isHidden":false,"title":"","statusText":"Viewed file","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/database/db.py","path":"nhakhoaso/database/db.py","displayPath":"nhakhoaso/database/db.py"}]}},{"type":"text","text":"Tôi đã tìm thấy vấn đề! Bạn đang sử dụng SQLite, nhưng có một lỗi cú pháp trong file `lich_hen.py`. Hãy sửa lại file `lich_hen.py`:"},{"type":"toolCall","toolCallId":"toolu_01UQhwXjUbGQVDwhMdVhB5rQ","isHidden":false,"title":"","statusText":"Change generated","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/database/lich_hen.py","path":"nhakhoaso/database/lich_hen.py","displayPath":"nhakhoaso/database/lich_hen.py"}]}},{"type":"codeHunk","lineBasedDiff":"--- nhakhoaso/database/lich_hen.py\n+++ nhakhoaso/database/lich_hen.py\n@@ -57,7 +57,7 @@\n         SELECT lh.*, bn.HoTen as TenBenhNhan\n         FROM LICHHEN lh\n         JOIN BENHNHAN bn ON lh.MaBN = bn.MaBN\n-        WHERE lh.TrangThai LIKE %s COLLATE NOCASE\n+        WHERE lh.TrangThai LIKE %s\n         \"\"\"\n     else:\n         return []","refToolCallId":"toolu_01UQhwXjUbGQVDwhMdVhB5rQ"},{"type":"text","text":"Bây giờ, hãy kiểm tra xem bảng LICHHEN đã tồn tại trong cơ sở dữ liệu chưa. Hãy xem file SQL khởi tạo:"},{"type":"toolCall","toolCallId":"toolu_01QqSiUi18fKA9x6KSm7CRq6","isHidden":false,"title":"","statusText":"Viewed file","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/database/init_db.sql","path":"nhakhoaso/database/init_db.sql","displayPath":"nhakhoaso/database/init_db.sql"}]}},{"type":"text","text":"Tôi thấy bảng LICHHEN đã được định nghĩa trong file init_db.sql và có dữ liệu mẫu. Bây giờ, hãy kiểm tra xem cơ sở dữ liệu đã được khởi tạo chưa:"},{"type":"toolCall","toolCallId":"toolu_01XaanZGpusHXzevJ8rGZR9U","isHidden":false,"title":"","statusText":"Viewed file","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/config.py","path":"nhakhoaso/config.py","displayPath":"nhakhoaso/config.py"}]}},{"type":"text","text":"Hãy kiểm tra xem file cơ sở dữ liệu đã tồn tại chưa:"},{"type":"toolCall","toolCallId":"toolu_01GMzZYpQbiEcuZVXF8ABVGU","isHidden":true,"title":"","statusText":"","status":"IN_PROGRESS","localResult":"{\"status\":\"UNRECOGNIZED\",\"output\":\"-rw-r--r-- 1 huong huong 45056 Thg 4  21 10:48 /home/huong/nhakhoaso/database/nhakhoaso.db\\n\"}"},{"type":"codePatch","diffs":[{"path":"nhakhoaso/database/lich_hen.py","patch":"@@ -1662,23 +1662,8 @@\n E %25s\n- COLLATE NOCASE\n %0A   \n","isNew":false,"isApplied":true,"isUnread":false}]},{"id":"90fa5b1e-0f32-49d0-aa2c-742459e1d5ed","type":"shellCommand","status":"UNRECOGNIZED","shell":"bash","command":"ls -la /home/huong/nhakhoaso/database/nhakhoaso.db","toolCallId":"toolu_01GMzZYpQbiEcuZVXF8ABVGU","requiresConfirmation":true,"commandsRequiringConfirmation":[],"output":"-rw-r--r-- 1 huong huong 45056 Thg 4  21 10:48 /home/huong/nhakhoaso/database/nhakhoaso.db\n","outputPath":"/tmp/dde2e86b-0126-4163-8bb4-fe2bfb631ff3.log"}],"context":{"author":"Coding Agent","operationId":"28a65d84-db5c-4c2f-98af-688fd6d722f4"},"isInternal":false},{"id":"6283ee66-8d2a-44ee-bffa-9f3aba3bd46c","role":"assistant","createdAt":1745251426475,"content":[{"type":"text","text":"File cơ sở dữ liệu đã tồn tại. Bây giờ, hãy thử chạy lại ứng dụng và xem lỗi cụ thể:"},{"type":"toolCall","toolCallId":"toolu_01PNR39hQ6ffgsGXBmmyKMof","isHidden":true,"title":"","statusText":"","status":"IN_PROGRESS","localResult":"{\"status\":\"ERROR\",\"exitCode\":124,\"output\":\" * Serving Flask app 'app'\\n * Debug mode: on\\nWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.\\n * Running on all addresses (0.0.0.0)\\n * Running on http://127.0.0.1:5001\\n * Running on http://172.26.181.174:5001\\nPress CTRL+C to quit\\n * Restarting with stat\\n * Debugger is active!\\n * Debugger PIN: 110-037-917\\n127.0.0.1 - - [21/Apr/2025 23:05:23] \\\"GET / HTTP/1.1\\\" 500 -\\nTraceback (most recent call last):\\n  File \\\"/usr/local/lib/python3.12/dist-packages/flask/app.py\\\", line 1536, in __call__\\n    return self.wsgi_app(environ, start_response)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \\\"/usr/local/lib/python3.12/dist-packages/flask/app.py\\\", line 1514, in wsgi_app\\n    response = self.handle_exception(e)\\n               ^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \\\"/usr/local/lib/python3.12/dist-packages/flask/app.py\\\", line 1511, in wsgi_app\\n    response = self.full_dispatch_request()\\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \\\"/usr/local/lib/python3.12/dist-packages/flask/app.py\\\", line 919, in full_dispatch_request\\n    rv = self.handle_user_exception(e)\\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \\\"/usr/local/lib/python3.12/dist-packages/flask/app.py\\\", line 917, in full_dispatch_request\\n    rv = self.dispatch_request()\\n         ^^^^^^^^^^^^^^^^^^^^^^^\\n  File \\\"/usr/local/lib/python3.12/dist-packages/flask/app.py\\\", line 902, in dispatch_request\\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \\\"/home/huong/nhakhoaso/app.py\\\", line 16, in index\\n    return render_template('index.html')\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \\\"/usr/local/lib/python3.12/dist-packages/flask/templating.py\\\", line 150, in render_template\\n    return _render(app, template, context)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \\\"/usr/local/lib/python3.12/dist-packages/flask/templating.py\\\", line 131, in _render\\n    rv = template.render(context)\\n         ^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \\\"/usr/lib/python3/dist-packages/jinja2/environment.py\\\", line 1301, in render\\n    self.environment.handle_exception()\\n  File \\\"/usr/lib/python3/dist-packages/jinja2/environment.py\\\", line 936, in handle_exception\\n    raise rewrite_traceback_stack(source=source)\\n  File \\\"/home/huong/nhakhoaso/templates/index.html\\\", line 1, in top-level template code\\n    {% extends 'layout.html' %}\\n  File \\\"/home/huong/nhakhoaso/templates/layout.html\\\", line 23, in top-level template code\\n    {% block content %}{% endblock %}\\n  File \\\"/home/huong/nhakhoaso/templates/index.html\\\", line 40, in block 'content'\\n    <div class=\\\"service-card\\\" data-link=\\\"{{ url_for('lich_hen') }}\\\">\\n  File \\\"/usr/local/lib/python3.12/dist-packages/flask/app.py\\\", line 1121, in url_for\\n    return self.handle_url_build_error(error, endpoint, values)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \\\"/usr/local/lib/python3.12/dist-packages/flask/app.py\\\", line 1110, in url_for\\n    rv = url_adapter.build(  # type: ignore[union-attr]\\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \\\"/usr/local/lib/python3.12/dist-packages/werkzeug/routing/map.py\\\", line 924, in build\\n    raise BuildError(endpoint, values, method, self)\\nwerkzeug.routing.exceptions.BuildError: Could not build url for endpoint 'lich_hen'. Did you mean 'lich_hen_list' instead?\\n127.0.0.1 - - [21/Apr/2025 23:05:23] \\\"GET /?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:05:23] \\\"GET /?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:05:24] \\\"GET /?__debugger__=yes&cmd=resource&f=console.png&s=6zgEhIQgXCtA7rq2Cxl4 HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:05:24] \\\"GET /?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1\\\" 200 -\\n\"}"},{"id":"a9e1c100-4815-44b7-8e8c-35c41f20a494","type":"shellCommand","status":"ERROR","shell":"bash","command":"cd /home/huong/nhakhoaso && python3 app.py","toolCallId":"toolu_01PNR39hQ6ffgsGXBmmyKMof","requiresConfirmation":true,"commandsRequiringConfirmation":[{"name":"python3","arguments":["app.py"]}],"exitCode":124,"output":" * Serving Flask app 'app'\n * Debug mode: on\nWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.\n * Running on all addresses (0.0.0.0)\n * Running on http://127.0.0.1:5001\n * Running on http://172.26.181.174:5001\nPress CTRL+C to quit\n * Restarting with stat\n * Debugger is active!\n * Debugger PIN: 110-037-917\n127.0.0.1 - - [21/Apr/2025 23:05:23] \"GET / HTTP/1.1\" 500 -\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.12/dist-packages/flask/app.py\", line 1536, in __call__\n    return self.wsgi_app(environ, start_response)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/flask/app.py\", line 1514, in wsgi_app\n    response = self.handle_exception(e)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/flask/app.py\", line 1511, in wsgi_app\n    response = self.full_dispatch_request()\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/flask/app.py\", line 919, in full_dispatch_request\n    rv = self.handle_user_exception(e)\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/flask/app.py\", line 917, in full_dispatch_request\n    rv = self.dispatch_request()\n         ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/flask/app.py\", line 902, in dispatch_request\n    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/huong/nhakhoaso/app.py\", line 16, in index\n    return render_template('index.html')\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/flask/templating.py\", line 150, in render_template\n    return _render(app, template, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/flask/templating.py\", line 131, in _render\n    rv = template.render(context)\n         ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3/dist-packages/jinja2/environment.py\", line 1301, in render\n    self.environment.handle_exception()\n  File \"/usr/lib/python3/dist-packages/jinja2/environment.py\", line 936, in handle_exception\n    raise rewrite_traceback_stack(source=source)\n  File \"/home/huong/nhakhoaso/templates/index.html\", line 1, in top-level template code\n    {% extends 'layout.html' %}\n  File \"/home/huong/nhakhoaso/templates/layout.html\", line 23, in top-level template code\n    {% block content %}{% endblock %}\n  File \"/home/huong/nhakhoaso/templates/index.html\", line 40, in block 'content'\n    <div class=\"service-card\" data-link=\"{{ url_for('lich_hen') }}\">\n  File \"/usr/local/lib/python3.12/dist-packages/flask/app.py\", line 1121, in url_for\n    return self.handle_url_build_error(error, endpoint, values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/flask/app.py\", line 1110, in url_for\n    rv = url_adapter.build(  # type: ignore[union-attr]\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/dist-packages/werkzeug/routing/map.py\", line 924, in build\n    raise BuildError(endpoint, values, method, self)\nwerkzeug.routing.exceptions.BuildError: Could not build url for endpoint 'lich_hen'. Did you mean 'lich_hen_list' instead?\n127.0.0.1 - - [21/Apr/2025 23:05:23] \"GET /?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:05:23] \"GET /?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:05:24] \"GET /?__debugger__=yes&cmd=resource&f=console.png&s=6zgEhIQgXCtA7rq2Cxl4 HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:05:24] \"GET /?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1\" 200 -\n","outputPath":"/tmp/e84e3416-a4e1-403b-9d09-a74f4c88866c.log"}],"context":{"author":"Coding Agent","operationId":"9b53bcf2-a53f-4d5e-bce5-05068aa4056b"},"isInternal":false},{"id":"ee69dcfb-90a8-4325-894f-33f1267469a9","role":"assistant","createdAt":1745251702265,"content":[{"type":"text","text":"Tôi đã tìm thấy lỗi! Lỗi là:\n\n```\nwerkzeug.routing.exceptions.BuildError: Could not build url for endpoint 'lich_hen'. Did you mean 'lich_hen_list' instead?\n```\n\nLỗi này xảy ra vì trong file `index.html`, bạn đang sử dụng `url_for('lich_hen')` nhưng chúng ta đã đổi tên route từ `lich_hen` thành `lich_hen_list`. Hãy sửa file `index.html`:"},{"type":"toolCall","toolCallId":"toolu_01LSyzqu9dSUaPhf6ALKrTHb","isHidden":false,"title":"","statusText":"Viewed file","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/templates/index.html","path":"nhakhoaso/templates/index.html","displayPath":"nhakhoaso/templates/index.html"}]}},{"type":"text","text":"Tôi cần sửa file `index.html` để thay đổi `lich_hen` thành `lich_hen_list`:"},{"type":"toolCall","toolCallId":"toolu_01R53mMiMLo732wXMhp8yXEh","isHidden":false,"title":"","statusText":"Change generated","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/templates/index.html","path":"nhakhoaso/templates/index.html","displayPath":"nhakhoaso/templates/index.html"}]}},{"type":"codeHunk","lineBasedDiff":"--- nhakhoaso/templates/index.html\n+++ nhakhoaso/templates/index.html\n@@ -37,13 +37,13 @@\n     </div>\n \n     <!-- Quản lý lịch hẹn -->\n-    <div class=\"service-card\" data-link=\"{{ url_for('lich_hen') }}\">\n+    <div class=\"service-card\" data-link=\"{{ url_for('lich_hen_list') }}\">\n         <div class=\"service-icon\">\n             <i class=\"fas fa-calendar-check\"></i>\n         </div>\n         <h3 class=\"service-title\">Quản lý lịch hẹn</h3>\n         <p class=\"service-description\">Đặt lịch hẹn khám, nhắc lịch, điều phối thời gian giữa bệnh nhân và bác sĩ.</p>\n-        <a href=\"{{ url_for('lich_hen') }}\" class=\"btn\">Xem chi tiết</a>\n+        <a href=\"{{ url_for('lich_hen_list') }}\" class=\"btn\">Xem chi tiết</a>\n     </div>\n \n     <!-- Quản lý dịch vụ -->","refToolCallId":"toolu_01R53mMiMLo732wXMhp8yXEh"},{"type":"text","text":"Bây giờ, hãy kiểm tra xem còn tham chiếu nào đến `lich_hen` trong các file khác không:"},{"type":"toolCall","toolCallId":"toolu_01TQW6weZApjiGcQg2JdKamP","isHidden":true,"title":"","statusText":"","status":"IN_PROGRESS","localResult":"{\"status\":\"UNRECOGNIZED\",\"output\":\"\"}"},{"type":"codePatch","diffs":[{"path":"nhakhoaso/templates/index.html","patch":"@@ -1593,24 +1593,29 @@\n or('lich_hen\n+_list\n ') %7D%7D%22%3E%0A    \n@@ -1922,16 +1922,21 @@\n lich_hen\n+_list\n ') %7D%7D%22 c\n","isNew":false,"isApplied":true,"isUnread":false}]},{"id":"149b9627-a9ff-4715-bbf9-294341045233","type":"shellCommand","status":"UNRECOGNIZED","shell":"bash","command":"cd /home/huong/nhakhoaso && grep -r \"url_for('lich_hen')\" --include=\"*.html\" .","toolCallId":"toolu_01TQW6weZApjiGcQg2JdKamP","requiresConfirmation":true,"commandsRequiringConfirmation":[],"output":"","outputPath":"/tmp/f0330423-37ca-437b-bfb1-78fe269195ca.log"}],"context":{"author":"Coding Agent","operationId":"86558c21-845e-4a92-85fc-fb6b4e94b4ab"},"isInternal":false},{"id":"5c0a2dc2-f0da-4bef-969f-685e9598e254","role":"assistant","createdAt":1745252027521,"content":[{"type":"text","text":"Không có tham chiếu nào khác đến `lich_hen`. Bây giờ, hãy thử chạy lại ứng dụng:"},{"type":"toolCall","toolCallId":"toolu_017mgfHWkzkFKhwBoZP6NNBF","isHidden":true,"title":"","statusText":"","status":"IN_PROGRESS","localResult":"{\"status\":\"ERROR\",\"exitCode\":124,\"output\":\" * Serving Flask app 'app'\\n * Debug mode: on\\nWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.\\n * Running on all addresses (0.0.0.0)\\n * Running on http://127.0.0.1:5001\\n * Running on http://172.26.181.174:5001\\nPress CTRL+C to quit\\n * Restarting with stat\\n * Debugger is active!\\n * Debugger PIN: 110-037-917\\n127.0.0.1 - - [21/Apr/2025 23:14:04] \\\"GET / HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:14:04] \\\"GET /static/style.css HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:04] \\\"GET /static/images/tooth-logo.png HTTP/1.1\\\" 404 -\\n127.0.0.1 - - [21/Apr/2025 23:14:05] \\\"GET /static/script.js HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:14:07] \\\"GET /lich-hen HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:14:07] \\\"GET /static/style.css HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:07] \\\"GET /static/images/tooth-logo.png HTTP/1.1\\\" 404 -\\n127.0.0.1 - - [21/Apr/2025 23:14:07] \\\"GET /static/script.js HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:15] \\\"GET /phieu-kham/them-moi HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:14:15] \\\"GET /static/style.css HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:15] \\\"GET /static/images/tooth-logo.png HTTP/1.1\\\" 404 -\\n127.0.0.1 - - [21/Apr/2025 23:14:15] \\\"GET /static/script.js HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:17] \\\"GET /phieu-kham/tim-kiem HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:14:17] \\\"GET /static/style.css HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:17] \\\"GET /static/images/tooth-logo.png HTTP/1.1\\\" 404 -\\n127.0.0.1 - - [21/Apr/2025 23:14:17] \\\"GET /static/script.js HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:19] \\\"GET /phieu-kham HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:14:19] \\\"GET /static/style.css HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:19] \\\"GET /static/images/tooth-logo.png HTTP/1.1\\\" 404 -\\n127.0.0.1 - - [21/Apr/2025 23:14:19] \\\"GET /static/script.js HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:28] \\\"GET /phieu-kham/them-moi HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:14:28] \\\"GET /static/style.css HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:28] \\\"GET /static/images/tooth-logo.png HTTP/1.1\\\" 404 -\\n127.0.0.1 - - [21/Apr/2025 23:14:28] \\\"GET /static/script.js HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:30] \\\"GET /phieu-kham/tim-kiem HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:14:30] \\\"GET /static/style.css HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:30] \\\"GET /static/images/tooth-logo.png HTTP/1.1\\\" 404 -\\n127.0.0.1 - - [21/Apr/2025 23:14:31] \\\"GET /static/script.js HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:32] \\\"GET /phieu-kham HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:14:32] \\\"GET /static/style.css HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:32] \\\"GET /static/images/tooth-logo.png HTTP/1.1\\\" 404 -\\n127.0.0.1 - - [21/Apr/2025 23:14:32] \\\"GET /static/script.js HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:45] \\\"GET /phieu-kham/tim-kiem HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:14:45] \\\"GET /static/style.css HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:45] \\\"GET /static/script.js HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:45] \\\"GET /static/images/tooth-logo.png HTTP/1.1\\\" 404 -\\n127.0.0.1 - - [21/Apr/2025 23:14:46] \\\"GET /benh-nhan/them-moi HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:14:47] \\\"GET /static/style.css HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:47] \\\"GET /static/images/tooth-logo.png HTTP/1.1\\\" 404 -\\n127.0.0.1 - - [21/Apr/2025 23:14:47] \\\"GET /static/script.js HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:50] \\\"GET / HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:14:51] \\\"GET /static/style.css HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:51] \\\"GET /static/script.js HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:51] \\\"GET /static/images/tooth-logo.png HTTP/1.1\\\" 404 -\\n127.0.0.1 - - [21/Apr/2025 23:14:52] \\\"GET /lich-hen HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:14:52] \\\"GET /static/style.css HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:52] \\\"GET /static/images/tooth-logo.png HTTP/1.1\\\" 404 -\\n127.0.0.1 - - [21/Apr/2025 23:14:52] \\\"GET /static/script.js HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:54] \\\"GET /lich-hen/them-moi HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:14:54] \\\"GET /static/style.css HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:14:54] \\\"GET /static/images/tooth-logo.png HTTP/1.1\\\" 404 -\\n127.0.0.1 - - [21/Apr/2025 23:14:54] \\\"GET /static/script.js HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:15:22] \\\"POST /lich-hen/them-moi HTTP/1.1\\\" 302 -\\n127.0.0.1 - - [21/Apr/2025 23:15:22] \\\"GET /lich-hen HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:15:23] \\\"GET /static/style.css HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:15:23] \\\"GET /static/images/tooth-logo.png HTTP/1.1\\\" 404 -\\n127.0.0.1 - - [21/Apr/2025 23:15:23] \\\"GET /static/script.js HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:15:28] \\\"GET /lich-hen HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:15:28] \\\"GET /static/style.css HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:15:28] \\\"GET /static/images/tooth-logo.png HTTP/1.1\\\" 404 -\\n127.0.0.1 - - [21/Apr/2025 23:15:29] \\\"GET /static/script.js HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:15:36] \\\"GET /lich-hen/chinh-sua/LH00006 HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:15:36] \\\"GET /static/style.css HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:15:36] \\\"GET /static/script.js HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:15:36] \\\"GET /static/images/tooth-logo.png HTTP/1.1\\\" 404 -\\n127.0.0.1 - - [21/Apr/2025 23:15:41] \\\"POST /lich-hen/chinh-sua/LH00006 HTTP/1.1\\\" 302 -\\n127.0.0.1 - - [21/Apr/2025 23:15:41] \\\"GET /lich-hen/chi-tiet/LH00006 HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:15:41] \\\"GET /static/style.css HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:15:42] \\\"GET /static/images/tooth-logo.png HTTP/1.1\\\" 404 -\\n127.0.0.1 - - [21/Apr/2025 23:15:42] \\\"GET /static/script.js HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:15:45] \\\"GET /lich-hen HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:15:45] \\\"GET /static/style.css HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:15:45] \\\"GET /static/images/tooth-logo.png HTTP/1.1\\\" 404 -\\n127.0.0.1 - - [21/Apr/2025 23:15:45] \\\"GET /static/script.js HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:16:12] \\\"GET /lich-hen/them-moi HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:16:13] \\\"GET /static/style.css HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:16:13] \\\"GET /static/script.js HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:16:13] \\\"GET /static/images/tooth-logo.png HTTP/1.1\\\" 404 -\\n127.0.0.1 - - [21/Apr/2025 23:16:39] \\\"POST /lich-hen/them-moi HTTP/1.1\\\" 302 -\\n127.0.0.1 - - [21/Apr/2025 23:16:39] \\\"GET /lich-hen HTTP/1.1\\\" 200 -\\n127.0.0.1 - - [21/Apr/2025 23:16:39] \\\"GET /static/style.css HTTP/1.1\\\" 304 -\\n127.0.0.1 - - [21/Apr/2025 23:16:39] \\\"GET /static/images/tooth-logo.png HTTP/1.1\\\" 404 -\\n127.0.0.1 - - [21/Apr/2025 23:16:39] \\\"GET /static/script.js HTTP/1.1\\\" 304 -\\n\"}"},{"id":"690e5c96-3280-480e-a699-d6c5d91763a6","type":"shellCommand","status":"ERROR","shell":"bash","command":"cd /home/huong/nhakhoaso && python3 app.py","toolCallId":"toolu_017mgfHWkzkFKhwBoZP6NNBF","requiresConfirmation":true,"commandsRequiringConfirmation":[{"name":"python3","arguments":["app.py"]}],"exitCode":124,"output":" * Serving Flask app 'app'\n * Debug mode: on\nWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.\n * Running on all addresses (0.0.0.0)\n * Running on http://127.0.0.1:5001\n * Running on http://172.26.181.174:5001\nPress CTRL+C to quit\n * Restarting with stat\n * Debugger is active!\n * Debugger PIN: 110-037-917\n127.0.0.1 - - [21/Apr/2025 23:14:04] \"GET / HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:14:04] \"GET /static/style.css HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:04] \"GET /static/images/tooth-logo.png HTTP/1.1\" 404 -\n127.0.0.1 - - [21/Apr/2025 23:14:05] \"GET /static/script.js HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:14:07] \"GET /lich-hen HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:14:07] \"GET /static/style.css HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:07] \"GET /static/images/tooth-logo.png HTTP/1.1\" 404 -\n127.0.0.1 - - [21/Apr/2025 23:14:07] \"GET /static/script.js HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:15] \"GET /phieu-kham/them-moi HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:14:15] \"GET /static/style.css HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:15] \"GET /static/images/tooth-logo.png HTTP/1.1\" 404 -\n127.0.0.1 - - [21/Apr/2025 23:14:15] \"GET /static/script.js HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:17] \"GET /phieu-kham/tim-kiem HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:14:17] \"GET /static/style.css HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:17] \"GET /static/images/tooth-logo.png HTTP/1.1\" 404 -\n127.0.0.1 - - [21/Apr/2025 23:14:17] \"GET /static/script.js HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:19] \"GET /phieu-kham HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:14:19] \"GET /static/style.css HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:19] \"GET /static/images/tooth-logo.png HTTP/1.1\" 404 -\n127.0.0.1 - - [21/Apr/2025 23:14:19] \"GET /static/script.js HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:28] \"GET /phieu-kham/them-moi HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:14:28] \"GET /static/style.css HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:28] \"GET /static/images/tooth-logo.png HTTP/1.1\" 404 -\n127.0.0.1 - - [21/Apr/2025 23:14:28] \"GET /static/script.js HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:30] \"GET /phieu-kham/tim-kiem HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:14:30] \"GET /static/style.css HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:30] \"GET /static/images/tooth-logo.png HTTP/1.1\" 404 -\n127.0.0.1 - - [21/Apr/2025 23:14:31] \"GET /static/script.js HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:32] \"GET /phieu-kham HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:14:32] \"GET /static/style.css HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:32] \"GET /static/images/tooth-logo.png HTTP/1.1\" 404 -\n127.0.0.1 - - [21/Apr/2025 23:14:32] \"GET /static/script.js HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:45] \"GET /phieu-kham/tim-kiem HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:14:45] \"GET /static/style.css HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:45] \"GET /static/script.js HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:45] \"GET /static/images/tooth-logo.png HTTP/1.1\" 404 -\n127.0.0.1 - - [21/Apr/2025 23:14:46] \"GET /benh-nhan/them-moi HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:14:47] \"GET /static/style.css HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:47] \"GET /static/images/tooth-logo.png HTTP/1.1\" 404 -\n127.0.0.1 - - [21/Apr/2025 23:14:47] \"GET /static/script.js HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:50] \"GET / HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:14:51] \"GET /static/style.css HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:51] \"GET /static/script.js HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:51] \"GET /static/images/tooth-logo.png HTTP/1.1\" 404 -\n127.0.0.1 - - [21/Apr/2025 23:14:52] \"GET /lich-hen HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:14:52] \"GET /static/style.css HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:52] \"GET /static/images/tooth-logo.png HTTP/1.1\" 404 -\n127.0.0.1 - - [21/Apr/2025 23:14:52] \"GET /static/script.js HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:54] \"GET /lich-hen/them-moi HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:14:54] \"GET /static/style.css HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:14:54] \"GET /static/images/tooth-logo.png HTTP/1.1\" 404 -\n127.0.0.1 - - [21/Apr/2025 23:14:54] \"GET /static/script.js HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:15:22] \"POST /lich-hen/them-moi HTTP/1.1\" 302 -\n127.0.0.1 - - [21/Apr/2025 23:15:22] \"GET /lich-hen HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:15:23] \"GET /static/style.css HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:15:23] \"GET /static/images/tooth-logo.png HTTP/1.1\" 404 -\n127.0.0.1 - - [21/Apr/2025 23:15:23] \"GET /static/script.js HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:15:28] \"GET /lich-hen HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:15:28] \"GET /static/style.css HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:15:28] \"GET /static/images/tooth-logo.png HTTP/1.1\" 404 -\n127.0.0.1 - - [21/Apr/2025 23:15:29] \"GET /static/script.js HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:15:36] \"GET /lich-hen/chinh-sua/LH00006 HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:15:36] \"GET /static/style.css HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:15:36] \"GET /static/script.js HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:15:36] \"GET /static/images/tooth-logo.png HTTP/1.1\" 404 -\n127.0.0.1 - - [21/Apr/2025 23:15:41] \"POST /lich-hen/chinh-sua/LH00006 HTTP/1.1\" 302 -\n127.0.0.1 - - [21/Apr/2025 23:15:41] \"GET /lich-hen/chi-tiet/LH00006 HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:15:41] \"GET /static/style.css HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:15:42] \"GET /static/images/tooth-logo.png HTTP/1.1\" 404 -\n127.0.0.1 - - [21/Apr/2025 23:15:42] \"GET /static/script.js HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:15:45] \"GET /lich-hen HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:15:45] \"GET /static/style.css HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:15:45] \"GET /static/images/tooth-logo.png HTTP/1.1\" 404 -\n127.0.0.1 - - [21/Apr/2025 23:15:45] \"GET /static/script.js HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:16:12] \"GET /lich-hen/them-moi HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:16:13] \"GET /static/style.css HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:16:13] \"GET /static/script.js HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:16:13] \"GET /static/images/tooth-logo.png HTTP/1.1\" 404 -\n127.0.0.1 - - [21/Apr/2025 23:16:39] \"POST /lich-hen/them-moi HTTP/1.1\" 302 -\n127.0.0.1 - - [21/Apr/2025 23:16:39] \"GET /lich-hen HTTP/1.1\" 200 -\n127.0.0.1 - - [21/Apr/2025 23:16:39] \"GET /static/style.css HTTP/1.1\" 304 -\n127.0.0.1 - - [21/Apr/2025 23:16:39] \"GET /static/images/tooth-logo.png HTTP/1.1\" 404 -\n127.0.0.1 - - [21/Apr/2025 23:16:39] \"GET /static/script.js HTTP/1.1\" 304 -\n","outputPath":"/tmp/ee0720bd-e9d7-42fa-be1f-ddfc0b5a9a45.log"}],"context":{"author":"Coding Agent","operationId":"6a2d1476-e546-42d5-8c9e-e2015d1836f0"},"isInternal":false},{"id":"3c5c4e45-01b3-4924-be32-1c90f39818a8","role":"assistant","createdAt":1745252230997,"content":[{"type":"text","text":"Tuyệt vời! Ứng dụng đã chạy thành công và không còn lỗi nữa. Tôi thấy bạn đã thử các chức năng:\n1. Xem danh sách lịch hẹn\n2. Thêm mới lịch hẹn\n3. Chỉnh sửa lịch hẹn\n4. Xem chi tiết lịch hẹn\n\nTất cả đều hoạt động tốt. Có một lỗi nhỏ về hình ảnh logo (`/static/images/tooth-logo.png` không tìm thấy), nhưng điều này không ảnh hưởng đến chức năng của ứng dụng.\n\nTóm lại, tôi đã giúp bạn:\n1. Sửa lỗi trong file `lich_hen.py` (xóa `COLLATE NOCASE` không được hỗ trợ)\n2. Sửa lỗi trong file `index.html` (thay đổi `url_for('lich_hen')` thành `url_for('lich_hen_list')`)\n\nBây giờ, chức năng quản lý lịch hẹn đã hoạt động đầy đủ với các tính năng:\n- Xem danh sách lịch hẹn\n- Thêm mới lịch hẹn\n- Tìm kiếm lịch hẹn\n- Xem chi tiết lịch hẹn\n- Chỉnh sửa lịch hẹn\n- Xóa lịch hẹn\n\nBạn có cần hỗ trợ thêm gì không?"}],"context":{"author":"Coding Agent","operationId":"df5ffb9c-2a85-4fbb-b00c-91385449561e","usedFilePaths":[{"fsPath":"/home/huong/nhakhoaso/templates/chi_tiet_lich_hen.html","path":"nhakhoaso/templates/chi_tiet_lich_hen.html","displayPath":"nhakhoaso/templates/chi_tiet_lich_hen.html"}]},"isInternal":false},{"id":"b4758c64-a85c-4f5b-b772-31e7515f54bb","role":"user","rawContent":{"type":"doc","content":[{"type":"paragraph","content":[{"type":"text","text":"Tương tự hãy tạo cho tôi chức năng to: Quản lý dịch vụ trong đó bao gồm các chức năng con : Thêm mới dịch vụ, Tìm kiếm dịch vụ, Danh sách các dịch vụ,  và thông tin dịch vụ gồm các thông tin: \"DICHVU (MaDV, TenDV, Gia)\" với dữ liệu được lấy từ csdl ở sqlite 3 nhakhoaso.db"}]}]},"content":[{"type":"text","text":"Tương tự hãy tạo cho tôi chức năng to: Quản lý dịch vụ trong đó bao gồm các chức năng con : Thêm mới dịch vụ, Tìm kiếm dịch vụ, Danh sách các dịch vụ,  và thông tin dịch vụ gồm các thông tin: \"DICHVU (MaDV, TenDV, Gia)\" với dữ liệu được lấy từ csdl ở sqlite 3 nhakhoaso.db"}],"context":{"currentFile":{"fsPath":"/home/huong/nhakhoaso/templates/index.html","path":"nhakhoaso/templates/index.html","displayPath":"nhakhoaso/templates/index.html","content":"{% extends 'layout.html' %}\n\n{% block content %}\n<div class=\"section-title\">\n    <h2>SERVICES</h2>\n</div>\n\n<div class=\"services-grid\">\n    <!-- Quản lý bệnh nhân -->\n    <div class=\"service-card\" data-link=\"{{ url_for('benh_nhan_list') }}\">\n        <div class=\"service-icon\">\n            <i class=\"fas fa-user-injured\"></i>\n        </div>\n        <h3 class=\"service-title\">Quản lý bệnh nhân</h3>\n        <p class=\"service-description\">Theo dõi thông tin cá nhân, lịch sử điều trị, hồ sơ bệnh án của bệnh nhân.</p>\n        <a href=\"{{ url_for('benh_nhan_list') }}\" class=\"btn\">Xem chi tiết</a>\n    </div>\n\n    <!-- Quản lý bác sĩ -->\n    <div class=\"service-card\" data-link=\"{{ url_for('bac_si_page') }}\">\n        <div class=\"service-icon\">\n            <i class=\"fas fa-clipboard-list\"></i>\n        </div>\n        <h3 class=\"service-title\">Quản lý bác sĩ</h3>\n        <p class=\"service-description\">Quản lý thông tin cá nhân, lịch làm việc và chuyên môn của các bác sĩ.</p>\n        <a href=\"{{ url_for('bac_si_page') }}\" class=\"btn\">Xem chi tiết</a>\n    </div>\n\n    <!-- Quản lý phiếu khám -->\n    <div class=\"service-card\" data-link=\"{{ url_for('phieu_kham_list') }}\">\n        <div class=\"service-icon\">\n            <i class=\"fas fa-chart-line\"></i>\n        </div>\n        <h3 class=\"service-title\">Quản lý phiếu khám</h3>\n        <p class=\"service-description\">Tạo và quản lý phiếu khám, lưu trữ nội dung khám bệnh.</p>\n        <a href=\"{{ url_for('phieu_kham_list') }}\" class=\"btn\">Xem chi tiết</a>\n    </div>\n\n    <!-- Quản lý lịch hẹn -->\n    <div class=\"service-card\" data-link=\"{{ url_for('lich_hen_list') }}\">\n        <div class=\"service-icon\">\n            <i class=\"fas fa-calendar-check\"></i>\n        </div>\n        <h3 class=\"service-title\">Quản lý lịch hẹn</h3>\n        <p class=\"service-description\">Đặt lịch hẹn khám, nhắc lịch, điều phối thời gian giữa bệnh nhân và bác sĩ.</p>\n        <a href=\"{{ url_for('lich_hen_list') }}\" class=\"btn\">Xem chi tiết</a>\n    </div>\n\n    <!-- Quản lý dịch vụ -->\n    <div class=\"service-card\" data-link=\"{{ url_for('dich_vu') }}\">\n        <div class=\"service-icon\">\n            <i class=\"fas fa-hand-holding-heart\"></i>\n        </div>\n        <h3 class=\"service-title\">Quản lý dịch vụ</h3>\n        <p class=\"service-description\">Quản lý các loại dịch vụ nha khoa như nhổ răng, trám răng, tẩy trắng...</p>\n        <a href=\"{{ url_for('dich_vu') }}\" class=\"btn\">Xem chi tiết</a>\n    </div>\n\n    <!-- Quản lý thanh toán -->\n    <div class=\"service-card\" data-link=\"{{ url_for('thanh_toan') }}\">\n        <div class=\"service-icon\">\n            <i class=\"fas fa-sync-alt\"></i>\n        </div>\n        <h3 class=\"service-title\">Quản lý thanh toán</h3>\n        <p class=\"service-description\">Quản lý hóa đơn, thanh toán, báo giá dịch vụ.</p>\n        <a href=\"{{ url_for('thanh_toan') }}\" class=\"btn\">Xem chi tiết</a>\n    </div>\n\n    <!-- Báo cáo và thống kê -->\n    <div class=\"service-card\" data-link=\"{{ url_for('bao_cao') }}\">\n        <div class=\"service-icon\">\n            <i class=\"fas fa-hospital\"></i>\n        </div>\n        <h3 class=\"service-title\">Báo cáo và thống kê</h3>\n        <p class=\"service-description\">Tổng hợp báo cáo hoạt động, thống kê lượt khám, doanh thu...</p>\n        <a href=\"{{ url_for('bao_cao') }}\" class=\"btn\">Xem chi tiết</a>\n    </div>\n</div>\n{% endblock %}","language":"html"},"codebaseEnabled":true,"attachedFiles":[]},"createdAt":1745252519022,"isInternal":false},{"id":"eb6878b8-6182-45e1-a23f-86ab903cb202","role":"assistant","createdAt":1745252532339,"content":[{"type":"text","text":"Tôi sẽ tạo chức năng quản lý dịch vụ cho bạn, tương tự như chức năng quản lý lịch hẹn. Đầu tiên, tôi sẽ kiểm tra cấu trúc bảng DICHVU trong cơ sở dữ liệu:"},{"type":"toolCall","toolCallId":"toolu_01E68SseQZTRjGRAB5R9Jwra","isHidden":false,"title":"","statusText":"Viewed file","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/database/init_db.sql","path":"nhakhoaso/database/init_db.sql","displayPath":"nhakhoaso/database/init_db.sql"}]}},{"type":"text","text":"Bây giờ, tôi sẽ tạo file database/dich_vu.py để xử lý các thao tác CRUD cho bảng DICHVU:"},{"type":"toolCall","toolCallId":"toolu_015cRyxq6LRyeNAoyZwRrr4B","isHidden":false,"title":"","statusText":"Change generated","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/database/dich_vu.py","path":"nhakhoaso/database/dich_vu.py","displayPath":"nhakhoaso/database/dich_vu.py"}]}},{"type":"codeHunk","lineBasedDiff":"--- nhakhoaso/database/dich_vu.py\n+++ nhakhoaso/database/dich_vu.py\n@@ -0,0 +1,128 @@\n+from .db import execute_query\n+from .utils import get_next_dich_vu_id\n+\n+def get_all_dich_vu():\n+    \"\"\"\n+    Lấy danh sách tất cả dịch vụ\n+    \"\"\"\n+    query = \"\"\"\n+    SELECT * FROM DICHVU\n+    ORDER BY MaDV\n+    \"\"\"\n+    return execute_query(query, fetch=True)\n+\n+def get_dich_vu_by_id(ma_dv):\n+    \"\"\"\n+    Lấy thông tin dịch vụ theo mã\n+    \"\"\"\n+    query = \"\"\"\n+    SELECT * FROM DICHVU\n+    WHERE MaDV = %s\n+    \"\"\"\n+    result = execute_query(query, (ma_dv,), fetch=True)\n+    return result[0] if result else None\n+\n+def search_dich_vu(tu_khoa, loai_tim_kiem='ma_dv'):\n+    \"\"\"\n+    Tìm kiếm dịch vụ theo từ khóa và loại tìm kiếm\n+    \n+    Args:\n+        tu_khoa (str): Từ khóa tìm kiếm\n+        loai_tim_kiem (str): Loại tìm kiếm (ma_dv, ten_dv, gia)\n+        \n+    Returns:\n+        list: Danh sách dịch vụ tìm thấy\n+    \"\"\"\n+    if loai_tim_kiem == 'ma_dv':\n+        query = \"\"\"\n+        SELECT * FROM DICHVU\n+        WHERE MaDV LIKE %s\n+        \"\"\"\n+    elif loai_tim_kiem == 'ten_dv':\n+        query = \"\"\"\n+        SELECT * FROM DICHVU\n+        WHERE TenDV LIKE %s\n+        \"\"\"\n+    elif loai_tim_kiem == 'gia':\n+        # Tìm kiếm theo khoảng giá\n+        try:\n+            gia = float(tu_khoa)\n+            query = \"\"\"\n+            SELECT * FROM DICHVU\n+            WHERE Gia = %s\n+            \"\"\"\n+            return execute_query(query, (gia,), fetch=True)\n+        except ValueError:\n+            # Nếu không phải số, trả về danh sách rỗng\n+            return []\n+    else:\n+        return []\n+        \n+    return execute_query(query, (f'%{tu_khoa}%',), fetch=True)\n+\n+def create_dich_vu(ten_dv, gia, ma_dv=None):\n+    \"\"\"\n+    Tạo mới dịch vụ\n+    \n+    Args:\n+        ten_dv (str): Tên dịch vụ\n+        gia (float): Giá dịch vụ\n+        ma_dv (str, optional): Mã dịch vụ (nếu không cung cấp sẽ tự động tạo)\n+        \n+    Returns:\n+        tuple: (ma_dv, success) - Mã dịch vụ và kết quả thành công hay không\n+    \"\"\"\n+    # Nếu không có mã dịch vụ, tạo mã mới\n+    if not ma_dv:\n+        ma_dv = get_next_dich_vu_id()\n+        \n+    query = \"\"\"\n+    INSERT INTO DICHVU (MaDV, TenDV, Gia)\n+    VALUES (%s, %s, %s)\n+    \"\"\"\n+    \n+    try:\n+        execute_query(query, (ma_dv, ten_dv, gia))\n+        return ma_dv, True\n+    except Exception as e:\n+        print(f\"Lỗi khi tạo dịch vụ: {e}\")\n+        return None, False\n+\n+def update_dich_vu(ma_dv, ten_dv, gia):\n+    \"\"\"\n+    Cập nhật thông tin dịch vụ\n+    \"\"\"\n+    query = \"\"\"\n+    UPDATE DICHVU\n+    SET TenDV = %s, Gia = %s\n+    WHERE MaDV = %s\n+    \"\"\"\n+    \n+    try:\n+        execute_query(query, (ten_dv, gia, ma_dv))\n+        return True\n+    except Exception as e:\n+        print(f\"Lỗi khi cập nhật dịch vụ: {e}\")\n+        return False\n+\n+def delete_dich_vu(ma_dv):\n+    \"\"\"\n+    Xóa dịch vụ theo mã\n+    \"\"\"\n+    # Kiểm tra xem dịch vụ có đang được sử dụng trong phiếu khám không\n+    check_query = \"\"\"\n+    SELECT COUNT(*) as count FROM PHIEUKHAM\n+    WHERE MaDV = %s\n+    \"\"\"\n+    result = execute_query(check_query, (ma_dv,), fetch=True)\n+    \n+    if result and result[0]['count'] > 0:\n+        return False, \"Không thể xóa dịch vụ đang được sử dụng trong phiếu khám\"\n+    \n+    query = \"DELETE FROM DICHVU WHERE MaDV = %s\"\n+    try:\n+        execute_query(query, (ma_dv,))\n+        return True, \"Xóa dịch vụ thành công\"\n+    except Exception as e:\n+        print(f\"Lỗi khi xóa dịch vụ: {e}\")\n+        return False, f\"Lỗi: {str(e)}\"","refToolCallId":"toolu_015cRyxq6LRyeNAoyZwRrr4B"},{"type":"text","text":"Tiếp theo, tôi sẽ cập nhật file app.py để thêm các route cho chức năng quản lý dịch vụ:"},{"type":"toolCall","toolCallId":"toolu_0173pDX7azmfWUyWpCYWqjWd","isHidden":false,"title":"","statusText":"Change generated","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/app.py","path":"nhakhoaso/app.py","displayPath":"nhakhoaso/app.py"}]}},{"type":"codeHunk","lineBasedDiff":"--- nhakhoaso/app.py\n+++ nhakhoaso/app.py\n@@ -4,6 +4,7 @@\n from database.bac_si import get_all_bac_si, get_bac_si_by_id, search_bac_si, create_bac_si, update_bac_si, delete_bac_si\n from database.phieu_kham import get_all_phieu_kham, get_phieu_kham_by_id, search_phieu_kham, create_phieu_kham, update_phieu_kham, delete_phieu_kham\n from database.lich_hen import get_all_lich_hen, get_lich_hen_by_id, search_lich_hen, create_lich_hen, update_lich_hen, delete_lich_hen\n+from database.dich_vu import get_all_dich_vu, get_dich_vu_by_id, search_dich_vu, create_dich_vu, update_dich_vu, delete_dich_vu\n from database.utils import get_next_benh_nhan_id, get_next_bac_si_id, get_next_dich_vu_id, get_next_lich_hen_id, get_next_phieu_kham_id\n import datetime, json\n ","refToolCallId":"toolu_0173pDX7azmfWUyWpCYWqjWd"},{"type":"text","text":"Bây giờ, tôi sẽ cập nhật các route cho chức năng quản lý dịch vụ:"},{"type":"toolCall","toolCallId":"toolu_01BXufNVKE6kTmoGZiL11g2F","isHidden":false,"title":"","statusText":"Change generated","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/app.py","path":"nhakhoaso/app.py","displayPath":"nhakhoaso/app.py"}]}},{"type":"codeHunk","lineBasedDiff":"--- nhakhoaso/app.py\n+++ nhakhoaso/app.py\n@@ -227,8 +227,97 @@\n \n # Quản lý dịch vụ\n @app.route('/dich-vu')\n-def dich_vu():\n-    return render_template('dich_vu.html')\n+def dich_vu_list():\n+    dich_vu_list = get_all_dich_vu()\n+    return render_template('dich_vu.html', dich_vu_list=dich_vu_list)\n+\n+# Thêm mới dịch vụ\n+@app.route('/dich-vu/them-moi', methods=['GET', 'POST'])\n+def them_moi_dich_vu():\n+    if request.method == 'POST':\n+        # Xử lý dữ liệu form khi submit\n+        ma_dv = request.form.get('ma_dv')\n+        ten_dv = request.form.get('ten_dv')\n+        gia = request.form.get('gia')\n+        \n+        # Kiểm tra dữ liệu đầu vào\n+        if not ten_dv:\n+            flash('Vui lòng điền đầy đủ tên dịch vụ', 'error')\n+        else:\n+            # Lưu vào database\n+            ma_dv, result = create_dich_vu(\n+                ten_dv,\n+                gia,\n+                ma_dv\n+            )\n+            \n+            if result:\n+                flash(f'Thêm dịch vụ thành công với mã {ma_dv}!', 'success')\n+                return redirect(url_for('dich_vu_list'))\n+            else:\n+                flash('Có lỗi xảy ra khi thêm dịch vụ', 'error')\n+                    \n+    # GET request - hiển thị form với mã dịch vụ mới\n+    ma_dv = get_next_dich_vu_id()\n+    \n+    return render_template('them_moi_dich_vu.html', ma_dv=ma_dv)\n+\n+# Tìm kiếm dịch vụ\n+@app.route('/dich-vu/tim-kiem', methods=['GET', 'POST'])\n+def tim_kiem_dich_vu():\n+    # Dữ liệu mẫu cho kết quả tìm kiếm\n+    ket_qua = []\n+\n+    if request.method == 'POST':\n+        tu_khoa = request.form.get('tu_khoa')\n+        loai_tim_kiem = request.form.get('loai_tim_kiem', 'ma_dv')\n+        \n+        if tu_khoa:\n+            ket_qua = search_dich_vu(tu_khoa, loai_tim_kiem)\n+            \n+    return render_template('tim_kiem_dich_vu.html', ket_qua=ket_qua)\n+\n+# Chi tiết dịch vụ\n+@app.route('/dich-vu/chi-tiet/<ma_dv>')\n+def chi_tiet_dich_vu(ma_dv):\n+    dv = get_dich_vu_by_id(ma_dv)\n+    if not dv:\n+        flash('Không tìm thấy dịch vụ', 'error')\n+        return redirect(url_for('dich_vu_list'))\n+    return render_template('chi_tiet_dich_vu.html', dich_vu=dv)\n+\n+# Chỉnh sửa dịch vụ\n+@app.route('/dich-vu/chinh-sua/<ma_dv>', methods=['GET', 'POST'])\n+def chinh_sua_dich_vu(ma_dv):\n+    # Lấy thông tin dịch vụ\n+    dv = get_dich_vu_by_id(ma_dv)\n+    if not dv:\n+        flash('Không tìm thấy dịch vụ', 'error')\n+        return redirect(url_for('dich_vu_list'))\n+    \n+    if request.method == 'POST':\n+        # Xử lý dữ liệu form khi submit\n+        ten_dv = request.form.get('ten_dv')\n+        gia = request.form.get('gia')\n+        \n+        # Kiểm tra dữ liệu đầu vào\n+        if not ten_dv:\n+            flash('Vui lòng điền đầy đủ tên dịch vụ', 'error')\n+        else:\n+            # Cập nhật vào database\n+            result = update_dich_vu(\n+                ma_dv,\n+                ten_dv,\n+                gia\n+            )\n+            \n+            if result:\n+                flash('Cập nhật dịch vụ thành công!', 'success')\n+                return redirect(url_for('chi_tiet_dich_vu', ma_dv=ma_dv))\n+            else:\n+                flash('Có lỗi xảy ra khi cập nhật dịch vụ', 'error')\n+    \n+    return render_template('chinh_sua_dich_vu.html', dich_vu=dv)\n \n # Quản lý thanh toán\n @app.route('/thanh-toan')","refToolCallId":"toolu_01BXufNVKE6kTmoGZiL11g2F"},{"type":"text","text":"Bây giờ, tôi sẽ thêm API endpoint để xóa dịch vụ:"},{"type":"toolCall","toolCallId":"toolu_01VMQ5PfLr5XQF7aVrgkN7PW","isHidden":false,"title":"","statusText":"Change generated","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/app.py","path":"nhakhoaso/app.py","displayPath":"nhakhoaso/app.py"}]}},{"type":"codeHunk","lineBasedDiff":"--- nhakhoaso/app.py\n+++ nhakhoaso/app.py\n@@ -616,5 +616,16 @@\n     except Exception as e:\n         return jsonify({\"success\": False, \"message\": str(e)}), 500\n \n+# API xóa dịch vụ\n+@app.route('/api/dich-vu/<ma_dv>', methods=['DELETE'])\n+def api_delete_dich_vu(ma_dv):\n+    try:\n+        result, message = delete_dich_vu(ma_dv)\n+        if not result:\n+            return jsonify({\"success\": False, \"message\": message}), 404\n+        return jsonify({\"success\": True, \"message\": message})\n+    except Exception as e:\n+        return jsonify({\"success\": False, \"message\": str(e)}), 500\n+\n if __name__ == '__main__':\n     app.run(host='0.0.0.0', port=5001, debug=True)","refToolCallId":"toolu_01VMQ5PfLr5XQF7aVrgkN7PW"},{"type":"text","text":"Bây giờ, tôi sẽ cập nhật file index.html để thay đổi url_for('dich_vu') thành url_for('dich_vu_list'):"},{"type":"toolCall","toolCallId":"toolu_018eG79VMZx3sT5prBwiYnt4","isHidden":false,"title":"","statusText":"Change generated","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/templates/index.html","path":"nhakhoaso/templates/index.html","displayPath":"nhakhoaso/templates/index.html"}]}},{"type":"codeHunk","lineBasedDiff":"--- nhakhoaso/templates/index.html\n+++ nhakhoaso/templates/index.html\n@@ -47,13 +47,13 @@\n     </div>\n \n     <!-- Quản lý dịch vụ -->\n-    <div class=\"service-card\" data-link=\"{{ url_for('dich_vu') }}\">\n+    <div class=\"service-card\" data-link=\"{{ url_for('dich_vu_list') }}\">\n         <div class=\"service-icon\">\n             <i class=\"fas fa-hand-holding-heart\"></i>\n         </div>\n         <h3 class=\"service-title\">Quản lý dịch vụ</h3>\n         <p class=\"service-description\">Quản lý các loại dịch vụ nha khoa như nhổ răng, trám răng, tẩy trắng...</p>\n-        <a href=\"{{ url_for('dich_vu') }}\" class=\"btn\">Xem chi tiết</a>\n+        <a href=\"{{ url_for('dich_vu_list') }}\" class=\"btn\">Xem chi tiết</a>\n     </div>\n \n     <!-- Quản lý thanh toán -->","refToolCallId":"toolu_018eG79VMZx3sT5prBwiYnt4"},{"type":"text","text":"Bây giờ, tôi sẽ tạo các template cần thiết cho chức năng quản lý dịch vụ. Đầu tiên, tôi sẽ tạo template dich_vu.html:"},{"type":"toolCall","toolCallId":"toolu_01UxTCAvvU6AxXHidnaip186","isHidden":false,"title":"","statusText":"Change generated","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/templates/dich_vu.html","path":"nhakhoaso/templates/dich_vu.html","displayPath":"nhakhoaso/templates/dich_vu.html"}]}},{"type":"codeHunk","lineBasedDiff":"--- nhakhoaso/templates/dich_vu.html\n+++ nhakhoaso/templates/dich_vu.html\n@@ -0,0 +1,258 @@\n+{% extends 'layout.html' %}\n+\n+{% block title %}Quản lý dịch vụ - NHAKHOASO{% endblock %}\n+\n+{% block content %}\n+<div class=\"section-title\">\n+    <h2>QUẢN LÝ DỊCH VỤ</h2>\n+</div>\n+\n+<!-- Flash messages -->\n+{% with messages = get_flashed_messages(with_categories=true) %}\n+    {% if messages %}\n+        <div class=\"flash-messages\">\n+            {% for category, message in messages %}\n+                <div class=\"flash-message {{ category }}\">{{ message }}</div>\n+            {% endfor %}\n+        </div>\n+    {% endif %}\n+{% endwith %}\n+\n+<div class=\"page-container\">\n+    <!-- Sidebar -->\n+    <div class=\"sidebar\">\n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-user-injured\"></i> Quản lý bệnh nhân\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_benh_nhan') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới bệnh nhân\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_benh_nhan') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm bệnh nhân\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('benh_nhan_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách bệnh nhân\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-clipboard-list\"></i> Quản lý bác sĩ\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_bac_si') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới bác sĩ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_bac_si') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm bác sĩ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('bac_si_page') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách bác sĩ\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <a href=\"{{ url_for('phieu_kham_list') }}\" style=\"text-decoration: none; color: inherit;\">\n+                <i class=\"fas fa-chart-line\"></i> Quản lý phiếu khám\n+            </a>\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_phieu_kham') }}\">\n+                    <i class=\"fas fa-plus\"></i> Tạo phiếu khám\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_phieu_kham') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm phiếu khám\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('phieu_kham_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách phiếu khám\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-calendar-check\"></i> Quản lý lịch hẹn\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_lich_hen') }}\">\n+                    <i class=\"fas fa-plus\"></i> Đặt lịch hẹn\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_lich_hen') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm lịch hẹn\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('lich_hen_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách lịch hẹn\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-hand-holding-heart\"></i> Quản lý dịch vụ\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_dich_vu') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới dịch vụ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_dich_vu') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm dịch vụ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('dich_vu_list') }}\" class=\"active\">\n+                    <i class=\"fas fa-list\"></i> Danh sách dịch vụ\n+                </a>\n+            </li>\n+        </ul>\n+    </div>\n+\n+    <!-- Main content -->\n+    <div class=\"main-content\">\n+        <div class=\"content-header\">\n+            <h2>Danh sách dịch vụ</h2>\n+        </div>\n+        \n+        <div class=\"module-actions\">\n+            <a href=\"{{ url_for('them_moi_dich_vu') }}\" class=\"btn\"><i class=\"fas fa-plus\"></i> Thêm dịch vụ mới</a>\n+            <div class=\"search-box\">\n+                <input type=\"text\" placeholder=\"Tìm kiếm dịch vụ...\">\n+                <button class=\"btn\"><i class=\"fas fa-search\"></i></button>\n+            </div>\n+        </div>\n+\n+        <div class=\"module-content\">\n+            <table class=\"data-table\">\n+                <thead>\n+                    <tr>\n+                        <th>Mã DV</th>\n+                        <th>Tên dịch vụ</th>\n+                        <th>Giá (VNĐ)</th>\n+                        <th>Thao tác</th>\n+                    </tr>\n+                </thead>\n+                <tbody>\n+                    {% if dich_vu_list %}\n+                        {% for dich_vu in dich_vu_list %}\n+                        <tr id=\"dich-vu-{{ dich_vu.MaDV }}\">\n+                            <td>{{ dich_vu.MaDV }}</td>\n+                            <td>{{ dich_vu.TenDV }}</td>\n+                            <td>{{ \"{:,.0f}\".format(dich_vu.Gia|float) }}</td>\n+                            <td>\n+                                <a \n+                                    href=\"{{ url_for('chi_tiet_dich_vu', ma_dv=dich_vu.MaDV) }}\" \n+                                    class=\"action-btn view-btn\" \n+                                    title=\"Xem chi tiết\">\n+                                    <i class=\"fas fa-eye\"></i>\n+                                </a>\n+                                <a \n+                                    href=\"{{ url_for('chinh_sua_dich_vu', ma_dv=dich_vu.MaDV) }}\" \n+                                    class=\"action-btn edit-btn\" \n+                                    title=\"Chỉnh sửa\">\n+                                    <i class=\"fas fa-edit\"></i>\n+                                </a>\n+                                <a \n+                                    href=\"#\" \n+                                    class=\"action-btn delete-btn\" \n+                                    title=\"Xóa\" \n+                                    onclick=\"deleteDichVu('{{ dich_vu.MaDV }}')\">\n+                                    <i class=\"fas fa-trash\"></i>\n+                                </a>\n+                            </td>\n+                        </tr>\n+                        {% endfor %}\n+                    {% else %}\n+                        <tr>\n+                            <td colspan=\"4\" class=\"text-center\">\n+                                <div class=\"no-data\">\n+                                    <i class=\"fas fa-database\"></i>\n+                                    <p>Chưa có dữ liệu dịch vụ</p>\n+                                    <a href=\"{{ url_for('them_moi_dich_vu') }}\" class=\"btn\">\n+                                        <i class=\"fas fa-plus\"></i> Thêm dịch vụ mới\n+                                    </a>\n+                                </div>\n+                            </td>\n+                        </tr>\n+                    {% endif %}\n+                </tbody>\n+            </table>\n+        </div>\n+\n+        <div class=\"pagination\">\n+            <a href=\"#\" class=\"page-link\">&laquo;</a>\n+            <a href=\"#\" class=\"page-link active\">1</a>\n+            <a href=\"#\" class=\"page-link\">2</a>\n+            <a href=\"#\" class=\"page-link\">3</a>\n+            <a href=\"#\" class=\"page-link\">&raquo;</a>\n+        </div>\n+    </div>\n+</div>\n+\n+{% block extra_js %}\n+<script>\n+    // Hàm xóa dịch vụ\n+    function deleteDichVu(maDV) {\n+        if (confirm('Bạn có chắc chắn muốn xóa dịch vụ này?')) {\n+            // Gọi API xóa dịch vụ\n+            fetch(`/api/dich-vu/${maDV}`, {\n+                method: 'DELETE'\n+            })\n+            .then(response => response.json())\n+            .then(data => {\n+                if (data.success) {\n+                    // Xóa dòng khỏi bảng\n+                    document.getElementById(`dich-vu-${maDV}`).remove();\n+                    alert(data.message);\n+                    \n+                    // Kiểm tra nếu không còn dịch vụ nào, hiển thị thông báo\n+                    const tbody = document.querySelector('.data-table tbody');\n+                    if (tbody.children.length === 0) {\n+                        tbody.innerHTML = `\n+                        <tr>\n+                            <td colspan=\"4\" class=\"text-center\">\n+                                <div class=\"no-data\">\n+                                    <i class=\"fas fa-database\"></i>\n+                                    <p>Chưa có dữ liệu dịch vụ</p>\n+                                    <a href=\"{{ url_for('them_moi_dich_vu') }}\" class=\"btn\">\n+                                        <i class=\"fas fa-plus\"></i> Thêm dịch vụ mới\n+                                    </a>\n+                                </div>\n+                            </td>\n+                        </tr>\n+                        `;\n+                    }\n+                } else {\n+                    alert('Lỗi: ' + data.message);\n+                }\n+            })\n+            .catch(error => {\n+                console.error('Error:', error);\n+                alert('Đã xảy ra lỗi khi xóa dịch vụ');\n+            });\n+        }\n+    }\n+</script>\n+{% endblock %}\n+{% endblock %}","refToolCallId":"toolu_01UxTCAvvU6AxXHidnaip186"},{"type":"text","text":"Tiếp theo, tôi sẽ tạo template them_moi_dich_vu.html:"},{"type":"toolCall","toolCallId":"toolu_0188ZhMeDKmjJ7zfYC6vTBbU","isHidden":false,"title":"","statusText":"Change generated","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/templates/them_moi_dich_vu.html","path":"nhakhoaso/templates/them_moi_dich_vu.html","displayPath":"nhakhoaso/templates/them_moi_dich_vu.html"}]}},{"type":"codeHunk","lineBasedDiff":"--- nhakhoaso/templates/them_moi_dich_vu.html\n+++ nhakhoaso/templates/them_moi_dich_vu.html\n@@ -0,0 +1,221 @@\n+{% extends 'layout.html' %}\n+\n+{% block title %}Thêm mới dịch vụ - NHAKHOASO{% endblock %}\n+\n+{% block content %}\n+<div class=\"section-title\">\n+    <h2>QUẢN LÝ DỊCH VỤ</h2>\n+</div>\n+\n+<!-- Flash messages -->\n+{% with messages = get_flashed_messages(with_categories=true) %}\n+    {% if messages %}\n+        <div class=\"flash-messages\">\n+            {% for category, message in messages %}\n+                <div class=\"flash-message {{ category }}\">{{ message }}</div>\n+            {% endfor %}\n+        </div>\n+    {% endif %}\n+{% endwith %}\n+\n+<div class=\"page-container\">\n+    <!-- Sidebar -->\n+    <div class=\"sidebar\">\n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-user-injured\"></i> Quản lý bệnh nhân\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_benh_nhan') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới bệnh nhân\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_benh_nhan') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm bệnh nhân\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('benh_nhan_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách bệnh nhân\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-clipboard-list\"></i> Quản lý bác sĩ\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_bac_si') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới bác sĩ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_bac_si') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm bác sĩ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('bac_si_page') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách bác sĩ\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <a href=\"{{ url_for('phieu_kham_list') }}\" style=\"text-decoration: none; color: inherit;\">\n+                <i class=\"fas fa-chart-line\"></i> Quản lý phiếu khám\n+            </a>\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_phieu_kham') }}\">\n+                    <i class=\"fas fa-plus\"></i> Tạo phiếu khám\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_phieu_kham') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm phiếu khám\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('phieu_kham_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách phiếu khám\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-calendar-check\"></i> Quản lý lịch hẹn\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_lich_hen') }}\">\n+                    <i class=\"fas fa-plus\"></i> Đặt lịch hẹn\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_lich_hen') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm lịch hẹn\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('lich_hen_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách lịch hẹn\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-hand-holding-heart\"></i> Quản lý dịch vụ\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_dich_vu') }}\" class=\"active\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới dịch vụ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_dich_vu') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm dịch vụ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('dich_vu_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách dịch vụ\n+                </a>\n+            </li>\n+        </ul>\n+    </div>\n+\n+    <!-- Main content -->\n+    <div class=\"main-content\">\n+        <div class=\"content-header\">\n+            <h2>Thêm dịch vụ mới</h2>\n+        </div>\n+        \n+        <div class=\"form-container\">\n+            <form action=\"{{ url_for('them_moi_dich_vu') }}\" method=\"POST\">\n+                <div class=\"form-group\">\n+                    <label for=\"ma_dv\">Mã dịch vụ:</label>\n+                    <input type=\"text\" id=\"ma_dv\" name=\"ma_dv\" value=\"{{ ma_dv }}\" readonly>\n+                    <small>Mã dịch vụ được tạo tự động</small>\n+                </div>\n+                \n+                <div class=\"form-group\">\n+                    <label for=\"ten_dv\">Tên dịch vụ:</label>\n+                    <input type=\"text\" id=\"ten_dv\" name=\"ten_dv\" required>\n+                </div>\n+                \n+                <div class=\"form-group\">\n+                    <label for=\"gia\">Giá dịch vụ (VNĐ):</label>\n+                    <input type=\"number\" id=\"gia\" name=\"gia\" min=\"0\" step=\"1000\" value=\"0\">\n+                    <small>Nhập giá dịch vụ (VD: 150000)</small>\n+                </div>\n+                \n+                <div class=\"form-actions\">\n+                    <button type=\"submit\" class=\"btn btn-primary\">\n+                        <i class=\"fas fa-save\"></i> Lưu dịch vụ\n+                    </button>\n+                    <a href=\"{{ url_for('dich_vu_list') }}\" class=\"btn btn-secondary\">\n+                        <i class=\"fas fa-times\"></i> Hủy\n+                    </a>\n+                </div>\n+            </form>\n+        </div>\n+    </div>\n+</div>\n+\n+<style>\n+    .form-container {\n+        background-color: #fff;\n+        padding: 20px;\n+        border-radius: 8px;\n+        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n+    }\n+    \n+    .form-group {\n+        margin-bottom: 20px;\n+    }\n+    \n+    .form-group label {\n+        display: block;\n+        margin-bottom: 5px;\n+        font-weight: 500;\n+    }\n+    \n+    .form-group input,\n+    .form-group select,\n+    .form-group textarea {\n+        width: 100%;\n+        padding: 10px;\n+        border: 1px solid #ddd;\n+        border-radius: 4px;\n+        font-size: 16px;\n+    }\n+    \n+    .form-group small {\n+        display: block;\n+        margin-top: 5px;\n+        color: #666;\n+        font-size: 0.85em;\n+    }\n+    \n+    .form-actions {\n+        display: flex;\n+        gap: 10px;\n+        margin-top: 30px;\n+    }\n+    \n+    .btn-primary {\n+        background-color: var(--primary-color);\n+        color: white;\n+    }\n+    \n+    .btn-secondary {\n+        background-color: #6c757d;\n+        color: white;\n+    }\n+</style>\n+{% endblock %}","refToolCallId":"toolu_0188ZhMeDKmjJ7zfYC6vTBbU"},{"type":"text","text":"Tiếp theo, tôi sẽ tạo template tim_kiem_dich_vu.html:"},{"type":"toolCall","toolCallId":"toolu_01QYDrLfXVESCfFaRfXp3ioU","isHidden":false,"title":"","statusText":"Change generated","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/templates/tim_kiem_dich_vu.html","path":"nhakhoaso/templates/tim_kiem_dich_vu.html","displayPath":"nhakhoaso/templates/tim_kiem_dich_vu.html"}]}},{"type":"codeHunk","lineBasedDiff":"--- nhakhoaso/templates/tim_kiem_dich_vu.html\n+++ nhakhoaso/templates/tim_kiem_dich_vu.html\n@@ -0,0 +1,332 @@\n+{% extends 'layout.html' %}\n+\n+{% block title %}Tìm kiếm dịch vụ - NHAKHOASO{% endblock %}\n+\n+{% block content %}\n+<div class=\"section-title\">\n+    <h2>QUẢN LÝ DỊCH VỤ</h2>\n+</div>\n+\n+<!-- Flash messages -->\n+{% with messages = get_flashed_messages(with_categories=true) %}\n+    {% if messages %}\n+        <div class=\"flash-messages\">\n+            {% for category, message in messages %}\n+                <div class=\"flash-message {{ category }}\">\n+                    {{ message }}\n+                </div>\n+            {% endfor %}\n+        </div>\n+    {% endif %}\n+{% endwith %}\n+\n+<div class=\"page-container\">\n+    <!-- Sidebar -->\n+    <div class=\"sidebar\">\n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-user-injured\"></i> Quản lý bệnh nhân\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_benh_nhan') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới bệnh nhân\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_benh_nhan') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm bệnh nhân\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('benh_nhan_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách bệnh nhân\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-clipboard-list\"></i> Quản lý bác sĩ\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_bac_si') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới bác sĩ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_bac_si') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm bác sĩ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('bac_si_page') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách bác sĩ\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <a href=\"{{ url_for('phieu_kham_list') }}\" style=\"text-decoration: none; color: inherit;\">\n+                <i class=\"fas fa-chart-line\"></i> Quản lý phiếu khám\n+            </a>\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_phieu_kham') }}\">\n+                    <i class=\"fas fa-plus\"></i> Tạo phiếu khám\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_phieu_kham') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm phiếu khám\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('phieu_kham_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách phiếu khám\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-calendar-check\"></i> Quản lý lịch hẹn\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_lich_hen') }}\">\n+                    <i class=\"fas fa-plus\"></i> Đặt lịch hẹn\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_lich_hen') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm lịch hẹn\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('lich_hen_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách lịch hẹn\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-hand-holding-heart\"></i> Quản lý dịch vụ\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_dich_vu') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới dịch vụ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_dich_vu') }}\" class=\"active\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm dịch vụ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('dich_vu_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách dịch vụ\n+                </a>\n+            </li>\n+        </ul>\n+    </div>\n+\n+    <!-- Main content -->\n+    <div class=\"main-content\">\n+        <div class=\"content-header\">\n+            <h2>Tìm kiếm dịch vụ</h2>\n+        </div>\n+        \n+        <div class=\"search-container\">\n+            <form action=\"{{ url_for('tim_kiem_dich_vu') }}\" method=\"POST\" class=\"search-form\">\n+                <div class=\"search-input-group\">\n+                    <input type=\"text\" name=\"tu_khoa\" class=\"form-control\" placeholder=\"Nhập mã dịch vụ, tên dịch vụ hoặc giá...\" value=\"{{ request.form.get('tu_khoa', '') }}\">\n+                    <button type=\"submit\" class=\"btn-search\">\n+                        <i class=\"fas fa-search\"></i> Tìm kiếm\n+                    </button>\n+                </div>\n+                <div class=\"search-options\">\n+                    <label class=\"search-option\">\n+                        <input type=\"radio\" name=\"loai_tim_kiem\" value=\"ma_dv\" checked> Mã dịch vụ\n+                    </label>\n+                    <label class=\"search-option\">\n+                        <input type=\"radio\" name=\"loai_tim_kiem\" value=\"ten_dv\"> Tên dịch vụ\n+                    </label>\n+                    <label class=\"search-option\">\n+                        <input type=\"radio\" name=\"loai_tim_kiem\" value=\"gia\"> Giá dịch vụ\n+                    </label>\n+                </div>\n+            </form>\n+        </div>\n+        \n+        <div class=\"search-results\">\n+            {% if request.method == 'POST' %}\n+                {% if ket_qua %}\n+                    <div class=\"result-header\">\n+                        <h3>Kết quả tìm kiếm</h3>\n+                        <p>Tìm thấy {{ ket_qua|length }} dịch vụ</p>\n+                    </div>\n+                    \n+                    <table class=\"data-table\">\n+                        <thead>\n+                            <tr>\n+                                <th>Mã DV</th>\n+                                <th>Tên dịch vụ</th>\n+                                <th>Giá (VNĐ)</th>\n+                                <th>Thao tác</th>\n+                            </tr>\n+                        </thead>\n+                        <tbody>\n+                            {% for dv in ket_qua %}\n+                                <tr id=\"dich-vu-{{ dv.MaDV }}\">\n+                                    <td>{{ dv.MaDV }}</td>\n+                                    <td>{{ dv.TenDV }}</td>\n+                                    <td>{{ \"{:,.0f}\".format(dv.Gia|float) }}</td>\n+                                    <td>\n+                                        <a href=\"{{ url_for('chi_tiet_dich_vu', ma_dv=dv.MaDV) }}\" class=\"action-btn view-btn\" title=\"Xem chi tiết\"><i class=\"fas fa-eye\"></i></a>\n+                                        <a href=\"{{ url_for('chinh_sua_dich_vu', ma_dv=dv.MaDV) }}\" class=\"action-btn edit-btn\" title=\"Chỉnh sửa\"><i class=\"fas fa-edit\"></i></a>\n+                                        <a href=\"#\" class=\"action-btn delete-btn\" title=\"Xóa\" onclick=\"deleteDichVu('{{ dv.MaDV }}')\"><i class=\"fas fa-trash\"></i></a>\n+                                    </td>\n+                                </tr>\n+                            {% endfor %}\n+                        </tbody>\n+                    </table>\n+                {% else %}\n+                    <div class=\"no-results\">\n+                        <i class=\"fas fa-search\"></i>\n+                        <p>Không tìm thấy dịch vụ nào phù hợp với từ khóa tìm kiếm.</p>\n+                        <p>Vui lòng thử lại với từ khóa khác hoặc <a href=\"{{ url_for('them_moi_dich_vu') }}\">thêm dịch vụ mới</a>.</p>\n+                    </div>\n+                {% endif %}\n+            {% endif %}\n+        </div>\n+    </div>\n+</div>\n+\n+<style>\n+    .search-container {\n+        background-color: var(--secondary-color);\n+        padding: 20px;\n+        border-radius: 8px;\n+        margin-bottom: 30px;\n+    }\n+    \n+    .search-form {\n+        width: 100%;\n+    }\n+    \n+    .search-input-group {\n+        display: flex;\n+        margin-bottom: 15px;\n+    }\n+    \n+    .search-input-group input {\n+        flex: 1;\n+        padding: 12px 15px;\n+        border: 1px solid var(--border-color);\n+        border-radius: 5px 0 0 5px;\n+        font-size: 16px;\n+    }\n+    \n+    .btn-search {\n+        padding: 0 20px;\n+        background-color: var(--primary-color);\n+        color: white;\n+        border: none;\n+        border-radius: 0 5px 5px 0;\n+        cursor: pointer;\n+        font-size: 16px;\n+        display: flex;\n+        align-items: center;\n+    }\n+    \n+    .btn-search i {\n+        margin-right: 8px;\n+    }\n+    \n+    .search-options {\n+        display: flex;\n+        flex-wrap: wrap;\n+        gap: 15px;\n+    }\n+    \n+    .search-option {\n+        display: flex;\n+        align-items: center;\n+        cursor: pointer;\n+    }\n+    \n+    .search-option input {\n+        margin-right: 5px;\n+    }\n+    \n+    .result-header {\n+        display: flex;\n+        justify-content: space-between;\n+        align-items: center;\n+        margin-bottom: 15px;\n+    }\n+    \n+    .result-header h3 {\n+        margin: 0;\n+        font-size: 18px;\n+    }\n+    \n+    .result-header p {\n+        margin: 0;\n+        color: var(--text-muted);\n+    }\n+    \n+    .no-results {\n+        text-align: center;\n+        padding: 40px 20px;\n+        background-color: #f8f9fa;\n+        border-radius: 8px;\n+    }\n+    \n+    .no-results i {\n+        font-size: 48px;\n+        color: #adb5bd;\n+        margin-bottom: 15px;\n+    }\n+    \n+    .no-results p {\n+        margin: 10px 0;\n+        color: #6c757d;\n+    }\n+    \n+    .no-results a {\n+        color: var(--primary-color);\n+        text-decoration: none;\n+        font-weight: 500;\n+    }\n+</style>\n+\n+{% block extra_js %}\n+<script>\n+    // Hàm xóa dịch vụ\n+    function deleteDichVu(maDV) {\n+        if (confirm('Bạn có chắc chắn muốn xóa dịch vụ này?')) {\n+            // Gọi API xóa dịch vụ\n+            fetch(`/api/dich-vu/${maDV}`, {\n+                method: 'DELETE'\n+            })\n+            .then(response => response.json())\n+            .then(data => {\n+                if (data.success) {\n+                    // Xóa dòng khỏi bảng\n+                    document.getElementById(`dich-vu-${maDV}`).remove();\n+                    alert(data.message);\n+                } else {\n+                    alert('Lỗi: ' + data.message);\n+                }\n+            })\n+            .catch(error => {\n+                console.error('Error:', error);\n+                alert('Đã xảy ra lỗi khi xóa dịch vụ');\n+            });\n+        }\n+    }\n+</script>\n+{% endblock %}\n+{% endblock %}","refToolCallId":"toolu_01QYDrLfXVESCfFaRfXp3ioU"},{"type":"text","text":"Tiếp theo, tôi sẽ tạo template chi_tiet_dich_vu.html:"},{"type":"toolCall","toolCallId":"toolu_01WqzhcC4E6sCHkDZcjtKd9E","isHidden":false,"title":"","statusText":"Change generated","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/templates/chi_tiet_dich_vu.html","path":"nhakhoaso/templates/chi_tiet_dich_vu.html","displayPath":"nhakhoaso/templates/chi_tiet_dich_vu.html"}]}},{"type":"codeHunk","lineBasedDiff":"--- nhakhoaso/templates/chi_tiet_dich_vu.html\n+++ nhakhoaso/templates/chi_tiet_dich_vu.html\n@@ -0,0 +1,320 @@\n+{% extends 'layout.html' %}\n+\n+{% block title %}Chi tiết dịch vụ - NHAKHOASO{% endblock %}\n+\n+{% block content %}\n+<div class=\"section-title\">\n+    <h2>QUẢN LÝ DỊCH VỤ</h2>\n+</div>\n+\n+<!-- Flash messages -->\n+{% with messages = get_flashed_messages(with_categories=true) %}\n+    {% if messages %}\n+        <div class=\"flash-messages\">\n+            {% for category, message in messages %}\n+                <div class=\"flash-message {{ category }}\">{{ message }}</div>\n+            {% endfor %}\n+        </div>\n+    {% endif %}\n+{% endwith %}\n+\n+<div class=\"page-container\">\n+    <!-- Sidebar -->\n+    <div class=\"sidebar\">\n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-user-injured\"></i> Quản lý bệnh nhân\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_benh_nhan') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới bệnh nhân\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_benh_nhan') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm bệnh nhân\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('benh_nhan_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách bệnh nhân\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-clipboard-list\"></i> Quản lý bác sĩ\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_bac_si') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới bác sĩ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_bac_si') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm bác sĩ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('bac_si_page') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách bác sĩ\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <a href=\"{{ url_for('phieu_kham_list') }}\" style=\"text-decoration: none; color: inherit;\">\n+                <i class=\"fas fa-chart-line\"></i> Quản lý phiếu khám\n+            </a>\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_phieu_kham') }}\">\n+                    <i class=\"fas fa-plus\"></i> Tạo phiếu khám\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_phieu_kham') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm phiếu khám\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('phieu_kham_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách phiếu khám\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-calendar-check\"></i> Quản lý lịch hẹn\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_lich_hen') }}\">\n+                    <i class=\"fas fa-plus\"></i> Đặt lịch hẹn\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_lich_hen') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm lịch hẹn\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('lich_hen_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách lịch hẹn\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-hand-holding-heart\"></i> Quản lý dịch vụ\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_dich_vu') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới dịch vụ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_dich_vu') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm dịch vụ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('dich_vu_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách dịch vụ\n+                </a>\n+            </li>\n+        </ul>\n+    </div>\n+\n+    <!-- Main content -->\n+    <div class=\"main-content\">\n+        <div class=\"content-header\">\n+            <h2>Chi tiết dịch vụ</h2>\n+            <div class=\"header-actions\">\n+                <a href=\"{{ url_for('chinh_sua_dich_vu', ma_dv=dich_vu.MaDV) }}\" class=\"btn btn-primary\">\n+                    <i class=\"fas fa-edit\"></i> Chỉnh sửa\n+                </a>\n+                <a href=\"{{ url_for('dich_vu_list') }}\" class=\"btn btn-secondary\">\n+                    <i class=\"fas fa-arrow-left\"></i> Quay lại\n+                </a>\n+            </div>\n+        </div>\n+        \n+        <div class=\"detail-container\">\n+            <div class=\"detail-card\">\n+                <div class=\"detail-header\">\n+                    <h3>Thông tin dịch vụ</h3>\n+                    <div class=\"price-tag\">{{ \"{:,.0f}\".format(dich_vu.Gia|float) }} VNĐ</div>\n+                </div>\n+                \n+                <div class=\"detail-content\">\n+                    <div class=\"detail-row\">\n+                        <div class=\"detail-label\">Mã dịch vụ:</div>\n+                        <div class=\"detail-value\">{{ dich_vu.MaDV }}</div>\n+                    </div>\n+                    \n+                    <div class=\"detail-row\">\n+                        <div class=\"detail-label\">Tên dịch vụ:</div>\n+                        <div class=\"detail-value\">{{ dich_vu.TenDV }}</div>\n+                    </div>\n+                    \n+                    <div class=\"detail-row\">\n+                        <div class=\"detail-label\">Giá dịch vụ:</div>\n+                        <div class=\"detail-value\">{{ \"{:,.0f}\".format(dich_vu.Gia|float) }} VNĐ</div>\n+                    </div>\n+                </div>\n+                \n+                <div class=\"detail-actions\">\n+                    <a href=\"{{ url_for('chinh_sua_dich_vu', ma_dv=dich_vu.MaDV) }}\" class=\"btn btn-primary\">\n+                        <i class=\"fas fa-edit\"></i> Chỉnh sửa\n+                    </a>\n+                    <button class=\"btn btn-danger\" onclick=\"deleteDichVu('{{ dich_vu.MaDV }}')\">\n+                        <i class=\"fas fa-trash\"></i> Xóa\n+                    </button>\n+                    <a href=\"{{ url_for('dich_vu_list') }}\" class=\"btn btn-secondary\">\n+                        <i class=\"fas fa-arrow-left\"></i> Quay lại\n+                    </a>\n+                </div>\n+            </div>\n+        </div>\n+    </div>\n+</div>\n+\n+<style>\n+    .content-header {\n+        display: flex;\n+        justify-content: space-between;\n+        align-items: center;\n+        margin-bottom: 20px;\n+    }\n+    \n+    .header-actions {\n+        display: flex;\n+        gap: 10px;\n+    }\n+    \n+    .detail-container {\n+        background-color: #fff;\n+        border-radius: 8px;\n+        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n+        overflow: hidden;\n+    }\n+    \n+    .detail-card {\n+        padding: 0;\n+    }\n+    \n+    .detail-header {\n+        background-color: var(--secondary-color);\n+        padding: 15px 20px;\n+        display: flex;\n+        justify-content: space-between;\n+        align-items: center;\n+    }\n+    \n+    .detail-header h3 {\n+        margin: 0;\n+        font-size: 18px;\n+        color: var(--primary-color);\n+    }\n+    \n+    .price-tag {\n+        background-color: var(--primary-color);\n+        color: white;\n+        padding: 5px 10px;\n+        border-radius: 4px;\n+        font-weight: bold;\n+    }\n+    \n+    .detail-content {\n+        padding: 20px;\n+    }\n+    \n+    .detail-row {\n+        display: flex;\n+        margin-bottom: 15px;\n+        border-bottom: 1px solid #eee;\n+        padding-bottom: 15px;\n+    }\n+    \n+    .detail-row:last-child {\n+        margin-bottom: 0;\n+        border-bottom: none;\n+        padding-bottom: 0;\n+    }\n+    \n+    .detail-label {\n+        width: 150px;\n+        font-weight: 500;\n+        color: #555;\n+    }\n+    \n+    .detail-value {\n+        flex: 1;\n+    }\n+    \n+    .detail-actions {\n+        padding: 15px 20px;\n+        background-color: #f8f9fa;\n+        display: flex;\n+        gap: 10px;\n+        justify-content: flex-end;\n+    }\n+    \n+    .btn {\n+        padding: 8px 15px;\n+        border: none;\n+        border-radius: 4px;\n+        cursor: pointer;\n+        font-size: 14px;\n+        display: inline-flex;\n+        align-items: center;\n+        gap: 5px;\n+    }\n+    \n+    .btn-primary {\n+        background-color: var(--primary-color);\n+        color: white;\n+    }\n+    \n+    .btn-secondary {\n+        background-color: #6c757d;\n+        color: white;\n+    }\n+    \n+    .btn-danger {\n+        background-color: #dc3545;\n+        color: white;\n+    }\n+</style>\n+\n+{% block extra_js %}\n+<script>\n+    // Hàm xóa dịch vụ\n+    function deleteDichVu(maDV) {\n+        if (confirm('Bạn có chắc chắn muốn xóa dịch vụ này?')) {\n+            // Gọi API xóa dịch vụ\n+            fetch(`/api/dich-vu/${maDV}`, {\n+                method: 'DELETE'\n+            })\n+            .then(response => response.json())\n+            .then(data => {\n+                if (data.success) {\n+                    alert(data.message);\n+                    window.location.href = \"{{ url_for('dich_vu_list') }}\";\n+                } else {\n+                    alert('Lỗi: ' + data.message);\n+                }\n+            })\n+            .catch(error => {\n+                console.error('Error:', error);\n+                alert('Đã xảy ra lỗi khi xóa dịch vụ');\n+            });\n+        }\n+    }\n+</script>\n+{% endblock %}\n+{% endblock %}","refToolCallId":"toolu_01WqzhcC4E6sCHkDZcjtKd9E"},{"type":"text","text":"Cuối cùng, tôi sẽ tạo template chinh_sua_dich_vu.html:"},{"type":"toolCall","toolCallId":"toolu_013MnRo2TzAwmudaMDHVHiCc","isHidden":false,"title":"","statusText":"Change generated","status":"SUCCESS","context":{"files":[{"fsPath":"/home/huong/nhakhoaso/templates/chinh_sua_dich_vu.html","path":"nhakhoaso/templates/chinh_sua_dich_vu.html","displayPath":"nhakhoaso/templates/chinh_sua_dich_vu.html"}]}},{"type":"codeHunk","lineBasedDiff":"--- nhakhoaso/templates/chinh_sua_dich_vu.html\n+++ nhakhoaso/templates/chinh_sua_dich_vu.html\n@@ -0,0 +1,221 @@\n+{% extends 'layout.html' %}\n+\n+{% block title %}Chỉnh sửa dịch vụ - NHAKHOASO{% endblock %}\n+\n+{% block content %}\n+<div class=\"section-title\">\n+    <h2>QUẢN LÝ DỊCH VỤ</h2>\n+</div>\n+\n+<!-- Flash messages -->\n+{% with messages = get_flashed_messages(with_categories=true) %}\n+    {% if messages %}\n+        <div class=\"flash-messages\">\n+            {% for category, message in messages %}\n+                <div class=\"flash-message {{ category }}\">{{ message }}</div>\n+            {% endfor %}\n+        </div>\n+    {% endif %}\n+{% endwith %}\n+\n+<div class=\"page-container\">\n+    <!-- Sidebar -->\n+    <div class=\"sidebar\">\n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-user-injured\"></i> Quản lý bệnh nhân\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_benh_nhan') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới bệnh nhân\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_benh_nhan') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm bệnh nhân\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('benh_nhan_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách bệnh nhân\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-clipboard-list\"></i> Quản lý bác sĩ\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_bac_si') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới bác sĩ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_bac_si') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm bác sĩ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('bac_si_page') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách bác sĩ\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <a href=\"{{ url_for('phieu_kham_list') }}\" style=\"text-decoration: none; color: inherit;\">\n+                <i class=\"fas fa-chart-line\"></i> Quản lý phiếu khám\n+            </a>\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_phieu_kham') }}\">\n+                    <i class=\"fas fa-plus\"></i> Tạo phiếu khám\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_phieu_kham') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm phiếu khám\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('phieu_kham_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách phiếu khám\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-calendar-check\"></i> Quản lý lịch hẹn\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_lich_hen') }}\">\n+                    <i class=\"fas fa-plus\"></i> Đặt lịch hẹn\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_lich_hen') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm lịch hẹn\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('lich_hen_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách lịch hẹn\n+                </a>\n+            </li>\n+        </ul>\n+        \n+        <div class=\"sidebar-title\">\n+            <i class=\"fas fa-hand-holding-heart\"></i> Quản lý dịch vụ\n+        </div>\n+        <ul class=\"sidebar-menu\">\n+            <li>\n+                <a href=\"{{ url_for('them_moi_dich_vu') }}\">\n+                    <i class=\"fas fa-plus\"></i> Thêm mới dịch vụ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('tim_kiem_dich_vu') }}\">\n+                    <i class=\"fas fa-search\"></i> Tìm kiếm dịch vụ\n+                </a>\n+            </li>\n+            <li>\n+                <a href=\"{{ url_for('dich_vu_list') }}\">\n+                    <i class=\"fas fa-list\"></i> Danh sách dịch vụ\n+                </a>\n+            </li>\n+        </ul>\n+    </div>\n+\n+    <!-- Main content -->\n+    <div class=\"main-content\">\n+        <div class=\"content-header\">\n+            <h2>Chỉnh sửa dịch vụ</h2>\n+        </div>\n+        \n+        <div class=\"form-container\">\n+            <form action=\"{{ url_for('chinh_sua_dich_vu', ma_dv=dich_vu.MaDV) }}\" method=\"POST\">\n+                <div class=\"form-group\">\n+                    <label for=\"ma_dv\">Mã dịch vụ:</label>\n+                    <input type=\"text\" id=\"ma_dv\" name=\"ma_dv\" value=\"{{ dich_vu.MaDV }}\" readonly>\n+                    <small>Mã dịch vụ không thể thay đổi</small>\n+                </div>\n+                \n+                <div class=\"form-group\">\n+                    <label for=\"ten_dv\">Tên dịch vụ:</label>\n+                    <input type=\"text\" id=\"ten_dv\" name=\"ten_dv\" value=\"{{ dich_vu.TenDV }}\" required>\n+                </div>\n+                \n+                <div class=\"form-group\">\n+                    <label for=\"gia\">Giá dịch vụ (VNĐ):</label>\n+                    <input type=\"number\" id=\"gia\" name=\"gia\" min=\"0\" step=\"1000\" value=\"{{ dich_vu.Gia }}\">\n+                    <small>Nhập giá dịch vụ (VD: 150000)</small>\n+                </div>\n+                \n+                <div class=\"form-actions\">\n+                    <button type=\"submit\" class=\"btn btn-primary\">\n+                        <i class=\"fas fa-save\"></i> Lưu thay đổi\n+                    </button>\n+                    <a href=\"{{ url_for('chi_tiet_dich_vu', ma_dv=dich_vu.MaDV) }}\" class=\"btn btn-secondary\">\n+                        <i class=\"fas fa-times\"></i> Hủy\n+                    </a>\n+                </div>\n+            </form>\n+        </div>\n+    </div>\n+</div>\n+\n+<style>\n+    .form-container {\n+        background-color: #fff;\n+        padding: 20px;\n+        border-radius: 8px;\n+        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n+    }\n+    \n+    .form-group {\n+        margin-bottom: 20px;\n+    }\n+    \n+    .form-group label {\n+        display: block;\n+        margin-bottom: 5px;\n+        font-weight: 500;\n+    }\n+    \n+    .form-group input,\n+    .form-group select,\n+    .form-group textarea {\n+        width: 100%;\n+        padding: 10px;\n+        border: 1px solid #ddd;\n+        border-radius: 4px;\n+        font-size: 16px;\n+    }\n+    \n+    .form-group small {\n+        display: block;\n+        margin-top: 5px;\n+        color: #666;\n+        font-size: 0.85em;\n+    }\n+    \n+    .form-actions {\n+        display: flex;\n+        gap: 10px;\n+        margin-top: 30px;\n+    }\n+    \n+    .btn-primary {\n+        background-color: var(--primary-color);\n+        color: white;\n+    }\n+    \n+    .btn-secondary {\n+        background-color: #6c757d;\n+        color: white;\n+    }\n+</style>\n+{% endblock %}","refToolCallId":"toolu_013MnRo2TzAwmudaMDHVHiCc"},{"type":"text","text":"Tôi đã hoàn thành việc tạo các file cần thiết cho chức năng quản lý dịch vụ. Hãy chạy ứng dụng để kiểm tra:"},{"type":"toolCall","toolCallId":"toolu_01EeyPycv8TcujnjrXjqh34U","isHidden":true,"title":"","statusText":"","status":"IN_PROGRESS","localResult":"{\"status\":\"ERROR\",\"exitCode\":124,\"output\":\" * Serving Flask app 'app'\\n * Debug mode: on\\nWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.\\n * Running on all addresses (0.0.0.0)\\n * Running on http://127.0.0.1:5001\\n * Running on http://172.26.181.174:5001\\nPress CTRL+C to quit\\n * Restarting with stat\\n * Debugger is active!\\n * Debugger PIN: 110-037-917\\n\"}"},{"type":"codePatch","diffs":[{"path":"nhakhoaso/templates/index.html","patch":"@@ -2060,24 +2060,29 @@\n for('dich_vu\n+_list\n ') %7D%7D%22%3E%0A    \n@@ -2387,16 +2387,21 @@\n 'dich_vu\n+_list\n ') %7D%7D%22 c\n","isNew":false,"isApplied":true,"isUnread":false},{"path":"nhakhoaso/templates/them_moi_dich_vu.html","patch":"@@ -0,0 +1,6888 @@\n+%7B%25 extends 'layout.html' %25%7D%0A%0A%7B%25 block title %25%7DTh%C3%AAm m%E1%BB%9Bi d%E1%BB%8Bch v%E1%BB%A5 - NHAKHOASO%7B%25 endblock %25%7D%0A%0A%7B%25 block content %25%7D%0A%3Cdiv class=%22section-title%22%3E%0A    %3Ch2%3EQU%E1%BA%A2N L%C3%9D D%E1%BB%8ACH V%E1%BB%A4%3C/h2%3E%0A%3C/div%3E%0A%0A%3C!-- Flash messages --%3E%0A%7B%25 with messages = get_flashed_messages(with_categories=true) %25%7D%0A    %7B%25 if messages %25%7D%0A        %3Cdiv class=%22flash-messages%22%3E%0A            %7B%25 for category, message in messages %25%7D%0A                %3Cdiv class=%22flash-message %7B%7B category %7D%7D%22%3E%7B%7B message %7D%7D%3C/div%3E%0A            %7B%25 endfor %25%7D%0A        %3C/div%3E%0A    %7B%25 endif %25%7D%0A%7B%25 endwith %25%7D%0A%0A%3Cdiv class=%22page-container%22%3E%0A    %3C!-- Sidebar --%3E%0A    %3Cdiv class=%22sidebar%22%3E%0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-user-injured%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD b%E1%BB%87nh nh%C3%A2n%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_benh_nhan') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_benh_nhan') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('benh_nhan_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-clipboard-list%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD b%C3%A1c s%C4%A9%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_bac_si') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_bac_si') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('bac_si_page') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ca href=%22%7B%7B url_for('phieu_kham_list') %7D%7D%22 style=%22text-decoration: none; color: inherit;%22%3E%0A                %3Ci class=%22fas fa-chart-line%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD phi%E1%BA%BFu kh%C3%A1m%0A            %3C/a%3E%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_phieu_kham') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E T%E1%BA%A1o phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_phieu_kham') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('phieu_kham_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-calendar-check%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD l%E1%BB%8Bch h%E1%BA%B9n%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_lich_hen') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E %C4%90%E1%BA%B7t l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_lich_hen') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('lich_hen_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-hand-holding-heart%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD d%E1%BB%8Bch v%E1%BB%A5%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_dich_vu') %7D%7D%22 class=%22active%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi d%E1%BB%8Bch v%E1%BB%A5%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_dich_vu') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm d%E1%BB%8Bch v%E1%BB%A5%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('dich_vu_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch d%E1%BB%8Bch v%E1%BB%A5%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A    %3C/div%3E%0A%0A    %3C!-- Main content --%3E%0A    %3Cdiv class=%22main-content%22%3E%0A        %3Cdiv class=%22content-header%22%3E%0A            %3Ch2%3ETh%C3%AAm d%E1%BB%8Bch v%E1%BB%A5 m%E1%BB%9Bi%3C/h2%3E%0A        %3C/div%3E%0A        %0A        %3Cdiv class=%22form-container%22%3E%0A            %3Cform action=%22%7B%7B url_for('them_moi_dich_vu') %7D%7D%22 method=%22POST%22%3E%0A                %3Cdiv class=%22form-group%22%3E%0A                    %3Clabel for=%22ma_dv%22%3EM%C3%A3 d%E1%BB%8Bch v%E1%BB%A5:%3C/label%3E%0A                    %3Cinput type=%22text%22 id=%22ma_dv%22 name=%22ma_dv%22 value=%22%7B%7B ma_dv %7D%7D%22 readonly%3E%0A                    %3Csmall%3EM%C3%A3 d%E1%BB%8Bch v%E1%BB%A5 %C4%91%C6%B0%E1%BB%A3c t%E1%BA%A1o t%E1%BB%B1 %C4%91%E1%BB%99ng%3C/small%3E%0A                %3C/div%3E%0A                %0A                %3Cdiv class=%22form-group%22%3E%0A                    %3Clabel for=%22ten_dv%22%3ET%C3%AAn d%E1%BB%8Bch v%E1%BB%A5:%3C/label%3E%0A                    %3Cinput type=%22text%22 id=%22ten_dv%22 name=%22ten_dv%22 required%3E%0A                %3C/div%3E%0A                %0A                %3Cdiv class=%22form-group%22%3E%0A                    %3Clabel for=%22gia%22%3EGi%C3%A1 d%E1%BB%8Bch v%E1%BB%A5 (VN%C4%90):%3C/label%3E%0A                    %3Cinput type=%22number%22 id=%22gia%22 name=%22gia%22 min=%220%22 step=%221000%22 value=%220%22%3E%0A                    %3Csmall%3ENh%E1%BA%ADp gi%C3%A1 d%E1%BB%8Bch v%E1%BB%A5 (VD: 150000)%3C/small%3E%0A                %3C/div%3E%0A                %0A                %3Cdiv class=%22form-actions%22%3E%0A                    %3Cbutton type=%22submit%22 class=%22btn btn-primary%22%3E%0A                        %3Ci class=%22fas fa-save%22%3E%3C/i%3E L%C6%B0u d%E1%BB%8Bch v%E1%BB%A5%0A                    %3C/button%3E%0A                    %3Ca href=%22%7B%7B url_for('dich_vu_list') %7D%7D%22 class=%22btn btn-secondary%22%3E%0A                        %3Ci class=%22fas fa-times%22%3E%3C/i%3E H%E1%BB%A7y%0A                    %3C/a%3E%0A                %3C/div%3E%0A            %3C/form%3E%0A        %3C/div%3E%0A    %3C/div%3E%0A%3C/div%3E%0A%0A%3Cstyle%3E%0A    .form-container %7B%0A        background-color: #fff;%0A        padding: 20px;%0A        border-radius: 8px;%0A        box-shadow: 0 2px 4px rgba(0,0,0,0.1);%0A    %7D%0A    %0A    .form-group %7B%0A        margin-bottom: 20px;%0A    %7D%0A    %0A    .form-group label %7B%0A        display: block;%0A        margin-bottom: 5px;%0A        font-weight: 500;%0A    %7D%0A    %0A    .form-group input,%0A    .form-group select,%0A    .form-group textarea %7B%0A        width: 100%25;%0A        padding: 10px;%0A        border: 1px solid #ddd;%0A        border-radius: 4px;%0A        font-size: 16px;%0A    %7D%0A    %0A    .form-group small %7B%0A        display: block;%0A        margin-top: 5px;%0A        color: #666;%0A        font-size: 0.85em;%0A    %7D%0A    %0A    .form-actions %7B%0A        display: flex;%0A        gap: 10px;%0A        margin-top: 30px;%0A    %7D%0A    %0A    .btn-primary %7B%0A        background-color: var(--primary-color);%0A        color: white;%0A    %7D%0A    %0A    .btn-secondary %7B%0A        background-color: #6c757d;%0A        color: white;%0A    %7D%0A%3C/style%3E%0A%7B%25 endblock %25%7D\n","isNew":true,"isApplied":true,"isUnread":false},{"path":"nhakhoaso/templates/chinh_sua_dich_vu.html","patch":"@@ -0,0 +1,6974 @@\n+%7B%25 extends 'layout.html' %25%7D%0A%0A%7B%25 block title %25%7DCh%E1%BB%89nh s%E1%BB%ADa d%E1%BB%8Bch v%E1%BB%A5 - NHAKHOASO%7B%25 endblock %25%7D%0A%0A%7B%25 block content %25%7D%0A%3Cdiv class=%22section-title%22%3E%0A    %3Ch2%3EQU%E1%BA%A2N L%C3%9D D%E1%BB%8ACH V%E1%BB%A4%3C/h2%3E%0A%3C/div%3E%0A%0A%3C!-- Flash messages --%3E%0A%7B%25 with messages = get_flashed_messages(with_categories=true) %25%7D%0A    %7B%25 if messages %25%7D%0A        %3Cdiv class=%22flash-messages%22%3E%0A            %7B%25 for category, message in messages %25%7D%0A                %3Cdiv class=%22flash-message %7B%7B category %7D%7D%22%3E%7B%7B message %7D%7D%3C/div%3E%0A            %7B%25 endfor %25%7D%0A        %3C/div%3E%0A    %7B%25 endif %25%7D%0A%7B%25 endwith %25%7D%0A%0A%3Cdiv class=%22page-container%22%3E%0A    %3C!-- Sidebar --%3E%0A    %3Cdiv class=%22sidebar%22%3E%0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-user-injured%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD b%E1%BB%87nh nh%C3%A2n%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_benh_nhan') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_benh_nhan') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('benh_nhan_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-clipboard-list%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD b%C3%A1c s%C4%A9%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_bac_si') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_bac_si') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('bac_si_page') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ca href=%22%7B%7B url_for('phieu_kham_list') %7D%7D%22 style=%22text-decoration: none; color: inherit;%22%3E%0A                %3Ci class=%22fas fa-chart-line%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD phi%E1%BA%BFu kh%C3%A1m%0A            %3C/a%3E%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_phieu_kham') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E T%E1%BA%A1o phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_phieu_kham') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('phieu_kham_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-calendar-check%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD l%E1%BB%8Bch h%E1%BA%B9n%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_lich_hen') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E %C4%90%E1%BA%B7t l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_lich_hen') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('lich_hen_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-hand-holding-heart%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD d%E1%BB%8Bch v%E1%BB%A5%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_dich_vu') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi d%E1%BB%8Bch v%E1%BB%A5%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_dich_vu') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm d%E1%BB%8Bch v%E1%BB%A5%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('dich_vu_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch d%E1%BB%8Bch v%E1%BB%A5%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A    %3C/div%3E%0A%0A    %3C!-- Main content --%3E%0A    %3Cdiv class=%22main-content%22%3E%0A        %3Cdiv class=%22content-header%22%3E%0A            %3Ch2%3ECh%E1%BB%89nh s%E1%BB%ADa d%E1%BB%8Bch v%E1%BB%A5%3C/h2%3E%0A        %3C/div%3E%0A        %0A        %3Cdiv class=%22form-container%22%3E%0A            %3Cform action=%22%7B%7B url_for('chinh_sua_dich_vu', ma_dv=dich_vu.MaDV) %7D%7D%22 method=%22POST%22%3E%0A                %3Cdiv class=%22form-group%22%3E%0A                    %3Clabel for=%22ma_dv%22%3EM%C3%A3 d%E1%BB%8Bch v%E1%BB%A5:%3C/label%3E%0A                    %3Cinput type=%22text%22 id=%22ma_dv%22 name=%22ma_dv%22 value=%22%7B%7B dich_vu.MaDV %7D%7D%22 readonly%3E%0A                    %3Csmall%3EM%C3%A3 d%E1%BB%8Bch v%E1%BB%A5 kh%C3%B4ng th%E1%BB%83 thay %C4%91%E1%BB%95i%3C/small%3E%0A                %3C/div%3E%0A                %0A                %3Cdiv class=%22form-group%22%3E%0A                    %3Clabel for=%22ten_dv%22%3ET%C3%AAn d%E1%BB%8Bch v%E1%BB%A5:%3C/label%3E%0A                    %3Cinput type=%22text%22 id=%22ten_dv%22 name=%22ten_dv%22 value=%22%7B%7B dich_vu.TenDV %7D%7D%22 required%3E%0A                %3C/div%3E%0A                %0A                %3Cdiv class=%22form-group%22%3E%0A                    %3Clabel for=%22gia%22%3EGi%C3%A1 d%E1%BB%8Bch v%E1%BB%A5 (VN%C4%90):%3C/label%3E%0A                    %3Cinput type=%22number%22 id=%22gia%22 name=%22gia%22 min=%220%22 step=%221000%22 value=%22%7B%7B dich_vu.Gia %7D%7D%22%3E%0A                    %3Csmall%3ENh%E1%BA%ADp gi%C3%A1 d%E1%BB%8Bch v%E1%BB%A5 (VD: 150000)%3C/small%3E%0A                %3C/div%3E%0A                %0A                %3Cdiv class=%22form-actions%22%3E%0A                    %3Cbutton type=%22submit%22 class=%22btn btn-primary%22%3E%0A                        %3Ci class=%22fas fa-save%22%3E%3C/i%3E L%C6%B0u thay %C4%91%E1%BB%95i%0A                    %3C/button%3E%0A                    %3Ca href=%22%7B%7B url_for('chi_tiet_dich_vu', ma_dv=dich_vu.MaDV) %7D%7D%22 class=%22btn btn-secondary%22%3E%0A                        %3Ci class=%22fas fa-times%22%3E%3C/i%3E H%E1%BB%A7y%0A                    %3C/a%3E%0A                %3C/div%3E%0A            %3C/form%3E%0A        %3C/div%3E%0A    %3C/div%3E%0A%3C/div%3E%0A%0A%3Cstyle%3E%0A    .form-container %7B%0A        background-color: #fff;%0A        padding: 20px;%0A        border-radius: 8px;%0A        box-shadow: 0 2px 4px rgba(0,0,0,0.1);%0A    %7D%0A    %0A    .form-group %7B%0A        margin-bottom: 20px;%0A    %7D%0A    %0A    .form-group label %7B%0A        display: block;%0A        margin-bottom: 5px;%0A        font-weight: 500;%0A    %7D%0A    %0A    .form-group input,%0A    .form-group select,%0A    .form-group textarea %7B%0A        width: 100%25;%0A        padding: 10px;%0A        border: 1px solid #ddd;%0A        border-radius: 4px;%0A        font-size: 16px;%0A    %7D%0A    %0A    .form-group small %7B%0A        display: block;%0A        margin-top: 5px;%0A        color: #666;%0A        font-size: 0.85em;%0A    %7D%0A    %0A    .form-actions %7B%0A        display: flex;%0A        gap: 10px;%0A        margin-top: 30px;%0A    %7D%0A    %0A    .btn-primary %7B%0A        background-color: var(--primary-color);%0A        color: white;%0A    %7D%0A    %0A    .btn-secondary %7B%0A        background-color: #6c757d;%0A        color: white;%0A    %7D%0A%3C/style%3E%0A%7B%25 endblock %25%7D\n","isNew":true,"isApplied":true,"isUnread":false},{"path":"nhakhoaso/templates/dich_vu.html","patch":"@@ -0,0 +1,9685 @@\n+%7B%25 extends 'layout.html' %25%7D%0A%0A%7B%25 block title %25%7DQu%E1%BA%A3n l%C3%BD d%E1%BB%8Bch v%E1%BB%A5 - NHAKHOASO%7B%25 endblock %25%7D%0A%0A%7B%25 block content %25%7D%0A%3Cdiv class=%22section-title%22%3E%0A    %3Ch2%3EQU%E1%BA%A2N L%C3%9D D%E1%BB%8ACH V%E1%BB%A4%3C/h2%3E%0A%3C/div%3E%0A%0A%3C!-- Flash messages --%3E%0A%7B%25 with messages = get_flashed_messages(with_categories=true) %25%7D%0A    %7B%25 if messages %25%7D%0A        %3Cdiv class=%22flash-messages%22%3E%0A            %7B%25 for category, message in messages %25%7D%0A                %3Cdiv class=%22flash-message %7B%7B category %7D%7D%22%3E%7B%7B message %7D%7D%3C/div%3E%0A            %7B%25 endfor %25%7D%0A        %3C/div%3E%0A    %7B%25 endif %25%7D%0A%7B%25 endwith %25%7D%0A%0A%3Cdiv class=%22page-container%22%3E%0A    %3C!-- Sidebar --%3E%0A    %3Cdiv class=%22sidebar%22%3E%0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-user-injured%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD b%E1%BB%87nh nh%C3%A2n%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_benh_nhan') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_benh_nhan') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('benh_nhan_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-clipboard-list%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD b%C3%A1c s%C4%A9%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_bac_si') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_bac_si') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('bac_si_page') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ca href=%22%7B%7B url_for('phieu_kham_list') %7D%7D%22 style=%22text-decoration: none; color: inherit;%22%3E%0A                %3Ci class=%22fas fa-chart-line%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD phi%E1%BA%BFu kh%C3%A1m%0A            %3C/a%3E%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_phieu_kham') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E T%E1%BA%A1o phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_phieu_kham') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('phieu_kham_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-calendar-check%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD l%E1%BB%8Bch h%E1%BA%B9n%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_lich_hen') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E %C4%90%E1%BA%B7t l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_lich_hen') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('lich_hen_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-hand-holding-heart%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD d%E1%BB%8Bch v%E1%BB%A5%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_dich_vu') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi d%E1%BB%8Bch v%E1%BB%A5%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_dich_vu') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm d%E1%BB%8Bch v%E1%BB%A5%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('dich_vu_list') %7D%7D%22 class=%22active%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch d%E1%BB%8Bch v%E1%BB%A5%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A    %3C/div%3E%0A%0A    %3C!-- Main content --%3E%0A    %3Cdiv class=%22main-content%22%3E%0A        %3Cdiv class=%22content-header%22%3E%0A            %3Ch2%3EDanh s%C3%A1ch d%E1%BB%8Bch v%E1%BB%A5%3C/h2%3E%0A        %3C/div%3E%0A        %0A        %3Cdiv class=%22module-actions%22%3E%0A            %3Ca href=%22%7B%7B url_for('them_moi_dich_vu') %7D%7D%22 class=%22btn%22%3E%3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm d%E1%BB%8Bch v%E1%BB%A5 m%E1%BB%9Bi%3C/a%3E%0A            %3Cdiv class=%22search-box%22%3E%0A                %3Cinput type=%22text%22 placeholder=%22T%C3%ACm ki%E1%BA%BFm d%E1%BB%8Bch v%E1%BB%A5...%22%3E%0A                %3Cbutton class=%22btn%22%3E%3Ci class=%22fas fa-search%22%3E%3C/i%3E%3C/button%3E%0A            %3C/div%3E%0A        %3C/div%3E%0A%0A        %3Cdiv class=%22module-content%22%3E%0A            %3Ctable class=%22data-table%22%3E%0A                %3Cthead%3E%0A                    %3Ctr%3E%0A                        %3Cth%3EM%C3%A3 DV%3C/th%3E%0A                        %3Cth%3ET%C3%AAn d%E1%BB%8Bch v%E1%BB%A5%3C/th%3E%0A                        %3Cth%3EGi%C3%A1 (VN%C4%90)%3C/th%3E%0A                        %3Cth%3EThao t%C3%A1c%3C/th%3E%0A                    %3C/tr%3E%0A                %3C/thead%3E%0A                %3Ctbody%3E%0A                    %7B%25 if dich_vu_list %25%7D%0A                        %7B%25 for dich_vu in dich_vu_list %25%7D%0A                        %3Ctr id=%22dich-vu-%7B%7B dich_vu.MaDV %7D%7D%22%3E%0A                            %3Ctd%3E%7B%7B dich_vu.MaDV %7D%7D%3C/td%3E%0A                            %3Ctd%3E%7B%7B dich_vu.TenDV %7D%7D%3C/td%3E%0A                            %3Ctd%3E%7B%7B %22%7B:,.0f%7D%22.format(dich_vu.Gia%7Cfloat) %7D%7D%3C/td%3E%0A                            %3Ctd%3E%0A                                %3Ca %0A                                    href=%22%7B%7B url_for('chi_tiet_dich_vu', ma_dv=dich_vu.MaDV) %7D%7D%22 %0A                                    class=%22action-btn view-btn%22 %0A                                    title=%22Xem chi ti%E1%BA%BFt%22%3E%0A                                    %3Ci class=%22fas fa-eye%22%3E%3C/i%3E%0A                                %3C/a%3E%0A                                %3Ca %0A                                    href=%22%7B%7B url_for('chinh_sua_dich_vu', ma_dv=dich_vu.MaDV) %7D%7D%22 %0A                                    class=%22action-btn edit-btn%22 %0A                                    title=%22Ch%E1%BB%89nh s%E1%BB%ADa%22%3E%0A                                    %3Ci class=%22fas fa-edit%22%3E%3C/i%3E%0A                                %3C/a%3E%0A                                %3Ca %0A                                    href=%22#%22 %0A                                    class=%22action-btn delete-btn%22 %0A                                    title=%22X%C3%B3a%22 %0A                                    onclick=%22deleteDichVu('%7B%7B dich_vu.MaDV %7D%7D')%22%3E%0A                                    %3Ci class=%22fas fa-trash%22%3E%3C/i%3E%0A                                %3C/a%3E%0A                            %3C/td%3E%0A                        %3C/tr%3E%0A                        %7B%25 endfor %25%7D%0A                    %7B%25 else %25%7D%0A                        %3Ctr%3E%0A                            %3Ctd colspan=%224%22 class=%22text-center%22%3E%0A                                %3Cdiv class=%22no-data%22%3E%0A                                    %3Ci class=%22fas fa-database%22%3E%3C/i%3E%0A                                    %3Cp%3ECh%C6%B0a c%C3%B3 d%E1%BB%AF li%E1%BB%87u d%E1%BB%8Bch v%E1%BB%A5%3C/p%3E%0A                                    %3Ca href=%22%7B%7B url_for('them_moi_dich_vu') %7D%7D%22 class=%22btn%22%3E%0A                                        %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm d%E1%BB%8Bch v%E1%BB%A5 m%E1%BB%9Bi%0A                                    %3C/a%3E%0A                                %3C/div%3E%0A                            %3C/td%3E%0A                        %3C/tr%3E%0A                    %7B%25 endif %25%7D%0A                %3C/tbody%3E%0A            %3C/table%3E%0A        %3C/div%3E%0A%0A        %3Cdiv class=%22pagination%22%3E%0A            %3Ca href=%22#%22 class=%22page-link%22%3E&laquo;%3C/a%3E%0A            %3Ca href=%22#%22 class=%22page-link active%22%3E1%3C/a%3E%0A            %3Ca href=%22#%22 class=%22page-link%22%3E2%3C/a%3E%0A            %3Ca href=%22#%22 class=%22page-link%22%3E3%3C/a%3E%0A            %3Ca href=%22#%22 class=%22page-link%22%3E&raquo;%3C/a%3E%0A        %3C/div%3E%0A    %3C/div%3E%0A%3C/div%3E%0A%0A%7B%25 block extra_js %25%7D%0A%3Cscript%3E%0A    // H%C3%A0m x%C3%B3a d%E1%BB%8Bch v%E1%BB%A5%0A    function deleteDichVu(maDV) %7B%0A        if (confirm('B%E1%BA%A1n c%C3%B3 ch%E1%BA%AFc ch%E1%BA%AFn mu%E1%BB%91n x%C3%B3a d%E1%BB%8Bch v%E1%BB%A5 n%C3%A0y?')) %7B%0A            // G%E1%BB%8Di API x%C3%B3a d%E1%BB%8Bch v%E1%BB%A5%0A            fetch(%60/api/dich-vu/$%7BmaDV%7D%60, %7B%0A                method: 'DELETE'%0A            %7D)%0A            .then(response =%3E response.json())%0A            .then(data =%3E %7B%0A                if (data.success) %7B%0A                    // X%C3%B3a d%C3%B2ng kh%E1%BB%8Fi b%E1%BA%A3ng%0A                    document.getElementById(%60dich-vu-$%7BmaDV%7D%60).remove();%0A                    alert(data.message);%0A                    %0A                    // Ki%E1%BB%83m tra n%E1%BA%BFu kh%C3%B4ng c%C3%B2n d%E1%BB%8Bch v%E1%BB%A5 n%C3%A0o, hi%E1%BB%83n th%E1%BB%8B th%C3%B4ng b%C3%A1o%0A                    const tbody = document.querySelector('.data-table tbody');%0A                    if (tbody.children.length === 0) %7B%0A                        tbody.innerHTML = %60%0A                        %3Ctr%3E%0A                            %3Ctd colspan=%224%22 class=%22text-center%22%3E%0A                                %3Cdiv class=%22no-data%22%3E%0A                                    %3Ci class=%22fas fa-database%22%3E%3C/i%3E%0A                                    %3Cp%3ECh%C6%B0a c%C3%B3 d%E1%BB%AF li%E1%BB%87u d%E1%BB%8Bch v%E1%BB%A5%3C/p%3E%0A                                    %3Ca href=%22%7B%7B url_for('them_moi_dich_vu') %7D%7D%22 class=%22btn%22%3E%0A                                        %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm d%E1%BB%8Bch v%E1%BB%A5 m%E1%BB%9Bi%0A                                    %3C/a%3E%0A                                %3C/div%3E%0A                            %3C/td%3E%0A                        %3C/tr%3E%0A                        %60;%0A                    %7D%0A                %7D else %7B%0A                    alert('L%E1%BB%97i: ' + data.message);%0A                %7D%0A            %7D)%0A            .catch(error =%3E %7B%0A                console.error('Error:', error);%0A                alert('%C4%90%C3%A3 x%E1%BA%A3y ra l%E1%BB%97i khi x%C3%B3a d%E1%BB%8Bch v%E1%BB%A5');%0A            %7D);%0A        %7D%0A    %7D%0A%3C/script%3E%0A%7B%25 endblock %25%7D%0A%7B%25 endblock %25%7D\n","isNew":true,"isApplied":true,"isUnread":false},{"path":"nhakhoaso/app.py","patch":"@@ -524,16 +524,144 @@\n ich_hen%0A\n+from database.dich_vu import get_all_dich_vu, get_dich_vu_by_id, search_dich_vu, create_dich_vu, update_dich_vu, delete_dich_vu%0A\n from dat\n@@ -788,16 +788,16 @@\n kham_id%0A\n-\n import d\n@@ -8626,24 +8626,29 @@\n  dich_vu\n+_list\n ():%0A    \n return r\n@@ -8643,45 +8643,2996 @@\n     \n-return render_template('dich_vu.html'\n+dich_vu_list = get_all_dich_vu()%0A    return render_template('dich_vu.html', dich_vu_list=dich_vu_list)%0A%0A# Th%C3%AAm m%E1%BB%9Bi d%E1%BB%8Bch v%E1%BB%A5%0A@app.route('/dich-vu/them-moi', methods=%5B'GET', 'POST'%5D)%0Adef them_moi_dich_vu():%0A    if request.method == 'POST':%0A        # X%E1%BB%AD l%C3%BD d%E1%BB%AF li%E1%BB%87u form khi submit%0A        ma_dv = request.form.get('ma_dv')%0A        ten_dv = request.form.get('ten_dv')%0A        gia = request.form.get('gia')%0A        %0A        # Ki%E1%BB%83m tra d%E1%BB%AF li%E1%BB%87u %C4%91%E1%BA%A7u v%C3%A0o%0A        if not ten_dv:%0A            flash('Vui l%C3%B2ng %C4%91i%E1%BB%81n %C4%91%E1%BA%A7y %C4%91%E1%BB%A7 t%C3%AAn d%E1%BB%8Bch v%E1%BB%A5', 'error')%0A        else:%0A            # L%C6%B0u v%C3%A0o database%0A            ma_dv, result = create_dich_vu(%0A                ten_dv,%0A                gia,%0A                ma_dv%0A            )%0A            %0A            if result:%0A                flash(f'Th%C3%AAm d%E1%BB%8Bch v%E1%BB%A5 th%C3%A0nh c%C3%B4ng v%E1%BB%9Bi m%C3%A3 %7Bma_dv%7D!', 'success')%0A                return redirect(url_for('dich_vu_list'))%0A            else:%0A                flash('C%C3%B3 l%E1%BB%97i x%E1%BA%A3y ra khi th%C3%AAm d%E1%BB%8Bch v%E1%BB%A5', 'error')%0A                    %0A    # GET request - hi%E1%BB%83n th%E1%BB%8B form v%E1%BB%9Bi m%C3%A3 d%E1%BB%8Bch v%E1%BB%A5 m%E1%BB%9Bi%0A    ma_dv = get_next_dich_vu_id()%0A    %0A    return render_template('them_moi_dich_vu.html', ma_dv=ma_dv)%0A%0A# T%C3%ACm ki%E1%BA%BFm d%E1%BB%8Bch v%E1%BB%A5%0A@app.route('/dich-vu/tim-kiem', methods=%5B'GET', 'POST'%5D)%0Adef tim_kiem_dich_vu():%0A    # D%E1%BB%AF li%E1%BB%87u m%E1%BA%ABu cho k%E1%BA%BFt qu%E1%BA%A3 t%C3%ACm ki%E1%BA%BFm%0A    ket_qua = %5B%5D%0A%0A    if request.method == 'POST':%0A        tu_khoa = request.form.get('tu_khoa')%0A        loai_tim_kiem = request.form.get('loai_tim_kiem', 'ma_dv')%0A        %0A        if tu_khoa:%0A            ket_qua = search_dich_vu(tu_khoa, loai_tim_kiem)%0A            %0A    return render_template('tim_kiem_dich_vu.html', ket_qua=ket_qua)%0A%0A# Chi ti%E1%BA%BFt d%E1%BB%8Bch v%E1%BB%A5%0A@app.route('/dich-vu/chi-tiet/%3Cma_dv%3E')%0Adef chi_tiet_dich_vu(ma_dv):%0A    dv = get_dich_vu_by_id(ma_dv)%0A    if not dv:%0A        flash('Kh%C3%B4ng t%C3%ACm th%E1%BA%A5y d%E1%BB%8Bch v%E1%BB%A5', 'error')%0A        return redirect(url_for('dich_vu_list'))%0A    return render_template('chi_tiet_dich_vu.html', dich_vu=dv)%0A%0A# Ch%E1%BB%89nh s%E1%BB%ADa d%E1%BB%8Bch v%E1%BB%A5%0A@app.route('/dich-vu/chinh-sua/%3Cma_dv%3E', methods=%5B'GET', 'POST'%5D)%0Adef chinh_sua_dich_vu(ma_dv):%0A    # L%E1%BA%A5y th%C3%B4ng tin d%E1%BB%8Bch v%E1%BB%A5%0A    dv = get_dich_vu_by_id(ma_dv)%0A    if not dv:%0A        flash('Kh%C3%B4ng t%C3%ACm th%E1%BA%A5y d%E1%BB%8Bch v%E1%BB%A5', 'error')%0A        return redirect(url_for('dich_vu_list'))%0A    %0A    if request.method == 'POST':%0A        # X%E1%BB%AD l%C3%BD d%E1%BB%AF li%E1%BB%87u form khi submit%0A        ten_dv = request.form.get('ten_dv')%0A        gia = request.form.get('gia')%0A        %0A        # Ki%E1%BB%83m tra d%E1%BB%AF li%E1%BB%87u %C4%91%E1%BA%A7u v%C3%A0o%0A        if not ten_dv:%0A            flash('Vui l%C3%B2ng %C4%91i%E1%BB%81n %C4%91%E1%BA%A7y %C4%91%E1%BB%A7 t%C3%AAn d%E1%BB%8Bch v%E1%BB%A5', 'error')%0A        else:%0A            # C%E1%BA%ADp nh%E1%BA%ADt v%C3%A0o database%0A            result = update_dich_vu(%0A                ma_dv,%0A                ten_dv,%0A                gia%0A            )%0A            %0A            if result:%0A                flash('C%E1%BA%ADp nh%E1%BA%ADt d%E1%BB%8Bch v%E1%BB%A5 th%C3%A0nh c%C3%B4ng!', 'success')%0A                return redirect(url_for('chi_tiet_dich_vu', ma_dv=ma_dv))%0A            else:%0A                flash('C%C3%B3 l%E1%BB%97i x%E1%BA%A3y ra khi c%E1%BA%ADp nh%E1%BA%ADt d%E1%BB%8Bch v%E1%BB%A5', 'error')%0A    %0A    return render_template('chinh_sua_dich_vu.html', dich_vu=dv\n )%0A%0A#\n@@ -22354,32 +22354,32 @@\n  x%E1%BA%A3y ra%22%7D), 404%0A\n-\n         return j\n@@ -22537,16 +22537,429 @@\n ), 500%0A%0A\n+# API x%C3%B3a d%E1%BB%8Bch v%E1%BB%A5%0A@app.route('/api/dich-vu/%3Cma_dv%3E', methods=%5B'DELETE'%5D)%0Adef api_delete_dich_vu(ma_dv):%0A    try:%0A        result, message = delete_dich_vu(ma_dv)%0A        if not result:%0A            return jsonify(%7B%22success%22: False, %22message%22: message%7D), 404%0A        return jsonify(%7B%22success%22: True, %22message%22: message%7D)%0A    except Exception as e:%0A        return jsonify(%7B%22success%22: False, %22message%22: str(e)%7D), 500%0A%0A\n if __nam\n","isNew":false,"isApplied":true,"isUnread":false},{"path":"nhakhoaso/templates/chi_tiet_dich_vu.html","patch":"@@ -0,0 +1,9628 @@\n+%7B%25 extends 'layout.html' %25%7D%0A%0A%7B%25 block title %25%7DChi ti%E1%BA%BFt d%E1%BB%8Bch v%E1%BB%A5 - NHAKHOASO%7B%25 endblock %25%7D%0A%0A%7B%25 block content %25%7D%0A%3Cdiv class=%22section-title%22%3E%0A    %3Ch2%3EQU%E1%BA%A2N L%C3%9D D%E1%BB%8ACH V%E1%BB%A4%3C/h2%3E%0A%3C/div%3E%0A%0A%3C!-- Flash messages --%3E%0A%7B%25 with messages = get_flashed_messages(with_categories=true) %25%7D%0A    %7B%25 if messages %25%7D%0A        %3Cdiv class=%22flash-messages%22%3E%0A            %7B%25 for category, message in messages %25%7D%0A                %3Cdiv class=%22flash-message %7B%7B category %7D%7D%22%3E%7B%7B message %7D%7D%3C/div%3E%0A            %7B%25 endfor %25%7D%0A        %3C/div%3E%0A    %7B%25 endif %25%7D%0A%7B%25 endwith %25%7D%0A%0A%3Cdiv class=%22page-container%22%3E%0A    %3C!-- Sidebar --%3E%0A    %3Cdiv class=%22sidebar%22%3E%0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-user-injured%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD b%E1%BB%87nh nh%C3%A2n%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_benh_nhan') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_benh_nhan') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('benh_nhan_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-clipboard-list%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD b%C3%A1c s%C4%A9%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_bac_si') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_bac_si') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('bac_si_page') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ca href=%22%7B%7B url_for('phieu_kham_list') %7D%7D%22 style=%22text-decoration: none; color: inherit;%22%3E%0A                %3Ci class=%22fas fa-chart-line%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD phi%E1%BA%BFu kh%C3%A1m%0A            %3C/a%3E%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_phieu_kham') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E T%E1%BA%A1o phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_phieu_kham') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('phieu_kham_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-calendar-check%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD l%E1%BB%8Bch h%E1%BA%B9n%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_lich_hen') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E %C4%90%E1%BA%B7t l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_lich_hen') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('lich_hen_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-hand-holding-heart%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD d%E1%BB%8Bch v%E1%BB%A5%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_dich_vu') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi d%E1%BB%8Bch v%E1%BB%A5%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_dich_vu') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm d%E1%BB%8Bch v%E1%BB%A5%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('dich_vu_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch d%E1%BB%8Bch v%E1%BB%A5%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A    %3C/div%3E%0A%0A    %3C!-- Main content --%3E%0A    %3Cdiv class=%22main-content%22%3E%0A        %3Cdiv class=%22content-header%22%3E%0A            %3Ch2%3EChi ti%E1%BA%BFt d%E1%BB%8Bch v%E1%BB%A5%3C/h2%3E%0A            %3Cdiv class=%22header-actions%22%3E%0A                %3Ca href=%22%7B%7B url_for('chinh_sua_dich_vu', ma_dv=dich_vu.MaDV) %7D%7D%22 class=%22btn btn-primary%22%3E%0A                    %3Ci class=%22fas fa-edit%22%3E%3C/i%3E Ch%E1%BB%89nh s%E1%BB%ADa%0A                %3C/a%3E%0A                %3Ca href=%22%7B%7B url_for('dich_vu_list') %7D%7D%22 class=%22btn btn-secondary%22%3E%0A                    %3Ci class=%22fas fa-arrow-left%22%3E%3C/i%3E Quay l%E1%BA%A1i%0A                %3C/a%3E%0A            %3C/div%3E%0A        %3C/div%3E%0A        %0A        %3Cdiv class=%22detail-container%22%3E%0A            %3Cdiv class=%22detail-card%22%3E%0A                %3Cdiv class=%22detail-header%22%3E%0A                    %3Ch3%3ETh%C3%B4ng tin d%E1%BB%8Bch v%E1%BB%A5%3C/h3%3E%0A                    %3Cdiv class=%22price-tag%22%3E%7B%7B %22%7B:,.0f%7D%22.format(dich_vu.Gia%7Cfloat) %7D%7D VN%C4%90%3C/div%3E%0A                %3C/div%3E%0A                %0A                %3Cdiv class=%22detail-content%22%3E%0A                    %3Cdiv class=%22detail-row%22%3E%0A                        %3Cdiv class=%22detail-label%22%3EM%C3%A3 d%E1%BB%8Bch v%E1%BB%A5:%3C/div%3E%0A                        %3Cdiv class=%22detail-value%22%3E%7B%7B dich_vu.MaDV %7D%7D%3C/div%3E%0A                    %3C/div%3E%0A                    %0A                    %3Cdiv class=%22detail-row%22%3E%0A                        %3Cdiv class=%22detail-label%22%3ET%C3%AAn d%E1%BB%8Bch v%E1%BB%A5:%3C/div%3E%0A                        %3Cdiv class=%22detail-value%22%3E%7B%7B dich_vu.TenDV %7D%7D%3C/div%3E%0A                    %3C/div%3E%0A                    %0A                    %3Cdiv class=%22detail-row%22%3E%0A                        %3Cdiv class=%22detail-label%22%3EGi%C3%A1 d%E1%BB%8Bch v%E1%BB%A5:%3C/div%3E%0A                        %3Cdiv class=%22detail-value%22%3E%7B%7B %22%7B:,.0f%7D%22.format(dich_vu.Gia%7Cfloat) %7D%7D VN%C4%90%3C/div%3E%0A                    %3C/div%3E%0A                %3C/div%3E%0A                %0A                %3Cdiv class=%22detail-actions%22%3E%0A                    %3Ca href=%22%7B%7B url_for('chinh_sua_dich_vu', ma_dv=dich_vu.MaDV) %7D%7D%22 class=%22btn btn-primary%22%3E%0A                        %3Ci class=%22fas fa-edit%22%3E%3C/i%3E Ch%E1%BB%89nh s%E1%BB%ADa%0A                    %3C/a%3E%0A                    %3Cbutton class=%22btn btn-danger%22 onclick=%22deleteDichVu('%7B%7B dich_vu.MaDV %7D%7D')%22%3E%0A                        %3Ci class=%22fas fa-trash%22%3E%3C/i%3E X%C3%B3a%0A                    %3C/button%3E%0A                    %3Ca href=%22%7B%7B url_for('dich_vu_list') %7D%7D%22 class=%22btn btn-secondary%22%3E%0A                        %3Ci class=%22fas fa-arrow-left%22%3E%3C/i%3E Quay l%E1%BA%A1i%0A                    %3C/a%3E%0A                %3C/div%3E%0A            %3C/div%3E%0A        %3C/div%3E%0A    %3C/div%3E%0A%3C/div%3E%0A%0A%3Cstyle%3E%0A    .content-header %7B%0A        display: flex;%0A        justify-content: space-between;%0A        align-items: center;%0A        margin-bottom: 20px;%0A    %7D%0A    %0A    .header-actions %7B%0A        display: flex;%0A        gap: 10px;%0A    %7D%0A    %0A    .detail-container %7B%0A        background-color: #fff;%0A        border-radius: 8px;%0A        box-shadow: 0 2px 4px rgba(0,0,0,0.1);%0A        overflow: hidden;%0A    %7D%0A    %0A    .detail-card %7B%0A        padding: 0;%0A    %7D%0A    %0A    .detail-header %7B%0A        background-color: var(--secondary-color);%0A        padding: 15px 20px;%0A        display: flex;%0A        justify-content: space-between;%0A        align-items: center;%0A    %7D%0A    %0A    .detail-header h3 %7B%0A        margin: 0;%0A        font-size: 18px;%0A        color: var(--primary-color);%0A    %7D%0A    %0A    .price-tag %7B%0A        background-color: var(--primary-color);%0A        color: white;%0A        padding: 5px 10px;%0A        border-radius: 4px;%0A        font-weight: bold;%0A    %7D%0A    %0A    .detail-content %7B%0A        padding: 20px;%0A    %7D%0A    %0A    .detail-row %7B%0A        display: flex;%0A        margin-bottom: 15px;%0A        border-bottom: 1px solid #eee;%0A        padding-bottom: 15px;%0A    %7D%0A    %0A    .detail-row:last-child %7B%0A        margin-bottom: 0;%0A        border-bottom: none;%0A        padding-bottom: 0;%0A    %7D%0A    %0A    .detail-label %7B%0A        width: 150px;%0A        font-weight: 500;%0A        color: #555;%0A    %7D%0A    %0A    .detail-value %7B%0A        flex: 1;%0A    %7D%0A    %0A    .detail-actions %7B%0A        padding: 15px 20px;%0A        background-color: #f8f9fa;%0A        display: flex;%0A        gap: 10px;%0A        justify-content: flex-end;%0A    %7D%0A    %0A    .btn %7B%0A        padding: 8px 15px;%0A        border: none;%0A        border-radius: 4px;%0A        cursor: pointer;%0A        font-size: 14px;%0A        display: inline-flex;%0A        align-items: center;%0A        gap: 5px;%0A    %7D%0A    %0A    .btn-primary %7B%0A        background-color: var(--primary-color);%0A        color: white;%0A    %7D%0A    %0A    .btn-secondary %7B%0A        background-color: #6c757d;%0A        color: white;%0A    %7D%0A    %0A    .btn-danger %7B%0A        background-color: #dc3545;%0A        color: white;%0A    %7D%0A%3C/style%3E%0A%0A%7B%25 block extra_js %25%7D%0A%3Cscript%3E%0A    // H%C3%A0m x%C3%B3a d%E1%BB%8Bch v%E1%BB%A5%0A    function deleteDichVu(maDV) %7B%0A        if (confirm('B%E1%BA%A1n c%C3%B3 ch%E1%BA%AFc ch%E1%BA%AFn mu%E1%BB%91n x%C3%B3a d%E1%BB%8Bch v%E1%BB%A5 n%C3%A0y?')) %7B%0A            // G%E1%BB%8Di API x%C3%B3a d%E1%BB%8Bch v%E1%BB%A5%0A            fetch(%60/api/dich-vu/$%7BmaDV%7D%60, %7B%0A                method: 'DELETE'%0A            %7D)%0A            .then(response =%3E response.json())%0A            .then(data =%3E %7B%0A                if (data.success) %7B%0A                    alert(data.message);%0A                    window.location.href = %22%7B%7B url_for('dich_vu_list') %7D%7D%22;%0A                %7D else %7B%0A                    alert('L%E1%BB%97i: ' + data.message);%0A                %7D%0A            %7D)%0A            .catch(error =%3E %7B%0A                console.error('Error:', error);%0A                alert('%C4%90%C3%A3 x%E1%BA%A3y ra l%E1%BB%97i khi x%C3%B3a d%E1%BB%8Bch v%E1%BB%A5');%0A            %7D);%0A        %7D%0A    %7D%0A%3C/script%3E%0A%7B%25 endblock %25%7D%0A%7B%25 endblock %25%7D\n","isNew":true,"isApplied":true,"isUnread":false},{"path":"nhakhoaso/templates/tim_kiem_dich_vu.html","patch":"@@ -0,0 +1,10765 @@\n+%7B%25 extends 'layout.html' %25%7D%0A%0A%7B%25 block title %25%7DT%C3%ACm ki%E1%BA%BFm d%E1%BB%8Bch v%E1%BB%A5 - NHAKHOASO%7B%25 endblock %25%7D%0A%0A%7B%25 block content %25%7D%0A%3Cdiv class=%22section-title%22%3E%0A    %3Ch2%3EQU%E1%BA%A2N L%C3%9D D%E1%BB%8ACH V%E1%BB%A4%3C/h2%3E%0A%3C/div%3E%0A%0A%3C!-- Flash messages --%3E%0A%7B%25 with messages = get_flashed_messages(with_categories=true) %25%7D%0A    %7B%25 if messages %25%7D%0A        %3Cdiv class=%22flash-messages%22%3E%0A            %7B%25 for category, message in messages %25%7D%0A                %3Cdiv class=%22flash-message %7B%7B category %7D%7D%22%3E%0A                    %7B%7B message %7D%7D%0A                %3C/div%3E%0A            %7B%25 endfor %25%7D%0A        %3C/div%3E%0A    %7B%25 endif %25%7D%0A%7B%25 endwith %25%7D%0A%0A%3Cdiv class=%22page-container%22%3E%0A    %3C!-- Sidebar --%3E%0A    %3Cdiv class=%22sidebar%22%3E%0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-user-injured%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD b%E1%BB%87nh nh%C3%A2n%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_benh_nhan') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_benh_nhan') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('benh_nhan_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch b%E1%BB%87nh nh%C3%A2n%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-clipboard-list%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD b%C3%A1c s%C4%A9%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_bac_si') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_bac_si') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('bac_si_page') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch b%C3%A1c s%C4%A9%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ca href=%22%7B%7B url_for('phieu_kham_list') %7D%7D%22 style=%22text-decoration: none; color: inherit;%22%3E%0A                %3Ci class=%22fas fa-chart-line%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD phi%E1%BA%BFu kh%C3%A1m%0A            %3C/a%3E%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_phieu_kham') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E T%E1%BA%A1o phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_phieu_kham') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('phieu_kham_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch phi%E1%BA%BFu kh%C3%A1m%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-calendar-check%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD l%E1%BB%8Bch h%E1%BA%B9n%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_lich_hen') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E %C4%90%E1%BA%B7t l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_lich_hen') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('lich_hen_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch l%E1%BB%8Bch h%E1%BA%B9n%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A        %0A        %3Cdiv class=%22sidebar-title%22%3E%0A            %3Ci class=%22fas fa-hand-holding-heart%22%3E%3C/i%3E Qu%E1%BA%A3n l%C3%BD d%E1%BB%8Bch v%E1%BB%A5%0A        %3C/div%3E%0A        %3Cul class=%22sidebar-menu%22%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('them_moi_dich_vu') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-plus%22%3E%3C/i%3E Th%C3%AAm m%E1%BB%9Bi d%E1%BB%8Bch v%E1%BB%A5%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('tim_kiem_dich_vu') %7D%7D%22 class=%22active%22%3E%0A                    %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm d%E1%BB%8Bch v%E1%BB%A5%0A                %3C/a%3E%0A            %3C/li%3E%0A            %3Cli%3E%0A                %3Ca href=%22%7B%7B url_for('dich_vu_list') %7D%7D%22%3E%0A                    %3Ci class=%22fas fa-list%22%3E%3C/i%3E Danh s%C3%A1ch d%E1%BB%8Bch v%E1%BB%A5%0A                %3C/a%3E%0A            %3C/li%3E%0A        %3C/ul%3E%0A    %3C/div%3E%0A%0A    %3C!-- Main content --%3E%0A    %3Cdiv class=%22main-content%22%3E%0A        %3Cdiv class=%22content-header%22%3E%0A            %3Ch2%3ET%C3%ACm ki%E1%BA%BFm d%E1%BB%8Bch v%E1%BB%A5%3C/h2%3E%0A        %3C/div%3E%0A        %0A        %3Cdiv class=%22search-container%22%3E%0A            %3Cform action=%22%7B%7B url_for('tim_kiem_dich_vu') %7D%7D%22 method=%22POST%22 class=%22search-form%22%3E%0A                %3Cdiv class=%22search-input-group%22%3E%0A                    %3Cinput type=%22text%22 name=%22tu_khoa%22 class=%22form-control%22 placeholder=%22Nh%E1%BA%ADp m%C3%A3 d%E1%BB%8Bch v%E1%BB%A5, t%C3%AAn d%E1%BB%8Bch v%E1%BB%A5 ho%E1%BA%B7c gi%C3%A1...%22 value=%22%7B%7B request.form.get('tu_khoa', '') %7D%7D%22%3E%0A                    %3Cbutton type=%22submit%22 class=%22btn-search%22%3E%0A                        %3Ci class=%22fas fa-search%22%3E%3C/i%3E T%C3%ACm ki%E1%BA%BFm%0A                    %3C/button%3E%0A                %3C/div%3E%0A                %3Cdiv class=%22search-options%22%3E%0A                    %3Clabel class=%22search-option%22%3E%0A                        %3Cinput type=%22radio%22 name=%22loai_tim_kiem%22 value=%22ma_dv%22 checked%3E M%C3%A3 d%E1%BB%8Bch v%E1%BB%A5%0A                    %3C/label%3E%0A                    %3Clabel class=%22search-option%22%3E%0A                        %3Cinput type=%22radio%22 name=%22loai_tim_kiem%22 value=%22ten_dv%22%3E T%C3%AAn d%E1%BB%8Bch v%E1%BB%A5%0A                    %3C/label%3E%0A                    %3Clabel class=%22search-option%22%3E%0A                        %3Cinput type=%22radio%22 name=%22loai_tim_kiem%22 value=%22gia%22%3E Gi%C3%A1 d%E1%BB%8Bch v%E1%BB%A5%0A                    %3C/label%3E%0A                %3C/div%3E%0A            %3C/form%3E%0A        %3C/div%3E%0A        %0A        %3Cdiv class=%22search-results%22%3E%0A            %7B%25 if request.method == 'POST' %25%7D%0A                %7B%25 if ket_qua %25%7D%0A                    %3Cdiv class=%22result-header%22%3E%0A                        %3Ch3%3EK%E1%BA%BFt qu%E1%BA%A3 t%C3%ACm ki%E1%BA%BFm%3C/h3%3E%0A                        %3Cp%3ET%C3%ACm th%E1%BA%A5y %7B%7B ket_qua%7Clength %7D%7D d%E1%BB%8Bch v%E1%BB%A5%3C/p%3E%0A                    %3C/div%3E%0A                    %0A                    %3Ctable class=%22data-table%22%3E%0A                        %3Cthead%3E%0A                            %3Ctr%3E%0A                                %3Cth%3EM%C3%A3 DV%3C/th%3E%0A                                %3Cth%3ET%C3%AAn d%E1%BB%8Bch v%E1%BB%A5%3C/th%3E%0A                                %3Cth%3EGi%C3%A1 (VN%C4%90)%3C/th%3E%0A                                %3Cth%3EThao t%C3%A1c%3C/th%3E%0A                            %3C/tr%3E%0A                        %3C/thead%3E%0A                        %3Ctbody%3E%0A                            %7B%25 for dv in ket_qua %25%7D%0A                                %3Ctr id=%22dich-vu-%7B%7B dv.MaDV %7D%7D%22%3E%0A                                    %3Ctd%3E%7B%7B dv.MaDV %7D%7D%3C/td%3E%0A                                    %3Ctd%3E%7B%7B dv.TenDV %7D%7D%3C/td%3E%0A                                    %3Ctd%3E%7B%7B %22%7B:,.0f%7D%22.format(dv.Gia%7Cfloat) %7D%7D%3C/td%3E%0A                                    %3Ctd%3E%0A                                        %3Ca href=%22%7B%7B url_for('chi_tiet_dich_vu', ma_dv=dv.MaDV) %7D%7D%22 class=%22action-btn view-btn%22 title=%22Xem chi ti%E1%BA%BFt%22%3E%3Ci class=%22fas fa-eye%22%3E%3C/i%3E%3C/a%3E%0A                                        %3Ca href=%22%7B%7B url_for('chinh_sua_dich_vu', ma_dv=dv.MaDV) %7D%7D%22 class=%22action-btn edit-btn%22 title=%22Ch%E1%BB%89nh s%E1%BB%ADa%22%3E%3Ci class=%22fas fa-edit%22%3E%3C/i%3E%3C/a%3E%0A                                        %3Ca href=%22#%22 class=%22action-btn delete-btn%22 title=%22X%C3%B3a%22 onclick=%22deleteDichVu('%7B%7B dv.MaDV %7D%7D')%22%3E%3Ci class=%22fas fa-trash%22%3E%3C/i%3E%3C/a%3E%0A                                    %3C/td%3E%0A                                %3C/tr%3E%0A                            %7B%25 endfor %25%7D%0A                        %3C/tbody%3E%0A                    %3C/table%3E%0A                %7B%25 else %25%7D%0A                    %3Cdiv class=%22no-results%22%3E%0A                        %3Ci class=%22fas fa-search%22%3E%3C/i%3E%0A                        %3Cp%3EKh%C3%B4ng t%C3%ACm th%E1%BA%A5y d%E1%BB%8Bch v%E1%BB%A5 n%C3%A0o ph%C3%B9 h%E1%BB%A3p v%E1%BB%9Bi t%E1%BB%AB kh%C3%B3a t%C3%ACm ki%E1%BA%BFm.%3C/p%3E%0A                        %3Cp%3EVui l%C3%B2ng th%E1%BB%AD l%E1%BA%A1i v%E1%BB%9Bi t%E1%BB%AB kh%C3%B3a kh%C3%A1c ho%E1%BA%B7c %3Ca href=%22%7B%7B url_for('them_moi_dich_vu') %7D%7D%22%3Eth%C3%AAm d%E1%BB%8Bch v%E1%BB%A5 m%E1%BB%9Bi%3C/a%3E.%3C/p%3E%0A                    %3C/div%3E%0A                %7B%25 endif %25%7D%0A            %7B%25 endif %25%7D%0A        %3C/div%3E%0A    %3C/div%3E%0A%3C/div%3E%0A%0A%3Cstyle%3E%0A    .search-container %7B%0A        background-color: var(--secondary-color);%0A        padding: 20px;%0A        border-radius: 8px;%0A        margin-bottom: 30px;%0A    %7D%0A    %0A    .search-form %7B%0A        width: 100%25;%0A    %7D%0A    %0A    .search-input-group %7B%0A        display: flex;%0A        margin-bottom: 15px;%0A    %7D%0A    %0A    .search-input-group input %7B%0A        flex: 1;%0A        padding: 12px 15px;%0A        border: 1px solid var(--border-color);%0A        border-radius: 5px 0 0 5px;%0A        font-size: 16px;%0A    %7D%0A    %0A    .btn-search %7B%0A        padding: 0 20px;%0A        background-color: var(--primary-color);%0A        color: white;%0A        border: none;%0A        border-radius: 0 5px 5px 0;%0A        cursor: pointer;%0A        font-size: 16px;%0A        display: flex;%0A        align-items: center;%0A    %7D%0A    %0A    .btn-search i %7B%0A        margin-right: 8px;%0A    %7D%0A    %0A    .search-options %7B%0A        display: flex;%0A        flex-wrap: wrap;%0A        gap: 15px;%0A    %7D%0A    %0A    .search-option %7B%0A        display: flex;%0A        align-items: center;%0A        cursor: pointer;%0A    %7D%0A    %0A    .search-option input %7B%0A        margin-right: 5px;%0A    %7D%0A    %0A    .result-header %7B%0A        display: flex;%0A        justify-content: space-between;%0A        align-items: center;%0A        margin-bottom: 15px;%0A    %7D%0A    %0A    .result-header h3 %7B%0A        margin: 0;%0A        font-size: 18px;%0A    %7D%0A    %0A    .result-header p %7B%0A        margin: 0;%0A        color: var(--text-muted);%0A    %7D%0A    %0A    .no-results %7B%0A        text-align: center;%0A        padding: 40px 20px;%0A        background-color: #f8f9fa;%0A        border-radius: 8px;%0A    %7D%0A    %0A    .no-results i %7B%0A        font-size: 48px;%0A        color: #adb5bd;%0A        margin-bottom: 15px;%0A    %7D%0A    %0A    .no-results p %7B%0A        margin: 10px 0;%0A        color: #6c757d;%0A    %7D%0A    %0A    .no-results a %7B%0A        color: var(--primary-color);%0A        text-decoration: none;%0A        font-weight: 500;%0A    %7D%0A%3C/style%3E%0A%0A%7B%25 block extra_js %25%7D%0A%3Cscript%3E%0A    // H%C3%A0m x%C3%B3a d%E1%BB%8Bch v%E1%BB%A5%0A    function deleteDichVu(maDV) %7B%0A        if (confirm('B%E1%BA%A1n c%C3%B3 ch%E1%BA%AFc ch%E1%BA%AFn mu%E1%BB%91n x%C3%B3a d%E1%BB%8Bch v%E1%BB%A5 n%C3%A0y?')) %7B%0A            // G%E1%BB%8Di API x%C3%B3a d%E1%BB%8Bch v%E1%BB%A5%0A            fetch(%60/api/dich-vu/$%7BmaDV%7D%60, %7B%0A                method: 'DELETE'%0A            %7D)%0A            .then(response =%3E response.json())%0A            .then(data =%3E %7B%0A                if (data.success) %7B%0A                    // X%C3%B3a d%C3%B2ng kh%E1%BB%8Fi b%E1%BA%A3ng%0A                    document.getElementById(%60dich-vu-$%7BmaDV%7D%60).remove();%0A                    alert(data.message);%0A                %7D else %7B%0A                    alert('L%E1%BB%97i: ' + data.message);%0A                %7D%0A            %7D)%0A            .catch(error =%3E %7B%0A                console.error('Error:', error);%0A                alert('%C4%90%C3%A3 x%E1%BA%A3y ra l%E1%BB%97i khi x%C3%B3a d%E1%BB%8Bch v%E1%BB%A5');%0A            %7D);%0A        %7D%0A    %7D%0A%3C/script%3E%0A%7B%25 endblock %25%7D%0A%7B%25 endblock %25%7D\n","isNew":true,"isApplied":true,"isUnread":false},{"path":"nhakhoaso/database/dich_vu.py","patch":"@@ -0,0 +1,3292 @@\n+from .db import execute_query%0Afrom .utils import get_next_dich_vu_id%0A%0Adef get_all_dich_vu():%0A    %22%22%22%0A    L%E1%BA%A5y danh s%C3%A1ch t%E1%BA%A5t c%E1%BA%A3 d%E1%BB%8Bch v%E1%BB%A5%0A    %22%22%22%0A    query = %22%22%22%0A    SELECT * FROM DICHVU%0A    ORDER BY MaDV%0A    %22%22%22%0A    return execute_query(query, fetch=True)%0A%0Adef get_dich_vu_by_id(ma_dv):%0A    %22%22%22%0A    L%E1%BA%A5y th%C3%B4ng tin d%E1%BB%8Bch v%E1%BB%A5 theo m%C3%A3%0A    %22%22%22%0A    query = %22%22%22%0A    SELECT * FROM DICHVU%0A    WHERE MaDV = %25s%0A    %22%22%22%0A    result = execute_query(query, (ma_dv,), fetch=True)%0A    return result%5B0%5D if result else None%0A%0Adef search_dich_vu(tu_khoa, loai_tim_kiem='ma_dv'):%0A    %22%22%22%0A    T%C3%ACm ki%E1%BA%BFm d%E1%BB%8Bch v%E1%BB%A5 theo t%E1%BB%AB kh%C3%B3a v%C3%A0 lo%E1%BA%A1i t%C3%ACm ki%E1%BA%BFm%0A    %0A    Args:%0A        tu_khoa (str): T%E1%BB%AB kh%C3%B3a t%C3%ACm ki%E1%BA%BFm%0A        loai_tim_kiem (str): Lo%E1%BA%A1i t%C3%ACm ki%E1%BA%BFm (ma_dv, ten_dv, gia)%0A        %0A    Returns:%0A        list: Danh s%C3%A1ch d%E1%BB%8Bch v%E1%BB%A5 t%C3%ACm th%E1%BA%A5y%0A    %22%22%22%0A    if loai_tim_kiem == 'ma_dv':%0A        query = %22%22%22%0A        SELECT * FROM DICHVU%0A        WHERE MaDV LIKE %25s%0A        %22%22%22%0A    elif loai_tim_kiem == 'ten_dv':%0A        query = %22%22%22%0A        SELECT * FROM DICHVU%0A        WHERE TenDV LIKE %25s%0A        %22%22%22%0A    elif loai_tim_kiem == 'gia':%0A        # T%C3%ACm ki%E1%BA%BFm theo kho%E1%BA%A3ng gi%C3%A1%0A        try:%0A            gia = float(tu_khoa)%0A            query = %22%22%22%0A            SELECT * FROM DICHVU%0A            WHERE Gia = %25s%0A            %22%22%22%0A            return execute_query(query, (gia,), fetch=True)%0A        except ValueError:%0A            # N%E1%BA%BFu kh%C3%B4ng ph%E1%BA%A3i s%E1%BB%91, tr%E1%BA%A3 v%E1%BB%81 danh s%C3%A1ch r%E1%BB%97ng%0A            return %5B%5D%0A    else:%0A        return %5B%5D%0A        %0A    return execute_query(query, (f'%25%7Btu_khoa%7D%25',), fetch=True)%0A%0Adef create_dich_vu(ten_dv, gia, ma_dv=None):%0A    %22%22%22%0A    T%E1%BA%A1o m%E1%BB%9Bi d%E1%BB%8Bch v%E1%BB%A5%0A    %0A    Args:%0A        ten_dv (str): T%C3%AAn d%E1%BB%8Bch v%E1%BB%A5%0A        gia (float): Gi%C3%A1 d%E1%BB%8Bch v%E1%BB%A5%0A        ma_dv (str, optional): M%C3%A3 d%E1%BB%8Bch v%E1%BB%A5 (n%E1%BA%BFu kh%C3%B4ng cung c%E1%BA%A5p s%E1%BA%BD t%E1%BB%B1 %C4%91%E1%BB%99ng t%E1%BA%A1o)%0A        %0A    Returns:%0A        tuple: (ma_dv, success) - M%C3%A3 d%E1%BB%8Bch v%E1%BB%A5 v%C3%A0 k%E1%BA%BFt qu%E1%BA%A3 th%C3%A0nh c%C3%B4ng hay kh%C3%B4ng%0A    %22%22%22%0A    # N%E1%BA%BFu kh%C3%B4ng c%C3%B3 m%C3%A3 d%E1%BB%8Bch v%E1%BB%A5, t%E1%BA%A1o m%C3%A3 m%E1%BB%9Bi%0A    if not ma_dv:%0A        ma_dv = get_next_dich_vu_id()%0A        %0A    query = %22%22%22%0A    INSERT INTO DICHVU (MaDV, TenDV, Gia)%0A    VALUES (%25s, %25s, %25s)%0A    %22%22%22%0A    %0A    try:%0A        execute_query(query, (ma_dv, ten_dv, gia))%0A        return ma_dv, True%0A    except Exception as e:%0A        print(f%22L%E1%BB%97i khi t%E1%BA%A1o d%E1%BB%8Bch v%E1%BB%A5: %7Be%7D%22)%0A        return None, False%0A%0Adef update_dich_vu(ma_dv, ten_dv, gia):%0A    %22%22%22%0A    C%E1%BA%ADp nh%E1%BA%ADt th%C3%B4ng tin d%E1%BB%8Bch v%E1%BB%A5%0A    %22%22%22%0A    query = %22%22%22%0A    UPDATE DICHVU%0A    SET TenDV = %25s, Gia = %25s%0A    WHERE MaDV = %25s%0A    %22%22%22%0A    %0A    try:%0A        execute_query(query, (ten_dv, gia, ma_dv))%0A        return True%0A    except Exception as e:%0A        print(f%22L%E1%BB%97i khi c%E1%BA%ADp nh%E1%BA%ADt d%E1%BB%8Bch v%E1%BB%A5: %7Be%7D%22)%0A        return False%0A%0Adef delete_dich_vu(ma_dv):%0A    %22%22%22%0A    X%C3%B3a d%E1%BB%8Bch v%E1%BB%A5 theo m%C3%A3%0A    %22%22%22%0A    # Ki%E1%BB%83m tra xem d%E1%BB%8Bch v%E1%BB%A5 c%C3%B3 %C4%91ang %C4%91%C6%B0%E1%BB%A3c s%E1%BB%AD d%E1%BB%A5ng trong phi%E1%BA%BFu kh%C3%A1m kh%C3%B4ng%0A    check_query = %22%22%22%0A    SELECT COUNT(*) as count FROM PHIEUKHAM%0A    WHERE MaDV = %25s%0A    %22%22%22%0A    result = execute_query(check_query, (ma_dv,), fetch=True)%0A    %0A    if result and result%5B0%5D%5B'count'%5D %3E 0:%0A        return False, %22Kh%C3%B4ng th%E1%BB%83 x%C3%B3a d%E1%BB%8Bch v%E1%BB%A5 %C4%91ang %C4%91%C6%B0%E1%BB%A3c s%E1%BB%AD d%E1%BB%A5ng trong phi%E1%BA%BFu kh%C3%A1m%22%0A    %0A    query = %22DELETE FROM DICHVU WHERE MaDV = %25s%22%0A    try:%0A        execute_query(query, (ma_dv,))%0A        return True, %22X%C3%B3a d%E1%BB%8Bch v%E1%BB%A5 th%C3%A0nh c%C3%B4ng%22%0A    except Exception as e:%0A        print(f%22L%E1%BB%97i khi x%C3%B3a d%E1%BB%8Bch v%E1%BB%A5: %7Be%7D%22)%0A        return False, f%22L%E1%BB%97i: %7Bstr(e)%7D%22\n","isNew":true,"isApplied":true,"isUnread":false}]},{"id":"3e7534f1-79bd-4778-a542-6d884f23ceaf","type":"shellCommand","status":"ERROR","shell":"bash","command":"cd /home/huong/nhakhoaso && python3 app.py","toolCallId":"toolu_01EeyPycv8TcujnjrXjqh34U","requiresConfirmation":true,"commandsRequiringConfirmation":[{"name":"python3","arguments":["app.py"]}],"exitCode":124,"output":" * Serving Flask app 'app'\n * Debug mode: on\nWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.\n * Running on all addresses (0.0.0.0)\n * Running on http://127.0.0.1:5001\n * Running on http://172.26.181.174:5001\nPress CTRL+C to quit\n * Restarting with stat\n * Debugger is active!\n * Debugger PIN: 110-037-917\n","outputPath":"/tmp/791edf62-13eb-4447-a721-dda7631b6be7.log"}],"context":{"author":"Coding Agent","operationId":"ad588d65-f38f-4da5-8417-d0b597d7bace"},"isInternal":false},{"id":"ba6532e1-94f6-4ff5-a84d-45f7c670dd2f","role":"assistant","createdAt":1745253146608,"content":[{"type":"text","text":"Ứng dụng đã chạy thành công! Tôi đã hoàn thành việc tạo chức năng quản lý dịch vụ với các tính năng:\n\n1. **Database Layer**:\n   - Tạo file `database/dich_vu.py` với các hàm CRUD cho bảng DICHVU\n   - Sử dụng hàm `get_next_dich_vu_id()` từ `utils.py` để tạo ID mới\n\n2. **Routes trong app.py**:\n   - Thêm import từ module `dich_vu`\n   - Tạo các route cho danh sách dịch vụ, thêm mới, tìm kiếm, chi tiết, chỉnh sửa\n   - Thêm API endpoint để xóa dịch vụ\n\n3. **Templates**:\n   - `dich_vu.html`: Hiển thị danh sách dịch vụ\n   - `them_moi_dich_vu.html`: Form thêm mới dịch vụ\n   - `tim_kiem_dich_vu.html`: Form tìm kiếm và hiển thị kết quả\n   - `chi_tiet_dich_vu.html`: Hiển thị chi tiết dịch vụ\n   - `chinh_sua_dich_vu.html`: Form chỉnh sửa dịch vụ\n\n4. **Cập nhật file index.html**:\n   - Thay đổi `url_for('dich_vu')` thành `url_for('dich_vu_list')`\n\nTất cả các chức năng đã được triển khai đầy đủ, bao gồm:\n- Thêm mới dịch vụ\n- Tìm kiếm dịch vụ\n- Xem danh sách dịch vụ\n- Xem chi tiết dịch vụ\n- Chỉnh sửa dịch vụ\n- Xóa dịch vụ\n\nCác template đã được thiết kế với giao diện nhất quán với các phần khác của ứng dụng, và các chức năng JavaScript cần thiết đã được thêm vào để xử lý các tác vụ như xóa dịch vụ.\n\nBạn có thể truy cập các chức năng này thông qua menu sidebar trong ứng dụng, phần \"Quản lý dịch vụ\"."}],"context":{"author":"Coding Agent","operationId":"04ac0b0b-1d84-4d50-9d89-b3b257d566e3","usedFilePaths":[{"fsPath":"/home/huong/nhakhoaso/templates/index.html","path":"nhakhoaso/templates/index.html","displayPath":"nhakhoaso/templates/index.html"}]},"isInternal":false}],"isAgent":true,"isCustomAgent":false,"isUnitTestsAgent":false,"autoApply":false}